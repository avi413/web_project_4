!function(){"use strict";class e{constructor(e,t,i,s,n,r){this._text=e.name,this._img=e.link,this._id=e._id,this._likes=e.likes,this._Cardowner=e.owner,this._cardSelector=t,this._handleCardClick=i,this._handleTrashClick=s,this._addLike=r.addLike,this._deleteLike=r.deleteLike,this._deleteCard=r.deleteCard,this._handleLike=n,this._element=document.querySelector(this._cardSelector).content.querySelector(".gallery__item").cloneNode(!0),this._itemImgEl=this._element.querySelector(".gallery__item-img"),this._itemNameEl=this._element.querySelector(".gallery__item-name"),this.profileEl=document.querySelector(".profile__name"),this._itemTrashBtn=this._element.querySelector(".gallery__item-trash-btn"),this._itemLikeBtn=this._element.querySelector(".gallery__like-btn"),this._gallerylikeCount=this._element.querySelector(".gllery__like-count")}getId(){return this._id}deleteCard(){this._element.remove(),this._element=null}generateCard(){return this._itemImgEl.src=this._img,this._itemNameEl.alt=this._text,this._itemNameEl.textContent=this._text,this._element.id=this._id,this._initLike(this.profileEl.id),this._deleteIconVisibility(this.profileEl.id),this._setEventListeners(),this._element}_deleteIconVisibility(e){e!=this._Cardowner._id&&(this._itemTrashBtn.style.visibility="hidden")}_initLike(e){this._userExists(e)&&this._itemLikeBtn.classList.add("gallery__like-btn_active"),void 0!==this._likes?this._gallerylikeCount.textContent=this._likes.length:this._gallerylikeCount.textContent=0}_userExists(e){return void 0!==this._likes&&this._likes.some((function(t){return t._id===e}))}_setEventListeners(){this._itemLikeBtn.addEventListener("click",(()=>{this._handleLike(this)})),this._itemTrashBtn.addEventListener("click",(()=>{this._handleTrashClick(this)})),this._itemImgEl.addEventListener("click",this._handleCardClick)}updateLikes(){return this._itemLikeBtn.classList.contains("gallery__like-btn_active")?this._deleteLike(this._element.id):this._addLike(this._element.id)}setLikes(e){this._gallerylikeCount.textContent=e.likes.length,this._itemLikeBtn.classList.toggle("gallery__like-btn_active")}}function t(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class i{constructor(e){t(this,"_handleEscClose",(e=>{"Escape"===e.key&&this.close()})),t(this,"_handleClickClosePopup",(e=>{(e.target.classList.contains("popup_opened")||e.target.classList.contains("popup__close"))&&this.close()})),this._popup=document.querySelector(e)}close(){this._popup.classList.remove("popup_opened"),this.removeEventListeners()}open(){this._popup.classList.add("popup_opened"),this.setEventListeners()}setEventListeners(){document.addEventListener("keydown",this._handleEscClose),document.addEventListener("mousedown",this._handleClickClosePopup)}removeEventListeners(){document.removeEventListener("keydown",this._handleEscClose),document.removeEventListener("mousedown",this._handleClickClosePopup)}}class s extends i{constructor(e,t){var i,s;super(e),s=e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues())},(i="_handleSubmit")in this?Object.defineProperty(this,i,{value:s,enumerable:!0,configurable:!0,writable:!0}):this[i]=s,this._handleFormSubmit=t,this._formElemet=this._popup.querySelector(".popup__form"),this._inputsArr=this._formElemet.querySelectorAll(".popup__input"),this._btnEl=this._formElemet.querySelector(".popup__submit-btn"),this._inputValues={}}_getInputValues(){return this._inputsArr.forEach((e=>{e.value,this._inputValues[e.name]=e.value})),this._inputValues}setEventListeners(){super.setEventListeners(),this._formElemet.addEventListener("submit",this._handleSubmit)}removeEventListeners(){super.removeEventListeners(),this._formElemet.removeEventListener("submit",this._handleSubmit)}renderLoading(e){this._btnEl.textContent=e?"Saving...":"Save"}close(){super.close(),this._formElemet.reset()}}class n{constructor(e,t){this._formSelector=e.formSelector,this._formInputsFieldSet=e.formInputsFieldSet,this._inputSelector=e.inputSelector,this._submitBtnSelector=e.submitBtnSelector,this._inactiveBtnClass=e.inactiveBtnClass,this._inputErrClass=e.inputErrClass,this._inputErrActiveClass=e.inputErrActiveClass,this._formEl=t,this._inputLst=Array.from(this._formEl.querySelectorAll(this._inputSelector)),this._btnEl=this._formEl.querySelector(this._submitBtnSelector)}_showInputErr(e){const t=this._formEl.querySelector(".".concat(e.id,"-error"));e.classList.add(this._inputErrClass),t.textContent=e.validationMessage,t.classList.add(this._inputErrActiveClass)}_hideInputError(e){const t=this._formEl.querySelector(".".concat(e.id,"-error"));e.classList.remove(this._inputErrClass),t.classList.remove(this._inputErrActiveClass),t.textContent=""}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputErr(e)}_hasInvalidInput(e){return e.some((e=>!e.validity.valid))}_toggleButtonState(){this._hasInvalidInput(this._inputLst)?(this._btnEl.classList.add(this._inactiveBtnClass),this._btnEl.disabled=!0):(this._btnEl.classList.remove(this._inactiveBtnClass),this._btnEl.disabled=!1)}resetValidation(){this._toggleButtonState(),this._inputLst.forEach((e=>{this._hideInputError(e)}))}_setEventListeners(){this._toggleButtonState(),this._inputLst.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}enableValidation(){this._setEventListeners(),this._formEl.addEventListener("submit",(e=>e.preventDefault()))}}const r=document.forms.profileform,l=r.elements.profileName,o=r.elements.profileAboutMe;function a(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}document.forms.placeform;const _=document.querySelector("button.profile__edit-btn"),h=document.querySelector("button.profile__add-btn"),c=document.querySelector(".profile__edit-avatar"),u=document.querySelector(".profile__error"),d=new class extends i{constructor(e,t,i){super(i),this._popupImg=this._popup.querySelector(e),this._popupTitle=this._popup.querySelector(t)}open(e,t){this._src=e,this._title=t,this._popupImg.src=this._src,this._popupImg.alt=this._title,this._popupTitle.textContent="Photo of ".concat(this._title),super.open()}}(".popup__img",".popup__img-title",".popup_type_img"),p=new class extends i{constructor(e,t){var i,s;super(e),s=e=>{e.preventDefault(),this._handleConfirm(this._cardEl)},(i="_handleSubmit")in this?Object.defineProperty(this,i,{value:s,enumerable:!0,configurable:!0,writable:!0}):this[i]=s,this._handleConfirm=t,this._formElemet=this._popup.querySelector(".popup__form")}setEventListeners(){super.setEventListeners(),this._formElemet.addEventListener("submit",this._handleSubmit)}removeEventListeners(){super.removeEventListeners(),this._formElemet.removeEventListener("submit",this._handleSubmit)}open(e){super.open(),this._cardEl=e}}(".popup_type_delete",(function(e){g.deleteCard(e.getId()).then((()=>{e.deleteCard(),p.close()})).catch((e=>{console.log(e)}))})),m=new s(".popup_type_avatar",(function(e){m.renderLoading(!0),g.editProfileAvatar(e.avatarImageLink).then((e=>{L.setUserAvatar(e),m.close()})).catch((e=>{k(e)})).finally((()=>{m.renderLoading(!1)}))})),v=new s(".popup_type_new-card",(function(e){v.renderLoading(!0),g.createNewCard(e.placeImageLink,e.placeName).then((e=>{y(e),v.close()})).catch((e=>{k(e)})).finally((()=>{v.renderLoading(!1)}))})),E=new s(".popup_type_profile",(function(e){E.renderLoading(!0),g.editProfile({name:e.profileName,about:e.profileAboutMe}).then((e=>{L.setUserInfo(e),E.close()})).catch((e=>{console.log(e)})).finally((()=>{E.renderLoading(!1)}))})),f=new class{constructor(e,t){this._renderer=e,this._container=document.querySelector(t)}addItem(e){this._container.prepend(e)}rendererItems(e){e.forEach((e=>{this._renderer(e)}))}}(y,".gallery__list"),L=new class{constructor(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this._nameElement=document.querySelector(e),this._jobElement=document.querySelector(t),this._avatar=document.querySelector(i)}getUserInfo(){return{name:this._nameElement.textContent,about:this._jobElement.textContent}}setUserInfo(e){let{name:t,about:i,_id:s}=e;this._nameElement.textContent=t,this._nameElement.id=s,this._jobElement.textContent=i}setUserAvatar(e){let{avatar:t,name:i=null}=e;this._avatar.src=t,i&&(this._avatar.alt=i)}}(".profile__name",".profile__about-me",".profile__avatar"),b={};c.addEventListener("click",(()=>{b.avatarform.resetValidation(),m.open()}));const g=new class{constructor(e){a(this,"getInitialCards",(()=>this._call("/cards","GET"))),a(this,"getUserData",(()=>this._call("/users/me","GET"))),a(this,"addLike",(e=>this._call("/cards/likes/".concat(e),"PUT"))),a(this,"deleteLike",(e=>this._call("/cards/likes/".concat(e),"DELETE"))),a(this,"deleteCard",(e=>this._call("/cards/".concat(e),"DELETE"))),this._options=e}_call(e,t,i){return fetch(this._options.baseUrl+e,{method:t,headers:this._options.headers,body:JSON.stringify(i)}).then((e=>e.ok?e.json():Promise.reject(e.status)))}editProfile(e){let{name:t,about:i}=e;return this._call("/users/me","PATCH",{name:t,about:i})}createNewCard(e,t){return this._call("/cards","POST",{name:t,link:e})}editProfileAvatar(e){return this._call("/users/me/avatar ","PATCH",{avatar:e})}init(){return Promise.all([this.getUserData(),this.getInitialCards()])}}({baseUrl:"https://around.nomoreparties.co/v1/group-12",headers:{authorization:"9b621f0f-5dfe-43f1-95fd-e9cc188bcc35","Content-Type":"application/json"}});function y(t){f.addItem(function(t){const i=new e(t,"#gallery-item-template",(()=>{d.open(t.link,t.name)}),(()=>{p.open(i)}),C,g);return i.generateCard()}(t))}function C(e){e.updateLikes().then((t=>{e.setLikes(t)})).catch((e=>{console.log(e)}))}function k(e){u.textContent=e,u.style.display="block"}var S;g.init().then((e=>{let[t,i]=e;L.setUserInfo(t),L.setUserAvatar({avatar:t.avatar,name:t.name}),f.rendererItems(i)})).catch((e=>{k(e)})),h.addEventListener("click",(()=>{b.placeform.resetValidation(),v.open()})),_.addEventListener("click",(()=>{const{name:e,about:t}=L.getUserInfo();l.value=e,o.value=t,b.profileform.resetValidation(),E.open()})),S={formSelector:".popup__form",formInputsFieldSet:".popup__form-set",inputSelector:".popup__input",submitBtnSelector:".popup__submit-btn",inactiveBtnClass:"button_inactive",inputErrClass:"popup__input-text_type_error",inputErrActiveClass:"popup__input-text-error_active"},Array.from(document.querySelectorAll(S.formSelector)).forEach((e=>{const t=new n(S,e),i=e.getAttribute("name");b[i]=t,t.enableValidation()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsIm1hcHBpbmdzIjoieUJBQWUsTUFBTUEsRUFDakJDLFlBQWFDLEVBQU1DLEVBQWNDLEVBQWlCQyxFQUFrQkMsRUFBWUMsR0FDOUVDLEtBQUtDLE1BQXFCUCxFQUFLUSxLQUMvQkYsS0FBS0csS0FBb0JULEVBQUtVLEtBQzlCSixLQUFLSyxJQUFxQlgsRUFBS1csSUFDL0JMLEtBQUtNLE9BQXFCWixFQUFLYSxNQUMvQlAsS0FBS1EsV0FBcUJkLEVBQUtlLE1BQy9CVCxLQUFLVSxjQUFxQmYsRUFDMUJLLEtBQUtXLGlCQUFxQmYsRUFDMUJJLEtBQUtZLGtCQUFxQmYsRUFDMUJHLEtBQUthLFNBQXFCZCxFQUFJZSxRQUM5QmQsS0FBS2UsWUFBcUJoQixFQUFJaUIsV0FDOUJoQixLQUFLaUIsWUFBcUJsQixFQUFJbUIsV0FDOUJsQixLQUFLbUIsWUFBcUJyQixFQUMxQkUsS0FBS29CLFNBQXFCQyxTQUFTQyxjQUFjdEIsS0FBS1UsZUFBZWEsUUFBUUQsY0FBYyxrQkFBa0JFLFdBQVUsR0FDdkh4QixLQUFLeUIsV0FBcUJ6QixLQUFLb0IsU0FBU0UsY0FBYyxzQkFDdER0QixLQUFLMEIsWUFBcUIxQixLQUFLb0IsU0FBU0UsY0FBYyx1QkFDdER0QixLQUFLMkIsVUFBcUJOLFNBQVNDLGNBQWMsa0JBQ2pEdEIsS0FBSzRCLGNBQXFCNUIsS0FBS29CLFNBQVNFLGNBQWMsNEJBQ3REdEIsS0FBSzZCLGFBQXFCN0IsS0FBS29CLFNBQVNFLGNBQWMsc0JBQ3REdEIsS0FBSzhCLGtCQUFxQjlCLEtBQUtvQixTQUFTRSxjQUFjLHVCQUd4RFMsUUFDRSxPQUFPL0IsS0FBS0ssSUFFZGEsYUFDRWxCLEtBQUtvQixTQUFTWSxTQUNkaEMsS0FBS29CLFNBQVcsS0FJbEJhLGVBU0UsT0FSQWpDLEtBQUt5QixXQUFXUyxJQUFNbEMsS0FBS0csS0FDM0JILEtBQUswQixZQUFZUyxJQUFNbkMsS0FBS0MsTUFDNUJELEtBQUswQixZQUFZVSxZQUFjcEMsS0FBS0MsTUFFcENELEtBQUtvQixTQUFTaUIsR0FBS3JDLEtBQUtLLElBQ3hCTCxLQUFLc0MsVUFBVXRDLEtBQUsyQixVQUFVVSxJQUM5QnJDLEtBQU11QyxzQkFBc0J2QyxLQUFLMkIsVUFBVVUsSUFDM0NyQyxLQUFLd0MscUJBQ0V4QyxLQUFLb0IsU0FHZG1CLHNCQUFzQkUsR0FDakJBLEdBQVd6QyxLQUFLUSxXQUFXSCxNQUM1QkwsS0FBSzRCLGNBQWNjLE1BQU1DLFdBQWEsVUFJMUNMLFVBQVVHLEdBQ0x6QyxLQUFLNEMsWUFBWUgsSUFDbEJ6QyxLQUFLNkIsYUFBYWdCLFVBQVVDLElBQUksaUNBRVIsSUFBaEI5QyxLQUFLTSxPQUNiTixLQUFLOEIsa0JBQWtCTSxZQUFjcEMsS0FBS00sT0FBT3lDLE9BR2pEL0MsS0FBSzhCLGtCQUFrQk0sWUFBZSxFQUkxQ1EsWUFBWVAsR0FDVixZQUEwQixJQUFoQnJDLEtBQUtNLFFBQ05OLEtBQUtNLE9BQU8wQyxNQUFLLFNBQVNDLEdBQy9CLE9BQU9BLEVBQUs1QyxNQUFRZ0MsS0FNMUJHLHFCQUNFeEMsS0FBSzZCLGFBQWFxQixpQkFBaUIsU0FBUSxLQUFRbEQsS0FBS21CLFlBQVluQixTQUNwRUEsS0FBSzRCLGNBQWNzQixpQkFBaUIsU0FBUSxLQUFNbEQsS0FBS1ksa0JBQWtCWixTQUN6RUEsS0FBS3lCLFdBQVd5QixpQkFBaUIsUUFBU2xELEtBQUtXLGtCQUtqRHdDLGNBQ0UsT0FBR25ELEtBQUs2QixhQUFhZ0IsVUFBVU8sU0FBUyw0QkFDL0JwRCxLQUFLZSxZQUFZZixLQUFLb0IsU0FBU2lCLElBRy9CckMsS0FBS2EsU0FBU2IsS0FBS29CLFNBQVNpQixJQU92Q2dCLFNBQVMzRCxHQUNQTSxLQUFLOEIsa0JBQWtCTSxZQUFjMUMsRUFBS2EsTUFBTXdDLE9BQ2hEL0MsS0FBSzZCLGFBQWFnQixVQUFVUyxPQUFPLDZCLHdIQzdGMUIsTUFBTUMsRUFDakI5RCxZQUFjK0QsR0FBZ0IsMEJBZVhDLElBQ0MsV0FBWkEsRUFBSUMsS0FDQTFELEtBQUsyRCxXQWpCYSxpQ0ErQkpGLEtBQ2RBLEVBQUlHLE9BQU9mLFVBQVVPLFNBQVMsaUJBQ2xDSyxFQUFJRyxPQUFPZixVQUFVTyxTQUFTLGtCQUN0QnBELEtBQUsyRCxXQWpDakIzRCxLQUFLNkQsT0FBU3hDLFNBQVNDLGNBQWNrQyxHQUV6Q0csUUFDSTNELEtBQUs2RCxPQUFPaEIsVUFBVWIsT0FBTyxnQkFFN0JoQyxLQUFLOEQsdUJBR1RDLE9BQ0kvRCxLQUFLNkQsT0FBT2hCLFVBQVVDLElBQUksZ0JBRTFCOUMsS0FBS2dFLG9CQVNUQSxvQkFDSTNDLFNBQVM2QixpQkFBaUIsVUFBV2xELEtBQUtpRSxpQkFDMUM1QyxTQUFTNkIsaUJBQWlCLFlBQWFsRCxLQUFLa0Usd0JBR2hESix1QkFDSXpDLFNBQVM4QyxvQkFBb0IsVUFBWW5FLEtBQUtpRSxpQkFDOUM1QyxTQUFTOEMsb0JBQW9CLFlBQWNuRSxLQUFLa0UseUJDNUJ6QyxNQUFNRSxVQUF1QmIsRUFDcEM5RCxZQUFjK0QsRUFBZWEsRyxRQUN6QkMsTUFBTWQsRyxFQWlDTUMsSUFDWkEsRUFBSWMsaUJBQ0p2RSxLQUFLd0Usa0JBQWtCeEUsS0FBS3lFLHFCLEVBcENnQix3QixzQkFBQSxLLHVEQUFBLEssS0FFNUN6RSxLQUFLd0Usa0JBQXFCSCxFQUMxQnJFLEtBQUswRSxZQUFxQjFFLEtBQUs2RCxPQUFPdkMsY0FBYyxnQkFDcER0QixLQUFLMkUsV0FBcUIzRSxLQUFLMEUsWUFBWUUsaUJBQWlCLGlCQUM1RDVFLEtBQUs2RSxPQUFxQjdFLEtBQUswRSxZQUFZcEQsY0FBYyxzQkFDekR0QixLQUFLOEUsYUFBcUIsR0FHOUJMLGtCQU1JLE9BTEF6RSxLQUFLMkUsV0FBV0ksU0FBUUMsSUFDRkEsRUFBTUMsTUFDeEJqRixLQUFLOEUsYUFBYUUsRUFBTTlFLE1BQVE4RSxFQUFNQyxTQUduQ2pGLEtBQUs4RSxhQUdoQmQsb0JBT0lNLE1BQU1OLG9CQUNOaEUsS0FBSzBFLFlBQVl4QixpQkFBaUIsU0FBVWxELEtBQUtrRixlQUdyRHBCLHVCQUNJUSxNQUFNUix1QkFDTjlELEtBQUswRSxZQUFZUCxvQkFBb0IsU0FBVW5FLEtBQUtrRixlQVd4REMsY0FBY0MsR0FFTnBGLEtBQUs2RSxPQUFRekMsWUFEZGdELEVBQzRCLFlBR0EsT0FJbkN6QixRQUtJVyxNQUFNWCxRQUNOM0QsS0FBSzBFLFlBQVlXLFNDM0RkLE1BQU1DLEVBQ2pCN0YsWUFBYThGLEVBQVFDLEdBQ25CeEYsS0FBS3lGLGNBQXdCRixFQUFPRyxhQUNwQzFGLEtBQUsyRixvQkFBd0JKLEVBQU9LLG1CQUNwQzVGLEtBQUs2RixlQUF3Qk4sRUFBT08sY0FDcEM5RixLQUFLK0YsbUJBQXdCUixFQUFPUyxrQkFDcENoRyxLQUFLaUcsa0JBQXdCVixFQUFPVyxpQkFDcENsRyxLQUFLbUcsZUFBd0JaLEVBQU9hLGNBQ3BDcEcsS0FBS3FHLHFCQUF3QmQsRUFBT2Usb0JBQ3BDdEcsS0FBS3VHLFFBQXdCZixFQUM3QnhGLEtBQUt3RyxVQUF3QkMsTUFBTUMsS0FBSzFHLEtBQUt1RyxRQUFRM0IsaUJBQWlCNUUsS0FBSzZGLGlCQUMzRTdGLEtBQUs2RSxPQUF3QjdFLEtBQUt1RyxRQUFRakYsY0FBY3RCLEtBQUsrRixvQkFHL0RZLGNBQWVDLEdBQ2IsTUFBTUMsRUFBUTdHLEtBQUt1RyxRQUFRakYsY0FBYixXQUErQnNGLEVBQVF2RSxHQUF2QyxXQUVkdUUsRUFBUS9ELFVBQVVDLElBQUk5QyxLQUFLbUcsZ0JBQzNCVSxFQUFNekUsWUFBY3dFLEVBQVFFLGtCQUM1QkQsRUFBTWhFLFVBQVVDLElBQUk5QyxLQUFLcUcsc0JBRzNCVSxnQkFBaUJILEdBQ2YsTUFBTUMsRUFBUTdHLEtBQUt1RyxRQUFRakYsY0FBYixXQUErQnNGLEVBQVF2RSxHQUF2QyxXQUVkdUUsRUFBUS9ELFVBQVViLE9BQU9oQyxLQUFLbUcsZ0JBQzlCVSxFQUFNaEUsVUFBVWIsT0FBT2hDLEtBQUtxRyxzQkFDNUJRLEVBQU16RSxZQUFjLEdBR3RCNEUsb0JBQXFCSixHQUNkQSxFQUFRSyxTQUFTQyxNQUdwQmxILEtBQUsrRyxnQkFBZ0JILEdBRnJCNUcsS0FBSzJHLGNBQWNDLEdBTXZCTyxpQkFBa0JDLEdBQ2hCLE9BQU9BLEVBQVNwRSxNQUFNNEQsSUFBYUEsRUFBUUssU0FBU0MsUUFHdERHLHFCQUNNckgsS0FBS21ILGlCQUFpQm5ILEtBQUt3RyxZQUM3QnhHLEtBQUs2RSxPQUFPaEMsVUFBVUMsSUFBSTlDLEtBQUtpRyxtQkFDL0JqRyxLQUFLNkUsT0FBT3lDLFVBQVcsSUFFdkJ0SCxLQUFLNkUsT0FBT2hDLFVBQVViLE9BQU9oQyxLQUFLaUcsbUJBQ2xDakcsS0FBSzZFLE9BQU95QyxVQUFXLEdBSTNCQyxrQkFDRXZILEtBQUtxSCxxQkFFTHJILEtBQUt3RyxVQUFVekIsU0FBU3lDLElBQ3RCeEgsS0FBSytHLGdCQUFnQlMsTUFLekJoRixxQkFDRXhDLEtBQUtxSCxxQkFDTHJILEtBQUt3RyxVQUFVekIsU0FBUzZCLElBQ3RCQSxFQUFRMUQsaUJBQWlCLFNBQVMsS0FDaENsRCxLQUFLZ0gsb0JBQW9CSixHQUN6QjVHLEtBQUtxSCwyQkFLWEksbUJBQ0V6SCxLQUFLd0MscUJBQ0x4QyxLQUFLdUcsUUFBUXJELGlCQUFpQixVQUFXTyxHQUFRQSxFQUFJYyxvQkN6RTNELE1BWU1tRCxFQUErQnJHLFNBQVNzRyxNQUFNQyxZQUM5Q0MsRUFBd0JILEVBQVlJLFNBQVNDLFlBQzdDQyxFQUF3Qk4sRUFBWUksU0FBU0csZSx3SEFDckI1RyxTQUFTc0csTUFBTU8sVUNIN0MsTUFBTUMsRUFBc0I5RyxTQUFTQyxjQUFjLDRCQUM3QzhHLEVBQXNCL0csU0FBU0MsY0FBYywyQkFDN0MrRyxFQUFzQmhILFNBQVNDLGNBQWMseUJBRTdDZ0gsRUFBc0JqSCxTQUFTQyxjQUFjLG1CQUU3Q2lILEVBQXNCLElDaEJiLGNBQTZCaEYsRUFDeEM5RCxZQUFjK0ksRUFBYUMsRUFBZWpGLEdBQ3RDYyxNQUFNZCxHQUNOeEQsS0FBSzBJLFVBQVkxSSxLQUFLNkQsT0FBT3ZDLGNBQWNrSCxHQUMzQ3hJLEtBQUsySSxZQUFjM0ksS0FBSzZELE9BQU92QyxjQUFjbUgsR0FJakQxRSxLQUFLN0IsRUFBSzBHLEdBQ041SSxLQUFLNkksS0FBUzNHLEVBQ2RsQyxLQUFLOEksT0FBU0YsRUFDZDVJLEtBQUswSSxVQUFVeEcsSUFBT2xDLEtBQUs2SSxLQUMzQjdJLEtBQUswSSxVQUFVdkcsSUFBT25DLEtBQUs4SSxPQUMzQjlJLEtBQUsySSxZQUFZdkcsWUFBakIsbUJBQTJDcEMsS0FBSzhJLFFBQ2hEeEUsTUFBTVAsU0RFaUMsY0FBZSxvQkFBcUIsbUJBQzdFZ0YsRUFBc0IsSUVqQmIsY0FBcUN4RixFQUM1QzlELFlBQWMrRCxFQUFld0YsRyxRQUN6QjFFLE1BQU1kLEcsRUFxQk1DLElBQ1pBLEVBQUljLGlCQUNKdkUsS0FBS2lKLGVBQWVqSixLQUFLa0osVyxFQXhCZ0Isd0Isc0JBQUEsSyx1REFBQSxLLEtBRXpDbEosS0FBS2lKLGVBQXVCRCxFQUM1QmhKLEtBQUswRSxZQUF1QjFFLEtBQUs2RCxPQUFPdkMsY0FBYyxnQkFJMUQwQyxvQkFNSU0sTUFBTU4sb0JBQ05oRSxLQUFLMEUsWUFBWXhCLGlCQUFpQixTQUFXbEQsS0FBS2tGLGVBR3REcEIsdUJBQ0lRLE1BQU1SLHVCQUNOOUQsS0FBSzBFLFlBQVlQLG9CQUFvQixTQUFVbkUsS0FBS2tGLGVBUXhEbkIsS0FBS29GLEdBQ0Q3RSxNQUFNUCxPQUNOL0QsS0FBS2tKLFFBQVVDLElGYjJCLHNCQXFIckQsU0FBc0JDLEdBQ3JCckosRUFBSW1CLFdBQVdrSSxFQUFLckgsU0FDbkJzSCxNQUFLLEtBQ0pELEVBQUtsSSxhQUNMNkgsRUFBYXBGLFdBRWQyRixPQUFNQyxJQUNMQyxRQUFRQyxJQUFJRixTQTNIVkcsRUFBc0IsSUFBSXRGLEVBQWMsc0JBd0M5QyxTQUEyQnVGLEdBQ3pCRCxFQUFnQnZFLGVBQWMsR0FDOUJwRixFQUFJNkosa0JBQWtCRCxFQUFPRSxpQkFDNUJSLE1BQU9TLElBQ05DLEVBQVNDLGNBQWNGLEdBQ3ZCSixFQUFnQi9GLFdBRWpCMkYsT0FBUUMsSUFDUFUsRUFBWVYsTUFFYlcsU0FBUSxLQUNQUixFQUFnQnZFLGVBQWMsU0FsRDVCZ0YsRUFBc0IsSUFBSS9GLEVBQWUsd0JBZ0cvQyxTQUE4QnVGLEdBQzVCUSxFQUFhaEYsZUFBYyxHQUUzQnBGLEVBQUlxSyxjQUFjVCxFQUFPVSxlQUFlVixFQUFPVyxXQUM5Q2pCLE1BQUszSixJQUNKNkssRUFBb0I3SyxHQUNwQnlLLEVBQWF4RyxXQUVkMkYsT0FBUUMsSUFDUFUsRUFBWVYsTUFFYlcsU0FBUSxLQUNQQyxFQUFhaEYsZUFBYyxTQTNHekJxRixFQUFzQixJQUFJcEcsRUFBZSx1QkF3RDlDLFNBQWtDdUYsR0FDakNhLEVBQWFyRixlQUFjLEdBRTNCcEYsRUFBSTBLLFlBQVksQ0FBQ3ZLLEtBQU15SixFQUFPNUIsWUFBYTJDLE1BQU9mLEVBQU8xQixpQkFDeERvQixNQUFPUyxJQUNOQyxFQUFTWSxZQUFZYixHQUNyQlUsRUFBYTdHLFdBRWQyRixPQUFRQyxJQUNQQyxRQUFRQyxJQUFJRixNQUViVyxTQUFRLEtBQ1BNLEVBQWFyRixlQUFjLFNBbkV6QnlGLEVBQXNCLElHdkJiLE1BQ1huTCxZQUFhb0wsRUFBV0MsR0FDcEI5SyxLQUFLK0ssVUFBZUYsRUFDcEI3SyxLQUFLZ0wsV0FBZTNKLFNBQVNDLGNBQWN3SixHQUcvQ0csUUFBUUMsR0FDSmxMLEtBQUtnTCxXQUFXRyxRQUFRRCxHQUcxQkUsY0FBY0MsR0FDWkEsRUFBTXRHLFNBQVF1RyxJQUNadEwsS0FBSytLLFVBQVVPLFFIV2VmLEVETlgsa0JDT3ZCUixFQUFzQixJSXhCYixNQU9YdEssWUFBYzhMLEVBQWNDLEdBQW9DLElBQXZCQyxFQUF1Qix1REFBTixLQUN0RHpMLEtBQUswTCxhQUFpQnJLLFNBQVNDLGNBQWNpSyxHQUM3Q3ZMLEtBQUsyTCxZQUFpQnRLLFNBQVNDLGNBQWNrSyxHQUM3Q3hMLEtBQUs0TCxRQUFpQnZLLFNBQVNDLGNBQWNtSyxHQUdqREksY0FNSSxNQUFPLENBQ0gzTCxLQUFNRixLQUFLMEwsYUFBYXRKLFlBQ3hCc0ksTUFBTzFLLEtBQUsyTCxZQUFZdkosYUFJaEN1SSxZQUFZLEdBQXFCLElBQXJCLEtBQUV6SyxFQUFGLE1BQVF3SyxFQUFSLElBQWVySyxHQUFNLEVBSTdCTCxLQUFLMEwsYUFBYXRKLFlBQWdCbEMsRUFDbENGLEtBQUswTCxhQUFhckosR0FBZ0JoQyxFQUNsQ0wsS0FBSzJMLFlBQVl2SixZQUFpQnNJLEVBR3RDVixjQUFjLEdBQXVCLElBQXZCLE9BQUM4QixFQUFELEtBQVM1TCxFQUFPLE1BQU8sRUFDakNGLEtBQUs0TCxRQUFRMUosSUFBTTRKLEVBQ2hCNUwsSUFDQ0YsS0FBSzRMLFFBQVF6SixJQUFNakMsS0piVSxpQkFBa0IscUJBQXNCLG9CQUUzRTZMLEVBQWlCLEdBRXZCMUQsRUFBY25GLGlCQUFpQixTQUFVLEtBQ3ZDNkksRUFBYyxXQUFleEUsa0JBQzdCbUMsRUFBZ0IzRixVQUdsQixNQUFNaEUsRUFBTSxJS2pDRyxNQUNYTixZQUFZdU0sR0FBUywwQkFrQkgsSUFDVGhNLEtBQUtpTSxNQUFNLFNBQVMsU0FuQlIsc0JBc0JQLElBQ0xqTSxLQUFLaU0sTUFBTSxZQUFZLFNBdkJYLGtCQXdDVkMsR0FDRmxNLEtBQUtpTSxNQUFMLHVCQUEyQkMsR0FBUyxTQXpDeEIscUJBNENQQSxHQUNMbE0sS0FBS2lNLE1BQUwsdUJBQTJCQyxHQUFTLFlBN0N4QixxQkFnRFBBLEdBQ0xsTSxLQUFLaU0sTUFBTCxpQkFBcUJDLEdBQVMsWUFoRHJDbE0sS0FBS21NLFNBQVdILEVBSWxCQyxNQUFNRyxFQUFRQyxFQUFRM00sR0FDcEIsT0FBTzRNLE1BQU10TSxLQUFLbU0sU0FBU0ksUUFBVUgsRUFBUSxDQUMzQ0MsT0FBUUEsRUFDUkcsUUFBVXhNLEtBQUttTSxTQUFTSyxRQUN4QkMsS0FBTUMsS0FBS0MsVUFBVWpOLEtBRXRCMkosTUFBS3VELEdBQ0RBLEVBQUlDLEdBQ0dELEVBQUlFLE9BRVBDLFFBQVFDLE9BQU9KLEVBQUlLLFVBVzlCeEMsWUFBWSxHQUFlLElBQWYsS0FBQ3ZLLEVBQUQsTUFBT3dLLEdBQVEsRUFDekIsT0FBTzFLLEtBQUtpTSxNQUFNLFlBQVksUUFBUSxDQUNwQy9MLEtBQU1BLEVBQ053SyxNQUFPQSxJQUlYTixjQUFlaEssRUFBTUYsR0FDbkIsT0FBT0YsS0FBS2lNLE1BQU0sU0FBUyxPQUFPLENBQ2hDL0wsS0FBTUEsRUFDTkUsS0FBTUEsSUFnQlZ3SixrQkFBa0JzRCxHQUNoQixPQUFPbE4sS0FBS2lNLE1BQU0sb0JBQW9CLFFBQVEsQ0FDNUNILE9BQVNvQixJQUliQyxPQUNFLE9BQU9KLFFBQVFLLElBQUksQ0FBQ3BOLEtBQUtxTixjQUFlck4sS0FBS3NOLHNCTDNCL0IsQ0FDbEJmLFFBQVMsOENBQ1RDLFFBQVMsQ0FDUGUsY0FBZSx1Q0FDZixlQUFnQixzQkE0RXBCLFNBQVVoRCxFQUFvQmUsR0FDNUJWLEVBQVNLLFFBWlYsU0FBcUJLLEdBQ3BCLE1BQU1sQyxFQUFPLElBQUk1SixFQUNmOEwsRUFDQSwwQkFDQSxLQUFRL0MsRUFBY3hFLEtBQUt1SCxFQUFLbEwsS0FBTWtMLEVBQUtwTCxTQUMzQyxLQUFRNkksRUFBYWhGLEtBQUtxRixLQUMxQnRKLEVBQ0FDLEdBQ0EsT0FBT3FKLEVBQUtuSCxlQUlHdUwsQ0FBV2xDLElBb0M5QixTQUFTeEwsRUFBV3NKLEdBQ2xCQSxFQUFLakcsY0FDRmtHLE1BQU0zSixJQUNMMEosRUFBSy9GLFNBQVMzRCxNQUVmNEosT0FBT0MsSUFDTkMsUUFBUUMsSUFBSUYsTUFtQmpCLFNBQVNVLEVBQVlWLEdBQ3BCakIsRUFBUWxHLFlBQWNtSCxFQUN0QmpCLEVBQVE1RixNQUFNK0ssUUFBVyxRQUlEbEksSUFBQUEsRUF6STFCeEYsRUFBSW9OLE9BQ0g5RCxNQUFLLElBQWtCLElBQWhCcEcsRUFBS29JLEdBQVcsRUFDdEJ0QixFQUFTWSxZQUFZMUgsR0FDckI4RyxFQUFTQyxjQUFjLENBQUM4QixPQUFRN0ksRUFBSzZJLE9BQU81TCxLQUFNK0MsRUFBSy9DLE9BQ3ZEMEssRUFBU1EsY0FBY0MsTUFFeEIvQixPQUFRQyxJQUNQVSxFQUFZVixNQThDYm5CLEVBQW1CbEYsaUJBQWlCLFNBQVMsS0FDMUM2SSxFQUFjLFVBQWN4RSxrQkFDNUI0QyxFQUFhcEcsVUFpRWpCb0UsRUFBZWpGLGlCQUFpQixTQUFTLEtBQ3ZDLE1BQU0sS0FBQ2hELEVBQUQsTUFBT3dLLEdBQVVYLEVBQVM4QixjQUNoQ2hFLEVBQVU1QyxNQUFTL0UsRUFDbkI4SCxFQUFhL0MsTUFBU3lGLEVBQ3RCcUIsRUFBYyxZQUFnQnhFLGtCQUM5QmlELEVBQWF6RyxVQVlXd0IsRURyTFgsQ0FDWEcsYUFBYyxlQUNkRSxtQkFBb0IsbUJBQ3BCRSxjQUFlLGdCQUNmRSxrQkFBbUIscUJBQ25CRSxpQkFBa0Isa0JBQ2xCRSxjQUFlLCtCQUNmRSxvQkFBcUIsa0NDK0tORyxNQUFNQyxLQUFLckYsU0FBU3VELGlCQUFpQlcsRUFBT0csZUFDcERYLFNBQVMySSxJQUNoQixNQUFNQyxFQUFZLElBQUlySSxFQUFjQyxFQUFPbUksR0FFckNFLEVBQVdGLEVBQVlHLGFBQWEsUUFHMUM5QixFQUFlNkIsR0FBWUQsRUFDNUJBLEVBQVVsRyxzQiIsInNvdXJjZXMiOlsid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3V0aWxzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoQ29uZmlybWF0aW9uLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvQXBpLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IGNsYXNzIENhcmQge1xyXG4gICAgY29uc3RydWN0b3IoIGRhdGEsIGNhcmRTZWxlY3RvciwgaGFuZGxlQ2FyZENsaWNrLCBoYW5kbGVUcmFzaENsaWNrLCBoYW5kbGVMaWtlLCBhcGkpIHtcclxuICAgICAgdGhpcy5fdGV4dCAgICAgICAgICAgICAgPSBkYXRhLm5hbWU7XHJcbiAgICAgIHRoaXMuX2ltZyAgICAgICAgICAgICAgPSBkYXRhLmxpbms7XHJcbiAgICAgIHRoaXMuX2lkICAgICAgICAgICAgICAgID0gZGF0YS5faWQ7XHJcbiAgICAgIHRoaXMuX2xpa2VzICAgICAgICAgICAgID0gZGF0YS5saWtlcztcclxuICAgICAgdGhpcy5fQ2FyZG93bmVyICAgICAgICAgPSBkYXRhLm93bmVyO1xyXG4gICAgICB0aGlzLl9jYXJkU2VsZWN0b3IgICAgICA9IGNhcmRTZWxlY3RvcjtcclxuICAgICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrICAgPSBoYW5kbGVDYXJkQ2xpY2s7XHJcbiAgICAgIHRoaXMuX2hhbmRsZVRyYXNoQ2xpY2sgID0gaGFuZGxlVHJhc2hDbGljaztcclxuICAgICAgdGhpcy5fYWRkTGlrZSAgICAgICAgICAgPSBhcGkuYWRkTGlrZTtcclxuICAgICAgdGhpcy5fZGVsZXRlTGlrZSAgICAgICAgPSBhcGkuZGVsZXRlTGlrZTtcclxuICAgICAgdGhpcy5fZGVsZXRlQ2FyZCAgICAgICAgPSBhcGkuZGVsZXRlQ2FyZDtcclxuICAgICAgdGhpcy5faGFuZGxlTGlrZSAgICAgICAgPSBoYW5kbGVMaWtlO1xyXG4gICAgICB0aGlzLl9lbGVtZW50ICAgICAgICAgICA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodGhpcy5fY2FyZFNlbGVjdG9yKS5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZ2FsbGVyeV9faXRlbVwiKS5jbG9uZU5vZGUodHJ1ZSk7XHJcbiAgICAgIHRoaXMuX2l0ZW1JbWdFbCAgICAgICAgID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmdhbGxlcnlfX2l0ZW0taW1nXCIpO1xyXG4gICAgICB0aGlzLl9pdGVtTmFtZUVsICAgICAgICA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5nYWxsZXJ5X19pdGVtLW5hbWVcIik7XHJcbiAgICAgIHRoaXMucHJvZmlsZUVsICAgICAgICAgID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19uYW1lXCIpO1xyXG4gICAgICB0aGlzLl9pdGVtVHJhc2hCdG4gICAgICA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5nYWxsZXJ5X19pdGVtLXRyYXNoLWJ0blwiKTtcclxuICAgICAgdGhpcy5faXRlbUxpa2VCdG4gICAgICAgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZ2FsbGVyeV9fbGlrZS1idG5cIik7XHJcbiAgICAgIHRoaXMuX2dhbGxlcnlsaWtlQ291bnQgID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmdsbGVyeV9fbGlrZS1jb3VudFwiKTtcclxuICAgIH1cclxuXHJcbiAgICBnZXRJZCgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMuX2lkO1xyXG4gICAgfVxyXG4gICAgZGVsZXRlQ2FyZCgpIHtcclxuICAgICAgdGhpcy5fZWxlbWVudC5yZW1vdmUoKTtcclxuICAgICAgdGhpcy5fZWxlbWVudCA9IG51bGw7XHJcbiAgICB9XHJcblxyXG5cclxuICAgIGdlbmVyYXRlQ2FyZCgpIHtcclxuICAgICAgdGhpcy5faXRlbUltZ0VsLnNyYyA9IHRoaXMuX2ltZztcclxuICAgICAgdGhpcy5faXRlbU5hbWVFbC5hbHQgPSB0aGlzLl90ZXh0O1xyXG4gICAgICB0aGlzLl9pdGVtTmFtZUVsLnRleHRDb250ZW50ID0gdGhpcy5fdGV4dDtcclxuIFxyXG4gICAgICB0aGlzLl9lbGVtZW50LmlkID0gdGhpcy5faWQ7XHJcbiAgICAgIHRoaXMuX2luaXRMaWtlKHRoaXMucHJvZmlsZUVsLmlkKTtcclxuICAgICAgdGhpcy4gX2RlbGV0ZUljb25WaXNpYmlsaXR5KHRoaXMucHJvZmlsZUVsLmlkKTtcclxuICAgICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgICAgcmV0dXJuIHRoaXMuX2VsZW1lbnQ7XHJcbiAgICB9XHJcbiAgXHJcbiAgICBfZGVsZXRlSWNvblZpc2liaWxpdHkodXNlcklkKXtcclxuICAgICAgaWYodXNlcklkICE9ICB0aGlzLl9DYXJkb3duZXIuX2lkKSB7XHJcbiAgICAgICAgdGhpcy5faXRlbVRyYXNoQnRuLnN0eWxlLnZpc2liaWxpdHkgPSBcImhpZGRlblwiO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgX2luaXRMaWtlKHVzZXJJZCl7XHJcbiAgICAgIGlmKHRoaXMuX3VzZXJFeGlzdHModXNlcklkKSkge1xyXG4gICAgICAgIHRoaXMuX2l0ZW1MaWtlQnRuLmNsYXNzTGlzdC5hZGQoJ2dhbGxlcnlfX2xpa2UtYnRuX2FjdGl2ZScpOyBcclxuICAgICAgfVxyXG4gICAgICBpZih0eXBlb2YgdGhpcy5fbGlrZXMgIT09IFwidW5kZWZpbmVkXCIpe1xyXG4gICAgICAgIHRoaXMuX2dhbGxlcnlsaWtlQ291bnQudGV4dENvbnRlbnQgPSB0aGlzLl9saWtlcy5sZW5ndGg7XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgdGhpcy5fZ2FsbGVyeWxpa2VDb3VudC50ZXh0Q29udGVudCAgPSAwO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgX3VzZXJFeGlzdHMoaWQpIHtcclxuICAgICAgaWYodHlwZW9mIHRoaXMuX2xpa2VzICE9PSBcInVuZGVmaW5lZFwiKXtcclxuICAgICAgICByZXR1cm4gdGhpcy5fbGlrZXMuc29tZShmdW5jdGlvbih1c2VyKSB7XHJcbiAgICAgICAgICByZXR1cm4gdXNlci5faWQgPT09IGlkO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICAgIHRoaXMuX2l0ZW1MaWtlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCgpID0+ICB7dGhpcy5faGFuZGxlTGlrZSh0aGlzKX0pO1xyXG4gICAgICB0aGlzLl9pdGVtVHJhc2hCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsKCkgPT57dGhpcy5faGFuZGxlVHJhc2hDbGljayh0aGlzKX0pO1xyXG4gICAgICB0aGlzLl9pdGVtSW1nRWwuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMuX2hhbmRsZUNhcmRDbGljayk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIERlY2lkZSB3aGV0aGVyIHRvIGRlbGV0ZSBvciBhZGQgYSBMaWtlIGRlcGVuZGluZyBvbiBhbiBleGlzdGluZyBzaXR1YXRpb25cclxuICAgICAqL1xyXG4gICAgdXBkYXRlTGlrZXMoKSB7XHJcbiAgICAgIGlmKHRoaXMuX2l0ZW1MaWtlQnRuLmNsYXNzTGlzdC5jb250YWlucygnZ2FsbGVyeV9fbGlrZS1idG5fYWN0aXZlJykpe1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9kZWxldGVMaWtlKHRoaXMuX2VsZW1lbnQuaWQpO1xyXG4gICAgICB9XHJcbiAgICAgIGVsc2Uge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9hZGRMaWtlKHRoaXMuX2VsZW1lbnQuaWQpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBEZWFsaW5nIHdpdGggdGhlIHN1Y2Nlc3Mgb2YgdXBkYXRpbmcgTGlrZSBvbiB0aGUgc2VydmVyICgudGhlbilcclxuICAgICAqL1xyXG4gICAgc2V0TGlrZXMoZGF0YSkge1xyXG4gICAgICB0aGlzLl9nYWxsZXJ5bGlrZUNvdW50LnRleHRDb250ZW50ID0gZGF0YS5saWtlcy5sZW5ndGg7XHJcbiAgICAgIHRoaXMuX2l0ZW1MaWtlQnRuLmNsYXNzTGlzdC50b2dnbGUoJ2dhbGxlcnlfX2xpa2UtYnRuX2FjdGl2ZScpO1xyXG4gICAgfVxyXG4gIH0iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cCB7XHJcbiAgICBjb25zdHJ1Y3RvciAoIHBvcHVwU2VsZWN0b3IgKSB7XHJcbiAgICAgICAgdGhpcy5fcG9wdXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgfVxyXG4gICAgY2xvc2UoKSB7XHJcbiAgICAgICAgdGhpcy5fcG9wdXAuY2xhc3NMaXN0LnJlbW92ZShcInBvcHVwX29wZW5lZFwiKTtcclxuICAgICAgICAvKiogcG9wdXBzIGNsb3NlIGNsaWNrIHJlbW92ZSBldmVudHMgKi9cclxuICAgICAgICB0aGlzLnJlbW92ZUV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICB9XHJcblxyXG4gICAgb3BlbigpIHtcclxuICAgICAgICB0aGlzLl9wb3B1cC5jbGFzc0xpc3QuYWRkKFwicG9wdXBfb3BlbmVkXCIpO1xyXG4gICAgICAgIC8qKiBwb3B1cHMgb3BlbiBldmVudHMgKi9cclxuICAgICAgICB0aGlzLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICB9XHJcblxyXG4gICAgX2hhbmRsZUVzY0Nsb3NlID0gKGV2dCkgPT57XHJcbiAgICAgICAgaWYgKGV2dC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKTsgIFxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XHJcbiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCB0aGlzLl9oYW5kbGVDbGlja0Nsb3NlUG9wdXApO1xyXG4gICAgfVxyXG5cclxuICAgIHJlbW92ZUV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsICB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XHJcbiAgICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCAgdGhpcy5faGFuZGxlQ2xpY2tDbG9zZVBvcHVwKTtcclxuICAgIH1cclxuXHJcbiAgICBfaGFuZGxlQ2xpY2tDbG9zZVBvcHVwID0gKGV2dCkgPT4ge1xyXG4gICAgICAgICAgICBpZiAoZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJwb3B1cF9vcGVuZWRcIikgfHxcclxuICAgICAgICAgICAgZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJwb3B1cF9fY2xvc2VcIikgKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG5cclxufSIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhGb3JtICBleHRlbmRzIFBvcHVwIHtcclxuICAgICAgICBjb25zdHJ1Y3RvciAoIHBvcHVwU2VsZWN0b3IsIGhhbmRsZUZvcm1TdWJtaXQgKSB7XHJcbiAgICAgICAgICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgICAgICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ICA9IGhhbmRsZUZvcm1TdWJtaXQ7XHJcbiAgICAgICAgICAgIHRoaXMuX2Zvcm1FbGVtZXQgICAgICAgID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fZm9ybVwiKTtcclxuICAgICAgICAgICAgdGhpcy5faW5wdXRzQXJyICAgICAgICAgPSB0aGlzLl9mb3JtRWxlbWV0LnF1ZXJ5U2VsZWN0b3JBbGwoXCIucG9wdXBfX2lucHV0XCIpO1xyXG4gICAgICAgICAgICB0aGlzLl9idG5FbCAgICAgICAgICAgICA9IHRoaXMuX2Zvcm1FbGVtZXQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fc3VibWl0LWJ0blwiKTtcclxuICAgICAgICAgICAgdGhpcy5faW5wdXRWYWx1ZXMgICAgICAgPSB7fTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIF9nZXRJbnB1dFZhbHVlcygpIHtcclxuICAgICAgICAgICAgdGhpcy5faW5wdXRzQXJyLmZvckVhY2goaW5wdXQgPT4ge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaW5wdXROYW1lID0gaW5wdXQudmFsdWVcclxuICAgICAgICAgICAgICAgIHRoaXMuX2lucHV0VmFsdWVzW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWU7XHJcbiAgICAgICAgICAgICAgICAvL3RoaXMuX2lucHV0VmFsdWVzLnZhbHVlID0gaW5wdXQudmFsdWU7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9pbnB1dFZhbHVlcyA7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgICAgICAgICAgLyoqXHJcbiAgICAgICAgICAgICAqIEl0IG1vZGlmaWVzIHRoZSBzZXRFdmVudExpc3RlbmVycygpIHBhcmVudCBtZXRob2QuIFxyXG4gICAgICAgICAgICAgKiBUaGUgc2V0RXZlbnRMaXN0ZW5lcnMoKSBtZXRob2Qgb2YgdGhlIFBvcHVwV2l0aEZvcm0gY2xhc3NcclxuICAgICAgICAgICAgICogIGhhcyB0byBhZGQgdGhlIHN1Ym1pdCBldmVudCBoYW5kbGVyIHRvIHRoZSBmb3JtIGFuZCB0aGUgY2xpY2sgXHJcbiAgICAgICAgICAgICAqIGV2ZW50IGxpc3RlbmVyIHRvIHRoZSBjbG9zZSBpY29uLlxyXG4gICAgICAgICAgICAgKi9cclxuICAgICAgICAgICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgICAgICAgICAgdGhpcy5fZm9ybUVsZW1ldC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIHRoaXMuX2hhbmRsZVN1Ym1pdCk7IFxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmVtb3ZlRXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICAgICAgICAgIHN1cGVyLnJlbW92ZUV2ZW50TGlzdGVuZXJzKClcclxuICAgICAgICAgICAgdGhpcy5fZm9ybUVsZW1ldC5yZW1vdmVFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIHRoaXMuX2hhbmRsZVN1Ym1pdCk7IFxyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICBfaGFuZGxlU3VibWl0ID0oZXZ0KSA9PntcclxuICAgICAgICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7IFxyXG4gICAgICAgICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KHRoaXMuX2dldElucHV0VmFsdWVzKCkpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogY2hhbmdlIGJ1dHRvbiB0ZXh0IHRvIC4uc2F2aW5nIHVudGlsIHByb2Nlc3MgZW5kc1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHJlbmRlckxvYWRpbmcoaXNMb2FkaW5nKSB7XHJcbiAgICAgICAgICAgIGlmKGlzTG9hZGluZykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fYnRuRWwgLnRleHRDb250ZW50ID0gXCJTYXZpbmcuLi5cIjsgXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9idG5FbCAudGV4dENvbnRlbnQgPSBcIlNhdmVcIjsgXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsb3NlKCkge1xyXG4gICAgICAgICAgICAvKipcclxuICAgICAgICAgICAgICogSXQgbW9kaWZpZXMgdGhlIGNsb3NlKCkgcGFyZW50IG1ldGhvZCBcclxuICAgICAgICAgICAgICogaW4gb3JkZXIgdG8gcmVzZXQgdGhlIGZvcm0gb25jZSB0aGUgcG9wdXAgaXMgY2xvc2VkLlxyXG4gICAgICAgICAgICAgKi9cclxuICAgICAgICAgICAgc3VwZXIuY2xvc2UoKTtcclxuICAgICAgICAgICAgdGhpcy5fZm9ybUVsZW1ldC5yZXNldCgpO1xyXG4gICAgICAgIH1cclxuXHJcbn0iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBGb3JtVmFsaWRhdG9yIHtcclxuICAgIGNvbnN0cnVjdG9yKCBjb25maWcsIGZvcm1FbCApe1xyXG4gICAgICB0aGlzLl9mb3JtU2VsZWN0b3IgICAgICAgICA9IGNvbmZpZy5mb3JtU2VsZWN0b3I7XHJcbiAgICAgIHRoaXMuX2Zvcm1JbnB1dHNGaWVsZFNldCAgID0gY29uZmlnLmZvcm1JbnB1dHNGaWVsZFNldDtcclxuICAgICAgdGhpcy5faW5wdXRTZWxlY3RvciAgICAgICAgPSBjb25maWcuaW5wdXRTZWxlY3RvcjtcclxuICAgICAgdGhpcy5fc3VibWl0QnRuU2VsZWN0b3IgICAgPSBjb25maWcuc3VibWl0QnRuU2VsZWN0b3I7XHJcbiAgICAgIHRoaXMuX2luYWN0aXZlQnRuQ2xhc3MgICAgID0gY29uZmlnLmluYWN0aXZlQnRuQ2xhc3M7XHJcbiAgICAgIHRoaXMuX2lucHV0RXJyQ2xhc3MgICAgICAgID0gY29uZmlnLmlucHV0RXJyQ2xhc3M7XHJcbiAgICAgIHRoaXMuX2lucHV0RXJyQWN0aXZlQ2xhc3MgID0gY29uZmlnLmlucHV0RXJyQWN0aXZlQ2xhc3M7XHJcbiAgICAgIHRoaXMuX2Zvcm1FbCAgICAgICAgICAgICAgID0gZm9ybUVsO1xyXG4gICAgICB0aGlzLl9pbnB1dExzdCAgICAgICAgICAgICA9IEFycmF5LmZyb20odGhpcy5fZm9ybUVsLnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5faW5wdXRTZWxlY3RvcikpO1xyXG4gICAgICB0aGlzLl9idG5FbCAgICAgICAgICAgICAgICA9IHRoaXMuX2Zvcm1FbC5xdWVyeVNlbGVjdG9yKHRoaXMuX3N1Ym1pdEJ0blNlbGVjdG9yKTtcclxuICAgIH1cclxuXHJcbiAgICBfc2hvd0lucHV0RXJyIChpbnB1dEVsKSB7XHJcbiAgICAgIGNvbnN0IGVyckVsID0gdGhpcy5fZm9ybUVsLnF1ZXJ5U2VsZWN0b3IoYC4ke2lucHV0RWwuaWR9LWVycm9yYCk7XHJcbiAgICAgIFxyXG4gICAgICBpbnB1dEVsLmNsYXNzTGlzdC5hZGQodGhpcy5faW5wdXRFcnJDbGFzcyk7XHJcbiAgICAgIGVyckVsLnRleHRDb250ZW50ID0gaW5wdXRFbC52YWxpZGF0aW9uTWVzc2FnZTtcclxuICAgICAgZXJyRWwuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbnB1dEVyckFjdGl2ZUNsYXNzKTtcclxuICAgIH1cclxuXHJcbiAgICBfaGlkZUlucHV0RXJyb3IgKGlucHV0RWwpIHtcclxuICAgICAgY29uc3QgZXJyRWwgPSB0aGlzLl9mb3JtRWwucXVlcnlTZWxlY3RvcihgLiR7aW5wdXRFbC5pZH0tZXJyb3JgKTtcclxuXHJcbiAgICAgIGlucHV0RWwuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbnB1dEVyckNsYXNzKTtcclxuICAgICAgZXJyRWwuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbnB1dEVyckFjdGl2ZUNsYXNzKTtcclxuICAgICAgZXJyRWwudGV4dENvbnRlbnQgPSBcIlwiO1xyXG4gICAgfVxyXG5cclxuICAgIF9jaGVja0lucHV0VmFsaWRpdHkgKGlucHV0RWwpIHtcclxuICAgICAgaWYgKCFpbnB1dEVsLnZhbGlkaXR5LnZhbGlkKSB7XHJcbiAgICAgICAgdGhpcy5fc2hvd0lucHV0RXJyKGlucHV0RWwpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWwpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgX2hhc0ludmFsaWRJbnB1dCAoaW5wdXRMc3QpIHtcclxuICAgICAgcmV0dXJuIGlucHV0THN0LnNvbWUoKGlucHV0RWwpID0+ICFpbnB1dEVsLnZhbGlkaXR5LnZhbGlkKTtcclxuICAgIH1cclxuXHJcbiAgICBfdG9nZ2xlQnV0dG9uU3RhdGUgKCkge1xyXG4gICAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0KHRoaXMuX2lucHV0THN0KSkge1xyXG4gICAgICAgIHRoaXMuX2J0bkVsLmNsYXNzTGlzdC5hZGQodGhpcy5faW5hY3RpdmVCdG5DbGFzcyk7XHJcbiAgICAgICAgdGhpcy5fYnRuRWwuZGlzYWJsZWQgPSB0cnVlO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHRoaXMuX2J0bkVsLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdG5DbGFzcyk7XHJcbiAgICAgICAgdGhpcy5fYnRuRWwuZGlzYWJsZWQgPSBmYWxzZTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHJlc2V0VmFsaWRhdGlvbigpIHtcclxuICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTsgXHJcblxyXG4gICAgICB0aGlzLl9pbnB1dExzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIFxyXG4gICAgICB9KTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgX3NldEV2ZW50TGlzdGVuZXJzICgpIHtcclxuICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuICAgICAgdGhpcy5faW5wdXRMc3QuZm9yRWFjaCgoaW5wdXRFbCkgPT4ge1xyXG4gICAgICAgIGlucHV0RWwuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHsgICBcclxuICAgICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsKTtcclxuICAgICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGVuYWJsZVZhbGlkYXRpb24gKCkge1xyXG4gICAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgICB0aGlzLl9mb3JtRWwuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiBldnQucHJldmVudERlZmF1bHQoKSk7XHJcbiAgICB9XHJcblxyXG4gIH0iLCJjb25zdCBjb25maWcgPSB7XHJcbiAgICBmb3JtU2VsZWN0b3I6IFwiLnBvcHVwX19mb3JtXCIsXHJcbiAgICBmb3JtSW5wdXRzRmllbGRTZXQ6IFwiLnBvcHVwX19mb3JtLXNldFwiLFxyXG4gICAgaW5wdXRTZWxlY3RvcjogXCIucG9wdXBfX2lucHV0XCIsXHJcbiAgICBzdWJtaXRCdG5TZWxlY3RvcjogXCIucG9wdXBfX3N1Ym1pdC1idG5cIixcclxuICAgIGluYWN0aXZlQnRuQ2xhc3M6IFwiYnV0dG9uX2luYWN0aXZlXCIsXHJcbiAgICBpbnB1dEVyckNsYXNzOiBcInBvcHVwX19pbnB1dC10ZXh0X3R5cGVfZXJyb3JcIixcclxuICAgIGlucHV0RXJyQWN0aXZlQ2xhc3M6IFwicG9wdXBfX2lucHV0LXRleHQtZXJyb3JfYWN0aXZlXCJcclxuICB9XHJcblxyXG5cclxuLyoqIHByb2ZpbGUgcG9wdXAgZWxlbWVudHMgKi9cclxuY29uc3QgcHJvZmlsZUZvcm0gICAgICAgICAgICAgICAgICA9IGRvY3VtZW50LmZvcm1zLnByb2ZpbGVmb3JtO1xyXG5jb25zdCBpbnB1dE5hbWUgICAgICAgICAgICAgPSBwcm9maWxlRm9ybS5lbGVtZW50cy5wcm9maWxlTmFtZTtcclxuY29uc3QgaW5wdXRBYm91dE1lICAgICAgICAgID0gcHJvZmlsZUZvcm0uZWxlbWVudHMucHJvZmlsZUFib3V0TWU7XHJcbmNvbnN0IHBsYWNlRm9ybSAgICAgICAgICAgICA9IGRvY3VtZW50LmZvcm1zLnBsYWNlZm9ybTtcclxuXHJcbmNvbnN0IGdhbGxlcnlMaXN0U2VsZWN0b3IgID0gXCIuZ2FsbGVyeV9fbGlzdFwiO1xyXG5cclxuZXhwb3J0IHtjb25maWcsIGlucHV0TmFtZSwgaW5wdXRBYm91dE1lLCBwbGFjZUZvcm0sIGdhbGxlcnlMaXN0U2VsZWN0b3J9XHJcblxyXG4iLCJpbXBvcnQgXCIuL2luZGV4LmNzc1wiO1xyXG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XHJcbmltcG9ydCBDYXJkIGZyb20gXCIuLi9jb21wb25lbnRzL0NhcmQuanNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSAgXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhDb25maXJtYXRpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoQ29uZmlybWF0aW9uLmpzXCI7XHJcbmltcG9ydCBVc2VySW5mbyBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mby5qc1wiO1xyXG5pbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tIFwiLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XHJcbmltcG9ydCB7Y29uZmlnLCBpbnB1dE5hbWUsIGlucHV0QWJvdXRNZSwgZ2FsbGVyeUxpc3RTZWxlY3Rvcn0gIGZyb20gXCIuLi91dGlscy9jb25zdGFudHMuanNcIjtcclxuaW1wb3J0IEFwaSBmcm9tIFwiLi4vY29tcG9uZW50cy9BcGkuanNcIjtcclxuXHJcbi8qKiBtYWluIGJ1dHRvbnMgKi9cclxuY29uc3QgcHJvZmlsZUVkaXRCdG4gICAgICA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCJidXR0b24ucHJvZmlsZV9fZWRpdC1idG5cIik7XHJcbmNvbnN0IG9wZU5ld0NhcmRQb3B1cEJ0biAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiYnV0dG9uLnByb2ZpbGVfX2FkZC1idG5cIik7XHJcbmNvbnN0IGF2YXRhckVkaXRCdG4gICAgICAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2VkaXQtYXZhdGFyXCIpXHJcblxyXG5jb25zdCBlcnJvckVsICAgICAgICAgICAgID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19lcnJvclwiKTtcclxuXHJcbmNvbnN0IHBvcHVwQ2FyZEl0ZW0gICAgICAgPSBuZXcgUG9wdXBXaXRoSW1hZ2UoXCIucG9wdXBfX2ltZ1wiLCBcIi5wb3B1cF9faW1nLXRpdGxlXCIsIFwiLnBvcHVwX3R5cGVfaW1nXCIpO1xyXG5jb25zdCBwb3B1cENvbmZpcm0gICAgICAgID0gbmV3IFBvcHVwV2l0aENvbmZpcm1hdGlvbihcIi5wb3B1cF90eXBlX2RlbGV0ZVwiLCBoYW5kbGVEZWxldGUpO1xyXG5jb25zdCBlZGl0QXZhdGFyUG9wdXAgICAgID0gbmV3IFBvcHVwV2l0aEZvcm0oXCIucG9wdXBfdHlwZV9hdmF0YXJcIiwgaGFuZGxlRWRpdEF2YXRhcik7XHJcbmNvbnN0IG5ld0NhcmRQb3B1cCAgICAgICAgPSBuZXcgUG9wdXBXaXRoRm9ybSAoXCIucG9wdXBfdHlwZV9uZXctY2FyZFwiLCBoYW5kbGVDcmVhdGVOZXdDYXJkKTtcclxuY29uc3QgcHJvZmlsZVBvcHVwICAgICAgICA9IG5ldyBQb3B1cFdpdGhGb3JtIChcIi5wb3B1cF90eXBlX3Byb2ZpbGVcIiwgIGhhbmRsZVByb2ZpbGVGb3JtU3VibWl0KTtcclxuY29uc3QgY2FyZExpc3QgICAgICAgICAgICA9IG5ldyBTZWN0aW9uKGFkZEdhbGxlcnlDYXJkSXRlbSwgZ2FsbGVyeUxpc3RTZWxlY3Rvcik7XHJcbmNvbnN0IHVzZXJJbmZvICAgICAgICAgICAgPSBuZXcgVXNlckluZm8oXCIucHJvZmlsZV9fbmFtZVwiLCBcIi5wcm9maWxlX19hYm91dC1tZVwiLCBcIi5wcm9maWxlX19hdmF0YXJcIik7XHJcblxyXG5jb25zdCBmb3JtVmFsaWRhdG9ycyA9IHt9O1xyXG5cclxuYXZhdGFyRWRpdEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgICgpID0+IHtcclxuICBmb3JtVmFsaWRhdG9yc1tcImF2YXRhcmZvcm1cIl0ucmVzZXRWYWxpZGF0aW9uKCk7XHJcbiAgZWRpdEF2YXRhclBvcHVwLm9wZW4oKTtcclxufSk7XHJcblxyXG5jb25zdCBhcGkgPSBuZXcgQXBpKHtcclxuICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLm5vbW9yZXBhcnRpZXMuY28vdjEvZ3JvdXAtMTJcIixcclxuICBoZWFkZXJzOiB7XHJcbiAgICBhdXRob3JpemF0aW9uOiBcIjliNjIxZjBmLTVkZmUtNDNmMS05NWZkLWU5Y2MxODhiY2MzNVwiLFxyXG4gICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCJcclxuICB9XHJcbn0pO1xyXG5cclxuLyoqXHJcbiAqIGluaXRpYWFsIHVzZXIgaW5mbyBhbmQgZ2FsbGVyeSBDYXJkcyBmcm9tXHJcbiAqL1xyXG5hcGkuaW5pdCgpXHJcbi50aGVuKChbdXNlcixjYXJkc10pID0+IHtcclxuICB1c2VySW5mby5zZXRVc2VySW5mbyh1c2VyKTtcclxuICB1c2VySW5mby5zZXRVc2VyQXZhdGFyKHthdmF0YXI6IHVzZXIuYXZhdGFyLG5hbWU6IHVzZXIubmFtZX0pO1xyXG4gIGNhcmRMaXN0LnJlbmRlcmVySXRlbXMoY2FyZHMpO1xyXG59KVxyXG4uY2F0Y2ggKChlcnIpID0+IHtcclxuICBoYW5kbGVFcnJvcihlcnIpO1xyXG59KVxyXG5cclxuXHJcblxyXG5cclxuLyoqXHJcbiAqIGhhbmRsZSBlZGl0IHBvZmlsZSBhdmF0YXIgaW1hZ2VcclxuICovXHJcbmZ1bmN0aW9uIGhhbmRsZUVkaXRBdmF0YXIgKGlucHV0cykge1xyXG4gIGVkaXRBdmF0YXJQb3B1cC5yZW5kZXJMb2FkaW5nKHRydWUpO1xyXG4gIGFwaS5lZGl0UHJvZmlsZUF2YXRhcihpbnB1dHMuYXZhdGFySW1hZ2VMaW5rKVxyXG4gIC50aGVuICgodXNlckRhdGEpID0+IHtcclxuICAgIHVzZXJJbmZvLnNldFVzZXJBdmF0YXIodXNlckRhdGEgKVxyXG4gICAgZWRpdEF2YXRhclBvcHVwLmNsb3NlKCk7XHJcbiAgfSlcclxuICAuY2F0Y2ggKChlcnIpID0+IHtcclxuICAgIGhhbmRsZUVycm9yKGVycik7XHJcbiAgfSlcclxuICAuZmluYWxseSgoKSA9PntcclxuICAgIGVkaXRBdmF0YXJQb3B1cC5yZW5kZXJMb2FkaW5nKGZhbHNlKTtcclxuICB9KVxyXG59XHJcblxyXG4vKipcclxuICogZWRpdCB1c2VyIHByb2ZpbGUgZGF0YVxyXG4gKi9cclxuIGZ1bmN0aW9uIGhhbmRsZVByb2ZpbGVGb3JtU3VibWl0IChpbnB1dHMpIHtcclxuICBwcm9maWxlUG9wdXAucmVuZGVyTG9hZGluZyh0cnVlKTtcclxuXHJcbiAgYXBpLmVkaXRQcm9maWxlKHtuYW1lOiBpbnB1dHMucHJvZmlsZU5hbWUsIGFib3V0OiBpbnB1dHMucHJvZmlsZUFib3V0TWV9KVxyXG4gIC50aGVuICgodXNlckRhdGEpID0+IHtcclxuICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHVzZXJEYXRhKVxyXG4gICAgcHJvZmlsZVBvcHVwLmNsb3NlKCk7XHJcbiAgfSlcclxuICAuY2F0Y2ggKChlcnIpID0+IHtcclxuICAgIGNvbnNvbGUubG9nKGVycik7XHJcbiAgfSlcclxuICAuZmluYWxseSgoKSA9PntcclxuICAgIHByb2ZpbGVQb3B1cC5yZW5kZXJMb2FkaW5nKGZhbHNlKTtcclxuICB9KVxyXG59XHJcblxyXG4vKipcclxuICogYWRkIG5ldyBjYXJkIGl0ZW0gdG8gZ2FsbGVyeVxyXG4gKi9cclxuIG9wZU5ld0NhcmRQb3B1cEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgZm9ybVZhbGlkYXRvcnNbXCJwbGFjZWZvcm1cIl0ucmVzZXRWYWxpZGF0aW9uKCk7XHJcbiAgICBuZXdDYXJkUG9wdXAub3BlbigpO1xyXG4gIH0pO1xyXG5cclxuIGZ1bmN0aW9uIGNyZWF0ZUNhcmQgKGl0ZW0pIHtcclxuICBjb25zdCBjYXJkID0gbmV3IENhcmQoXHJcbiAgICBpdGVtLCBcclxuICAgIFwiI2dhbGxlcnktaXRlbS10ZW1wbGF0ZVwiLFxyXG4gICAgKCkgPT4geyBwb3B1cENhcmRJdGVtLm9wZW4oaXRlbS5saW5rLCBpdGVtLm5hbWUpOyB9LFxyXG4gICAgKCkgPT4geyBwb3B1cENvbmZpcm0ub3BlbihjYXJkKTsgfSxcclxuICAgIGhhbmRsZUxpa2UsXHJcbiAgICBhcGkpO1xyXG4gICAgcmV0dXJuIGNhcmQuZ2VuZXJhdGVDYXJkKCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uICBhZGRHYWxsZXJ5Q2FyZEl0ZW0gKGl0ZW0pIHtcclxuICBjYXJkTGlzdC5hZGRJdGVtKGNyZWF0ZUNhcmQoaXRlbSkpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVDcmVhdGVOZXdDYXJkIChpbnB1dHMpIHtcclxuICBuZXdDYXJkUG9wdXAucmVuZGVyTG9hZGluZyh0cnVlKTtcclxuXHJcbiAgYXBpLmNyZWF0ZU5ld0NhcmQoaW5wdXRzLnBsYWNlSW1hZ2VMaW5rLGlucHV0cy5wbGFjZU5hbWUpXHJcbiAgLnRoZW4oZGF0YSA9PiB7XHJcbiAgICBhZGRHYWxsZXJ5Q2FyZEl0ZW0gKGRhdGEpXHJcbiAgICBuZXdDYXJkUG9wdXAuY2xvc2UoKTtcclxuICB9KVxyXG4gIC5jYXRjaCAoKGVycikgPT4ge1xyXG4gICAgaGFuZGxlRXJyb3IoZXJyKTtcclxuICB9KVxyXG4gIC5maW5hbGx5KCgpID0+e1xyXG4gICAgbmV3Q2FyZFBvcHVwLnJlbmRlckxvYWRpbmcoZmFsc2UpO1xyXG4gIH0pXHJcbn1cclxuXHJcbi8qKlxyXG4gKiBkZWxldGUgY2FyZCBpdGVtIGZyb20gZ2FsbGVyeVxyXG4gKi9cclxuIGZ1bmN0aW9uIGhhbmRsZURlbGV0ZShjYXJkKSB7XHJcbiAgYXBpLmRlbGV0ZUNhcmQoY2FyZC5nZXRJZCgpKVxyXG4gIC50aGVuKCgpID0+e1xyXG4gICAgY2FyZC5kZWxldGVDYXJkKCk7XHJcbiAgICBwb3B1cENvbmZpcm0uY2xvc2UoKTtcclxuICB9KVxyXG4gIC5jYXRjaChlcnIgPT4ge1xyXG4gICAgY29uc29sZS5sb2coZXJyKTtcclxuICB9KVxyXG59XHJcblxyXG4vKipcclxuICogaGFuZGxlIGNhcmQgbGlrZXMgdXBkYXRlXHJcbiAqL1xyXG5mdW5jdGlvbiBoYW5kbGVMaWtlKGNhcmQpIHtcclxuICBjYXJkLnVwZGF0ZUxpa2VzKClcclxuICAgIC50aGVuKChkYXRhKSA9PiB7XHJcbiAgICAgIGNhcmQuc2V0TGlrZXMoZGF0YSk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgY29uc29sZS5sb2coZXJyKTtcclxuICAgIH0pICAgICBcclxuICAgXHJcbn1cclxuXHJcbi8qKlxyXG4gKiBhZGQgZXZlbnQgbGlzdGVuZXIgdG8gZWRpdCB1c2VyIHByb2ZpbGUgaW5mb1xyXG4gKi9cclxucHJvZmlsZUVkaXRCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBjb25zdCB7bmFtZSwgYWJvdXQgfSA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKCk7XHJcbiAgaW5wdXROYW1lLnZhbHVlICA9IG5hbWU7XHJcbiAgaW5wdXRBYm91dE1lLnZhbHVlICA9IGFib3V0O1xyXG4gIGZvcm1WYWxpZGF0b3JzW1wicHJvZmlsZWZvcm1cIl0ucmVzZXRWYWxpZGF0aW9uKCk7XHJcbiAgcHJvZmlsZVBvcHVwLm9wZW4oKTtcclxufSk7XHJcblxyXG4vKipcclxuICogc2V0IEVycm9yIGRlc2NyaXB0aW9uIG9uIHRvcCBvZiB0aGUgcGFnZVxyXG4gKi9cclxuIGZ1bmN0aW9uIGhhbmRsZUVycm9yKGVycikge1xyXG4gIGVycm9yRWwudGV4dENvbnRlbnQgPSBlcnI7XHJcbiAgZXJyb3JFbC5zdHlsZS5kaXNwbGF5ICA9IFwiYmxvY2tcIjtcclxufVxyXG5cclxuXHJcbmNvbnN0IGVuYWJsZVZhbGlkYXRpb24gPSAoY29uZmlnKSA9PiB7XHJcbiAgY29uc3QgZm9ybUxpc3QgPSBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoY29uZmlnLmZvcm1TZWxlY3RvcikpXHJcbiAgZm9ybUxpc3QuZm9yRWFjaCgoZm9ybUVsZW1lbnQpID0+IHtcclxuICAgIGNvbnN0IHZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKGNvbmZpZyxmb3JtRWxlbWVudClcclxuICAgIC8vZ2V0IHRoZSBuYW1lIG9mIHRoZSBmb3JtXHJcbiAgICBjb25zdCBmb3JtTmFtZSA9IGZvcm1FbGVtZW50LmdldEF0dHJpYnV0ZSgnbmFtZScpXHJcblxyXG4gICAvL3N0b3JlIGEgdmFsaWRhdG9yIGJ5IHRoZSBgbmFtZWAgb2YgdGhlIGZvcm1cclxuICAgIGZvcm1WYWxpZGF0b3JzW2Zvcm1OYW1lXSA9IHZhbGlkYXRvcjtcclxuICAgdmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuICB9KTtcclxufTtcclxuXHJcbmVuYWJsZVZhbGlkYXRpb24oY29uZmlnKTtcclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cHtcclxuICAgIGNvbnN0cnVjdG9yICggaW1nU2VsZWN0b3IsIHRpdGxlU2VsZWN0b3IgLHBvcHVwU2VsZWN0b3IgKSB7XHJcbiAgICAgICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XHJcbiAgICAgICAgdGhpcy5fcG9wdXBJbWcgPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKGltZ1NlbGVjdG9yKTtcclxuICAgICAgICB0aGlzLl9wb3B1cFRpdGxlID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3Rvcih0aXRsZVNlbGVjdG9yKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgb3BlbihzcmMsIHRpdGxlICkge1xyXG4gICAgICAgIHRoaXMuX3NyYyAgID0gc3JjO1xyXG4gICAgICAgIHRoaXMuX3RpdGxlID0gdGl0bGU7XHJcbiAgICAgICAgdGhpcy5fcG9wdXBJbWcuc3JjID0gIHRoaXMuX3NyYztcclxuICAgICAgICB0aGlzLl9wb3B1cEltZy5hbHQgPSAgdGhpcy5fdGl0bGU7XHJcbiAgICAgICAgdGhpcy5fcG9wdXBUaXRsZS50ZXh0Q29udGVudCA9IGBQaG90byBvZiAke3RoaXMuX3RpdGxlfWA7XHJcbiAgICAgICAgc3VwZXIub3BlbigpO1xyXG4gICAgfVxyXG59IiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhDb25maXJtYXRpb24gIGV4dGVuZHMgUG9wdXAge1xyXG4gICAgICAgIGNvbnN0cnVjdG9yICggcG9wdXBTZWxlY3RvciwgaGFuZGxlQ29uZmlybSApIHtcclxuICAgICAgICAgICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XHJcbiAgICAgICAgICAgIHRoaXMuX2hhbmRsZUNvbmZpcm0gICAgID0gICBoYW5kbGVDb25maXJtO1xyXG4gICAgICAgICAgICB0aGlzLl9mb3JtRWxlbWV0ICAgICAgICA9ICAgdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fZm9ybVwiKTtcclxuICAgICAgICB9XHJcblxyXG5cclxuICAgICAgICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgICAgICAgICAgLyoqXHJcbiAgICAgICAgICAgICAqIEl0IG1vZGlmaWVzIHRoZSBzZXRFdmVudExpc3RlbmVycygpIHBhcmVudCBtZXRob2QuIFxyXG4gICAgICAgICAgICAgKiAgaGFzIHRvIGFkZCB0aGUgc3VibWl0IGV2ZW50IGhhbmRsZXIgdG8gdGhlIGZvcm0gYW5kIHRoZSBjbGljayBcclxuICAgICAgICAgICAgICogZXZlbnQgbGlzdGVuZXIgdG8gdGhlIGNsb3NlIGljb24uXHJcbiAgICAgICAgICAgICAqL1xyXG4gICAgICAgICAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgICAgICAgICB0aGlzLl9mb3JtRWxlbWV0LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgIHRoaXMuX2hhbmRsZVN1Ym1pdCk7IFxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmVtb3ZlRXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICAgICAgICAgIHN1cGVyLnJlbW92ZUV2ZW50TGlzdGVuZXJzKClcclxuICAgICAgICAgICAgdGhpcy5fZm9ybUVsZW1ldC5yZW1vdmVFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIHRoaXMuX2hhbmRsZVN1Ym1pdCk7IFxyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICBfaGFuZGxlU3VibWl0ID0oZXZ0KSA9PntcclxuICAgICAgICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7IFxyXG4gICAgICAgICAgICB0aGlzLl9oYW5kbGVDb25maXJtKHRoaXMuX2NhcmRFbCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBvcGVuKGNhcmRFbCkge1xyXG4gICAgICAgICAgICBzdXBlci5vcGVuKCk7XHJcbiAgICAgICAgICAgIHRoaXMuX2NhcmRFbCA9IGNhcmRFbDtcclxuICAgICAgICB9XHJcbn0iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBTZWN0aW9uIHtcclxuICAgIGNvbnN0cnVjdG9yKCByZW5kZXJlciAsIGNvbnRhaW5lclNlbGVjdG9yICkge1xyXG4gICAgICAgIHRoaXMuX3JlbmRlcmVyICAgID0gcmVuZGVyZXI7XHJcbiAgICAgICAgdGhpcy5fY29udGFpbmVyICAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNvbnRhaW5lclNlbGVjdG9yKTtcclxuICAgIH1cclxuXHJcbiAgICBhZGRJdGVtKGVsZW1lbnQpIHtcclxuICAgICAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChlbGVtZW50KTtcclxuICAgICAgfVxyXG4gICAgXHJcbiAgICAgIHJlbmRlcmVySXRlbXMoY2FyZHMpIHtcclxuICAgICAgICBjYXJkcy5mb3JFYWNoKGl0ZW0gPT4ge1xyXG4gICAgICAgICAgdGhpcy5fcmVuZGVyZXIoaXRlbSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuXHJcbn0iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBVc2VySW5mbyB7XHJcbiAgICAvKipcclxuICAgICAqIFRoZSBVc2VySW5mbyBjbGFzcyBpcyByZXNwb25zaWJsZSBmb3IgcmVuZGVyaW5nIFxyXG4gICAgICogaW5mb3JtYXRpb24gYWJvdXQgdGhlIHVzZXIgb24gdGhlIHBhZ2UuIFRoaXMgY2xhc3Mgc2hvdWxkOlxyXG4gICAgICogLVRha2UgYW4gb2JqZWN0IHdpdGggdGhlIHNlbGVjdG9ycyBvZiB0d28gZWxlbWVudHMgaW50byB0aGUgY29uc3RydWN0b3I6IFxyXG4gICAgICogb25lIGNvbnRhaW5pbmcgdGhlIHVzZXIncyBuYW1lLCBhbmQgYW5vdGhlciBjb250YWluaW5nIHRoZSB1c2VyJ3Mgam9iLlxyXG4gICAgICovXHJcbiAgICBjb25zdHJ1Y3RvciAoIG5hbWVTZWxlY3Rvciwgam9iU2VsZWN0b3IsIGF2YXRhclNlbGVjdG9yID0gbnVsbCkge1xyXG4gICAgICAgIHRoaXMuX25hbWVFbGVtZW50ICAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKG5hbWVTZWxlY3Rvcik7XHJcbiAgICAgICAgdGhpcy5fam9iRWxlbWVudCAgICA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Ioam9iU2VsZWN0b3IpO1xyXG4gICAgICAgIHRoaXMuX2F2YXRhciAgICAgICAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGF2YXRhclNlbGVjdG9yKTtcclxuICAgIH1cclxuXHJcbiAgICBnZXRVc2VySW5mbygpIHtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiByZXR1cm5zIGFuIG9iamVjdCB3aXRoIGluZm9ybWF0aW9uIGFib3V0IHRoZSB1c2VyLiBcclxuICAgICAgICAgKiBUaGlzIG1ldGhvZCB3aWxsIGJlIGhhbmR5IGZvciBcclxuICAgICAgICAgKiBjYXNlcyB3aGVuIGl0J3MgbmVjZXNzYXJ5IHRvIGRpc3BsYXkgdGhlIHVzZXIgZGF0YSBpbiB0aGUgb3BlbiBmb3JtLlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIG5hbWU6IHRoaXMuX25hbWVFbGVtZW50LnRleHRDb250ZW50LFxyXG4gICAgICAgICAgICBhYm91dDogdGhpcy5fam9iRWxlbWVudC50ZXh0Q29udGVudFxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBzZXRVc2VySW5mbyh7IG5hbWUsIGFib3V0LCBfaWQgfSl7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogdGFrZXMgbmV3IHVzZXIgZGF0YSBhbmQgYWRkcyBpdCBvbiB0aGUgcGFnZS5cclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLl9uYW1lRWxlbWVudC50ZXh0Q29udGVudCAgID0gbmFtZTtcclxuICAgICAgICB0aGlzLl9uYW1lRWxlbWVudC5pZCAgICAgICAgICAgID0gX2lkO1xyXG4gICAgICAgIHRoaXMuX2pvYkVsZW1lbnQudGV4dENvbnRlbnQgICAgPSBhYm91dDtcclxuICAgIH1cclxuXHJcbiAgICBzZXRVc2VyQXZhdGFyKHthdmF0YXIsIG5hbWUgPSBudWxsfSkge1xyXG4gICAgICAgIHRoaXMuX2F2YXRhci5zcmMgPSBhdmF0YXI7XHJcbiAgICAgICAgaWYobmFtZSl7XHJcbiAgICAgICAgICAgIHRoaXMuX2F2YXRhci5hbHQgPSBuYW1lO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufSIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEFwaSB7XHJcbiAgICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7XHJcbiAgICAgIHRoaXMuX29wdGlvbnMgPSBvcHRpb25zO1xyXG5cclxuICAgIH1cclxuICBcclxuICAgIF9jYWxsKGFjdGlvbiwgbWV0aG9kLCBkYXRhKSB7XHJcbiAgICAgIHJldHVybiBmZXRjaCh0aGlzLl9vcHRpb25zLmJhc2VVcmwgKyBhY3Rpb24sIHtcclxuICAgICAgICBtZXRob2Q6IG1ldGhvZCxcclxuICAgICAgICBoZWFkZXJzOiAgdGhpcy5fb3B0aW9ucy5oZWFkZXJzLFxyXG4gICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KGRhdGEpLFxyXG4gICAgICB9KVxyXG4gICAgICAudGhlbihyZXMgPT4ge1xyXG4gICAgICAgIGlmKHJlcy5vaykge1xyXG4gICAgICAgICAgcmV0dXJuICByZXMuanNvbigpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QocmVzLnN0YXR1cyk7XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgZ2V0SW5pdGlhbENhcmRzID0gKCkgPT4ge1xyXG4gICAgICByZXR1cm4gdGhpcy5fY2FsbChcIi9jYXJkc1wiLCdHRVQnKTtcclxuICAgIH1cclxuICBcclxuICAgIGdldFVzZXJEYXRhID0gKCkgPT4ge1xyXG4gICAgICByZXR1cm4gdGhpcy5fY2FsbChcIi91c2Vycy9tZVwiLCdHRVQnKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgZWRpdFByb2ZpbGUoe25hbWUsIGFib3V0fSkge1xyXG4gICAgICByZXR1cm4gdGhpcy5fY2FsbChcIi91c2Vycy9tZVwiLCdQQVRDSCcse1xyXG4gICAgICAgIG5hbWU6IG5hbWUsXHJcbiAgICAgICAgYWJvdXQ6IGFib3V0XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGNyZWF0ZU5ld0NhcmQgKGxpbmssIG5hbWUpIHtcclxuICAgICAgcmV0dXJuIHRoaXMuX2NhbGwoXCIvY2FyZHNcIiwnUE9TVCcse1xyXG4gICAgICAgIG5hbWU6IG5hbWUsXHJcbiAgICAgICAgbGluazogbGlua1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgYWRkTGlrZSA9IChjYXJkSWQpID0+IHtcclxuICAgICAgcmV0dXJuIHRoaXMuX2NhbGwoYC9jYXJkcy9saWtlcy8ke2NhcmRJZH1gLCdQVVQnKTtcclxuICAgIH1cclxuXHJcbiAgICBkZWxldGVMaWtlID0gKGNhcmRJZCkgPT4ge1xyXG4gICAgICByZXR1cm4gdGhpcy5fY2FsbChgL2NhcmRzL2xpa2VzLyR7Y2FyZElkfWAsJ0RFTEVURScpO1xyXG4gICAgfVxyXG5cclxuICAgIGRlbGV0ZUNhcmQgPSAoY2FyZElkKSA9PiB7XHJcbiAgICAgIHJldHVybiB0aGlzLl9jYWxsKGAvY2FyZHMvJHtjYXJkSWR9YCwnREVMRVRFJyk7XHJcbiAgICB9XHJcblxyXG4gICAgZWRpdFByb2ZpbGVBdmF0YXIodXJsKXtcclxuICAgICAgcmV0dXJuIHRoaXMuX2NhbGwoXCIvdXNlcnMvbWUvYXZhdGFyIFwiLCdQQVRDSCcse1xyXG4gICAgICAgIGF2YXRhciA6IHVybFxyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBpbml0KCkge1xyXG4gICAgICByZXR1cm4gUHJvbWlzZS5hbGwoW3RoaXMuZ2V0VXNlckRhdGEoKSwgdGhpcy5nZXRJbml0aWFsQ2FyZHMoKV0pO1xyXG4gICAgfVxyXG5cclxuICB9XHJcbiAgXHJcbiJdLCJuYW1lcyI6WyJDYXJkIiwiY29uc3RydWN0b3IiLCJkYXRhIiwiY2FyZFNlbGVjdG9yIiwiaGFuZGxlQ2FyZENsaWNrIiwiaGFuZGxlVHJhc2hDbGljayIsImhhbmRsZUxpa2UiLCJhcGkiLCJ0aGlzIiwiX3RleHQiLCJuYW1lIiwiX2ltZyIsImxpbmsiLCJfaWQiLCJfbGlrZXMiLCJsaWtlcyIsIl9DYXJkb3duZXIiLCJvd25lciIsIl9jYXJkU2VsZWN0b3IiLCJfaGFuZGxlQ2FyZENsaWNrIiwiX2hhbmRsZVRyYXNoQ2xpY2siLCJfYWRkTGlrZSIsImFkZExpa2UiLCJfZGVsZXRlTGlrZSIsImRlbGV0ZUxpa2UiLCJfZGVsZXRlQ2FyZCIsImRlbGV0ZUNhcmQiLCJfaGFuZGxlTGlrZSIsIl9lbGVtZW50IiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiY29udGVudCIsImNsb25lTm9kZSIsIl9pdGVtSW1nRWwiLCJfaXRlbU5hbWVFbCIsInByb2ZpbGVFbCIsIl9pdGVtVHJhc2hCdG4iLCJfaXRlbUxpa2VCdG4iLCJfZ2FsbGVyeWxpa2VDb3VudCIsImdldElkIiwicmVtb3ZlIiwiZ2VuZXJhdGVDYXJkIiwic3JjIiwiYWx0IiwidGV4dENvbnRlbnQiLCJpZCIsIl9pbml0TGlrZSIsIl9kZWxldGVJY29uVmlzaWJpbGl0eSIsIl9zZXRFdmVudExpc3RlbmVycyIsInVzZXJJZCIsInN0eWxlIiwidmlzaWJpbGl0eSIsIl91c2VyRXhpc3RzIiwiY2xhc3NMaXN0IiwiYWRkIiwibGVuZ3RoIiwic29tZSIsInVzZXIiLCJhZGRFdmVudExpc3RlbmVyIiwidXBkYXRlTGlrZXMiLCJjb250YWlucyIsInNldExpa2VzIiwidG9nZ2xlIiwiUG9wdXAiLCJwb3B1cFNlbGVjdG9yIiwiZXZ0Iiwia2V5IiwiY2xvc2UiLCJ0YXJnZXQiLCJfcG9wdXAiLCJyZW1vdmVFdmVudExpc3RlbmVycyIsIm9wZW4iLCJzZXRFdmVudExpc3RlbmVycyIsIl9oYW5kbGVFc2NDbG9zZSIsIl9oYW5kbGVDbGlja0Nsb3NlUG9wdXAiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiUG9wdXBXaXRoRm9ybSIsImhhbmRsZUZvcm1TdWJtaXQiLCJzdXBlciIsInByZXZlbnREZWZhdWx0IiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJfZm9ybUVsZW1ldCIsIl9pbnB1dHNBcnIiLCJxdWVyeVNlbGVjdG9yQWxsIiwiX2J0bkVsIiwiX2lucHV0VmFsdWVzIiwiZm9yRWFjaCIsImlucHV0IiwidmFsdWUiLCJfaGFuZGxlU3VibWl0IiwicmVuZGVyTG9hZGluZyIsImlzTG9hZGluZyIsInJlc2V0IiwiRm9ybVZhbGlkYXRvciIsImNvbmZpZyIsImZvcm1FbCIsIl9mb3JtU2VsZWN0b3IiLCJmb3JtU2VsZWN0b3IiLCJfZm9ybUlucHV0c0ZpZWxkU2V0IiwiZm9ybUlucHV0c0ZpZWxkU2V0IiwiX2lucHV0U2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwiX3N1Ym1pdEJ0blNlbGVjdG9yIiwic3VibWl0QnRuU2VsZWN0b3IiLCJfaW5hY3RpdmVCdG5DbGFzcyIsImluYWN0aXZlQnRuQ2xhc3MiLCJfaW5wdXRFcnJDbGFzcyIsImlucHV0RXJyQ2xhc3MiLCJfaW5wdXRFcnJBY3RpdmVDbGFzcyIsImlucHV0RXJyQWN0aXZlQ2xhc3MiLCJfZm9ybUVsIiwiX2lucHV0THN0IiwiQXJyYXkiLCJmcm9tIiwiX3Nob3dJbnB1dEVyciIsImlucHV0RWwiLCJlcnJFbCIsInZhbGlkYXRpb25NZXNzYWdlIiwiX2hpZGVJbnB1dEVycm9yIiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsInZhbGlkaXR5IiwidmFsaWQiLCJfaGFzSW52YWxpZElucHV0IiwiaW5wdXRMc3QiLCJfdG9nZ2xlQnV0dG9uU3RhdGUiLCJkaXNhYmxlZCIsInJlc2V0VmFsaWRhdGlvbiIsImlucHV0RWxlbWVudCIsImVuYWJsZVZhbGlkYXRpb24iLCJwcm9maWxlRm9ybSIsImZvcm1zIiwicHJvZmlsZWZvcm0iLCJpbnB1dE5hbWUiLCJlbGVtZW50cyIsInByb2ZpbGVOYW1lIiwiaW5wdXRBYm91dE1lIiwicHJvZmlsZUFib3V0TWUiLCJwbGFjZWZvcm0iLCJwcm9maWxlRWRpdEJ0biIsIm9wZU5ld0NhcmRQb3B1cEJ0biIsImF2YXRhckVkaXRCdG4iLCJlcnJvckVsIiwicG9wdXBDYXJkSXRlbSIsImltZ1NlbGVjdG9yIiwidGl0bGVTZWxlY3RvciIsIl9wb3B1cEltZyIsIl9wb3B1cFRpdGxlIiwidGl0bGUiLCJfc3JjIiwiX3RpdGxlIiwicG9wdXBDb25maXJtIiwiaGFuZGxlQ29uZmlybSIsIl9oYW5kbGVDb25maXJtIiwiX2NhcmRFbCIsImNhcmRFbCIsImNhcmQiLCJ0aGVuIiwiY2F0Y2giLCJlcnIiLCJjb25zb2xlIiwibG9nIiwiZWRpdEF2YXRhclBvcHVwIiwiaW5wdXRzIiwiZWRpdFByb2ZpbGVBdmF0YXIiLCJhdmF0YXJJbWFnZUxpbmsiLCJ1c2VyRGF0YSIsInVzZXJJbmZvIiwic2V0VXNlckF2YXRhciIsImhhbmRsZUVycm9yIiwiZmluYWxseSIsIm5ld0NhcmRQb3B1cCIsImNyZWF0ZU5ld0NhcmQiLCJwbGFjZUltYWdlTGluayIsInBsYWNlTmFtZSIsImFkZEdhbGxlcnlDYXJkSXRlbSIsInByb2ZpbGVQb3B1cCIsImVkaXRQcm9maWxlIiwiYWJvdXQiLCJzZXRVc2VySW5mbyIsImNhcmRMaXN0IiwicmVuZGVyZXIiLCJjb250YWluZXJTZWxlY3RvciIsIl9yZW5kZXJlciIsIl9jb250YWluZXIiLCJhZGRJdGVtIiwiZWxlbWVudCIsInByZXBlbmQiLCJyZW5kZXJlckl0ZW1zIiwiY2FyZHMiLCJpdGVtIiwibmFtZVNlbGVjdG9yIiwiam9iU2VsZWN0b3IiLCJhdmF0YXJTZWxlY3RvciIsIl9uYW1lRWxlbWVudCIsIl9qb2JFbGVtZW50IiwiX2F2YXRhciIsImdldFVzZXJJbmZvIiwiYXZhdGFyIiwiZm9ybVZhbGlkYXRvcnMiLCJvcHRpb25zIiwiX2NhbGwiLCJjYXJkSWQiLCJfb3B0aW9ucyIsImFjdGlvbiIsIm1ldGhvZCIsImZldGNoIiwiYmFzZVVybCIsImhlYWRlcnMiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsInJlcyIsIm9rIiwianNvbiIsIlByb21pc2UiLCJyZWplY3QiLCJzdGF0dXMiLCJ1cmwiLCJpbml0IiwiYWxsIiwiZ2V0VXNlckRhdGEiLCJnZXRJbml0aWFsQ2FyZHMiLCJhdXRob3JpemF0aW9uIiwiY3JlYXRlQ2FyZCIsImRpc3BsYXkiLCJmb3JtRWxlbWVudCIsInZhbGlkYXRvciIsImZvcm1OYW1lIiwiZ2V0QXR0cmlidXRlIl0sInNvdXJjZVJvb3QiOiIifQ==