!function(){"use strict";class e{constructor(e,t,i,s,n,r){this._text=e.name,this._img=e.link,this._id=e._id,this._likes=e.likes,this._Cardowner=e.owner,this._cardSelector=t,this._handleCardClick=i,this._handleTrashClick=s,this._addLike=r.addLike,this._deleteLike=r.deleteLike,this._deleteCard=r.deleteCard,this._handleLike=n,this._element=document.querySelector(this._cardSelector).content.querySelector(".gallery__item").cloneNode(!0),this._itemImgEl=this._element.querySelector(".gallery__item-img"),this._itemNameEl=this._element.querySelector(".gallery__item-name"),this.profileEl=document.querySelector(".profile__name"),this._itemTrashBtn=this._element.querySelector(".gallery__item-trash-btn"),this._itemLikeBtn=this._element.querySelector(".gallery__like-btn"),this._gallerylikeCount=this._element.querySelector(".gllery__like-count")}getId(){return this._id}generateCard(){return this._itemImgEl.src=this._img,this._itemNameEl.alt=this._text,this._itemNameEl.textContent=this._text,this._element.id=this._id,this._initLike(this.profileEl.id),this._deleteIconVisibility(this.profileEl.id),this._setEventListeners(),this._element}_deleteIconVisibility(e){e!=this._Cardowner._id&&(this._itemTrashBtn.style.visibility="hidden")}_initLike(e){this._userExists(e)&&this._itemLikeBtn.classList.add("gallery__like-btn_active"),void 0!==this._likes?this._gallerylikeCount.textContent=this._likes.length:this._gallerylikeCount.textContent=0}_userExists(e){return void 0!==this._likes&&this._likes.some((function(t){return t._id===e}))}_setEventListeners(){this._itemLikeBtn.addEventListener("click",(()=>{this._handleLike(this)})),this._itemTrashBtn.addEventListener("click",(()=>{this._handleTrashClick(this)})),this._itemImgEl.addEventListener("click",this._handleCardClick)}updateLikes(){return this._itemLikeBtn.classList.contains("gallery__like-btn_active")?this._deleteLike(this._element.id):this._addLike(this._element.id)}setLikes(e){this._gallerylikeCount.textContent=e.likes.length,this._itemLikeBtn.classList.toggle("gallery__like-btn_active")}}function t(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class i{constructor(e){t(this,"_handleEscClose",(e=>{"Escape"===e.key&&this.close()})),t(this,"_handleClickClosePopup",(e=>{(e.target.classList.contains("popup_opened")||e.target.classList.contains("popup__close"))&&this.close()})),this._popup=document.querySelector(e)}close(){this._popup.classList.remove("popup_opened"),this.removeEventListeners()}open(){this._popup.classList.add("popup_opened"),this.setEventListeners()}setEventListeners(){document.addEventListener("keydown",this._handleEscClose),document.addEventListener("mousedown",this._handleClickClosePopup)}removeEventListeners(){document.removeEventListener("keydown",this._handleEscClose),document.removeEventListener("mousedown",this._handleClickClosePopup)}}class s extends i{constructor(e,t){var i,s;super(e),s=e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues())},(i="_handleSubmit")in this?Object.defineProperty(this,i,{value:s,enumerable:!0,configurable:!0,writable:!0}):this[i]=s,this._handleFormSubmit=t,this._formElemet=this._popup.querySelector(".popup__form"),this._inputsArr=this._formElemet.querySelectorAll(".popup__input"),this._inputValues={}}_getInputValues(){return this._inputsArr.forEach((e=>{e.value,this._inputValues[e.name]=e.value})),this._inputValues}setEventListeners(){super.setEventListeners(),this._formElemet.addEventListener("submit",this._handleSubmit)}removeEventListeners(){super.removeEventListeners(),this._formElemet.removeEventListener("submit",this._handleSubmit)}renderLoading(e,t){document.querySelector(t).textContent=e?"...Saving":"Save"}close(){super.close(),this._formElemet.reset()}}class n{constructor(e,t){this._formSelector=e.formSelector,this._formInputsFieldSet=e.formInputsFieldSet,this._inputSelector=e.inputSelector,this._submitBtnSelector=e.submitBtnSelector,this._inactiveBtnClass=e.inactiveBtnClass,this._inputErrClass=e.inputErrClass,this._inputErrActiveClass=e.inputErrActiveClass,this._formEl=t,this._inputLst=Array.from(this._formEl.querySelectorAll(this._inputSelector)),this._btnEl=this._formEl.querySelector(this._submitBtnSelector)}_showInputErr(e){const t=this._formEl.querySelector(".".concat(e.id,"-error"));e.classList.add(this._inputErrClass),t.textContent=e.validationMessage,t.classList.add(this._inputErrActiveClass)}_hideInputError(e){const t=this._formEl.querySelector(".".concat(e.id,"-error"));e.classList.remove(this._inputErrClass),t.classList.remove(this._inputErrActiveClass),t.textContent=""}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputErr(e)}_hasInvalidInput(e){return e.some((e=>!e.validity.valid))}toggleButtonState(){this._hasInvalidInput(this._inputLst)?(this._btnEl.classList.add(this._inactiveBtnClass),this._btnEl.disabled=!0):(this._btnEl.classList.remove(this._inactiveBtnClass),this._btnEl.disabled=!1)}_setEventListeners(){this.toggleButtonState(this._inputLst,this._btnEl),this._inputLst.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this.toggleButtonState(this._inputLst,this._btnEl)}))}))}enableValidation(){this._setEventListeners(),this._formEl.addEventListener("submit",(e=>e.preventDefault()))}}const r=document.forms.profileform,l=r.elements.profileName,o=r.elements.profileAboutMe;function a(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}document.forms.placeform;const _=document.querySelector("button.profile__edit-btn"),c=document.querySelector("button.profile__add-btn"),u=document.querySelector(".profile__edit-avatar"),h=document.querySelector(".profile__error"),p=new class extends i{constructor(e,t,i){super(i),this._popupImg=this._popup.querySelector(e),this._popupTitle=this._popup.querySelector(t)}open(e,t){this._src=e,this._title=t,this._popupImg.src=this._src,this._popupImg.alt=this._title,this._popupTitle.textContent="Photo of ".concat(this._title),super.open()}}(".popup__img",".popup__img-title",".popup_type_img"),d=new class extends i{constructor(e,t){var i,s;super(e),s=e=>{e.preventDefault(),this._handleConfirm(this._cardEl)},(i="_handleSubmit")in this?Object.defineProperty(this,i,{value:s,enumerable:!0,configurable:!0,writable:!0}):this[i]=s,this._handleConfirm=t,this._formElemet=this._popup.querySelector(".popup__form")}setEventListeners(){super.setEventListeners(),this._formElemet.addEventListener("submit",this._handleSubmit)}removeEventListeners(){super.removeEventListeners(),this._formElemet.removeEventListener("submit",this._handleSubmit)}open(e){super.open(),this._cardEl=e}}(".popup_type_delete",(function(e){g.deleteCard(e._id).then((()=>{e._element.remove(),e._element=null,d.close()})).catch((e=>{console.log(e)}))})),m=new s(".popup_type_avatar",(function(e){m.renderLoading(!0,".popup__submit-btn_place_avatar"),g.editProfileAvatar(e.avatarImageLink).then((()=>{b.setUserAvatar({avatar:e.avatarImageLink}),m.close(),L.avatarform.toggleButtonState()})).catch((e=>{C(e)})).finally((()=>{m.renderLoading(!1,".popup__submit-btn_place_avatar")}))})),v=new s(".popup_type_new-card",(function(e){v.renderLoading(!0,".popup__submit-btn_place_new-card"),g.createNewCard(e.placeImageLink,e.placeName).then((e=>{y(e),v.close(),L.placeform.toggleButtonState()})).catch((e=>{C(e)})).finally((()=>{v.renderLoading(!1,".popup__submit-btn_place_new-card")}))})),f=new s(".popup_type_profile",(function(e){f.renderLoading(!0,".popup__submit-btn_place_profile"),g.editProfile({name:e.profileName,about:e.profileAboutMe}).then((()=>{b.setUserInfo({name:e.profileName,about:e.profileAboutMe}),f.close()})).catch((e=>{console.log(e)})).finally((()=>{f.renderLoading(!1,".popup__submit-btn_place_profile")}))})),E=new class{constructor(e,t){this._renderer=e,this._container=document.querySelector(t)}addItem(e){this._container.prepend(e)}rendererItems(e){e.forEach((e=>{this._renderer(e)}))}}(y,".gallery__list"),b=new class{constructor(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this._nameElement=document.querySelector(e),this._jobElement=document.querySelector(t),this._avatar=document.querySelector(i)}getUserInfo(){return{name:this._nameElement.textContent,about:this._jobElement.textContent}}setUserInfo(e){let{name:t,about:i,_id:s}=e;this._nameElement.textContent=t,this._nameElement.id=s,this._jobElement.textContent=i}setUserAvatar(e){let{avatar:t,name:i=null}=e;this._avatar.src=t,i&&(this._avatar.alt=i)}}(".profile__name",".profile__about-me",".profile__avatar"),L={};u.addEventListener("click",(()=>{m.open()}));const g=new class{constructor(e){a(this,"getInitialCards",(()=>this._call("/cards","GET"))),a(this,"getUserData",(()=>this._call("/users/me","GET"))),a(this,"addLike",(e=>this._call("/cards/likes/".concat(e),"PUT"))),a(this,"deleteLike",(e=>this._call("/cards/likes/".concat(e),"DELETE"))),a(this,"deleteCard",(e=>this._call("/cards/".concat(e),"DELETE"))),this._options=e}_call(e,t,i){return fetch(this._options.baseUrl+e,{method:t,headers:this._options.headers,body:JSON.stringify(i)}).then((e=>e.ok?e.json():Promise.reject(e.status)))}editProfile(e){let{name:t,about:i}=e;return this._call("/users/me","PATCH",{name:t,about:i})}createNewCard(e,t){return this._call("/cards","POST",{name:t,link:e})}editProfileAvatar(e){return this._call("/users/me/avatar ","PATCH",{avatar:e})}init(){return Promise.all([this.getUserData(),this.getInitialCards()])}}({baseUrl:"https://around.nomoreparties.co/v1/group-12",headers:{authorization:"9b621f0f-5dfe-43f1-95fd-e9cc188bcc35","Content-Type":"application/json"}});function y(t){E.addItem(function(t){const i=new e(t,"#gallery-item-template",(()=>{p.open(t.link,t.name)}),(()=>{d.open(i)}),k,g);return i.generateCard()}(t))}function k(e){e.updateLikes().then((t=>{e.setLikes(t)})).catch((e=>{console.log(e)}))}function C(e){h.textContent=e,h.style.display="block"}var S;g.init().then((e=>{let[t,i]=e;b.setUserInfo(t),b.setUserAvatar({avatar:t.avatar,name:t.name}),E.rendererItems(i)})).catch((e=>{C(e)})),c.addEventListener("click",(()=>v.open())),_.addEventListener("click",(()=>{const{name:e,about:t}=b.getUserInfo();l.value=e,o.value=t,f.open()})),S={formSelector:".popup__form",formInputsFieldSet:".popup__form-set",inputSelector:".popup__input",submitBtnSelector:".popup__submit-btn",inactiveBtnClass:"button_inactive",inputErrClass:"popup__input-text_type_error",inputErrActiveClass:"popup__input-text-error_active"},Array.from(document.querySelectorAll(S.formSelector)).forEach((e=>{const t=new n(S,e),i=e.getAttribute("name");L[i]=t,t.enableValidation()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFtQmxGLGlCQUFpQixTQUFTLElBQU1rSCxFQUFhcEcsU0FrRWpFbUUsRUFBZWpGLGlCQUFpQixTQUFTLEtBQ3ZDLE1BQU0sS0FBQy9DLEVBQUQsTUFBT3dLLEdBQVViLEVBQVNnQyxjQUNoQ2pFLEVBQVU1QyxNQUFTOUUsRUFDbkI2SCxFQUFhL0MsTUFBUzBGLEVBQ3RCRixFQUFhekcsVUFZV3dCLEVEbExYLENBQ1hHLGFBQWMsZUFDZEUsbUJBQW9CLG1CQUNwQkUsY0FBZSxnQkFDZkUsa0JBQW1CLHFCQUNuQkUsaUJBQWtCLGtCQUNsQkUsY0FBZSwrQkFDZkUsb0JBQXFCLGtDQzRLTkcsTUFBTUMsS0FBS3JGLFNBQVN1RCxpQkFBaUJXLEVBQU9HLGVBQ3BEWixTQUFTMEksSUFDaEIsTUFBTUMsRUFBWSxJQUFJbkksRUFBY0MsRUFBT2lJLEdBRXJDRSxFQUFXRixFQUFZRyxhQUFhLFFBRzFDM0QsRUFBZTBELEdBQVlELEVBQzVCQSxFQUFVakcsc0IiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy91dGlscy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aENvbmZpcm1hdGlvbi5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL0FwaS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZGVmYXVsdCBjbGFzcyBDYXJkIHtcclxuICAgIGNvbnN0cnVjdG9yKCBkYXRhLCBjYXJkU2VsZWN0b3IsIGhhbmRsZUNhcmRDbGljaywgaGFuZGxlVHJhc2hDbGljaywgaGFuZGxlTGlrZSwgYXBpKSB7XHJcbiAgICAgIHRoaXMuX3RleHQgICAgICAgICAgICAgID0gZGF0YS5uYW1lO1xyXG4gICAgICB0aGlzLl9pbWcgICAgICAgICAgICAgID0gZGF0YS5saW5rO1xyXG4gICAgICB0aGlzLl9pZCAgICAgICAgICAgICAgICA9IGRhdGEuX2lkO1xyXG4gICAgICB0aGlzLl9saWtlcyAgICAgICAgICAgICA9IGRhdGEubGlrZXM7XHJcbiAgICAgIHRoaXMuX0NhcmRvd25lciAgICAgICAgID0gZGF0YS5vd25lcjtcclxuICAgICAgdGhpcy5fY2FyZFNlbGVjdG9yICAgICAgPSBjYXJkU2VsZWN0b3I7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUNhcmRDbGljayAgID0gaGFuZGxlQ2FyZENsaWNrO1xyXG4gICAgICB0aGlzLl9oYW5kbGVUcmFzaENsaWNrICA9IGhhbmRsZVRyYXNoQ2xpY2s7XHJcbiAgICAgIHRoaXMuX2FkZExpa2UgICAgICAgICAgID0gYXBpLmFkZExpa2U7XHJcbiAgICAgIHRoaXMuX2RlbGV0ZUxpa2UgICAgICAgID0gYXBpLmRlbGV0ZUxpa2U7XHJcbiAgICAgIHRoaXMuX2RlbGV0ZUNhcmQgICAgICAgID0gYXBpLmRlbGV0ZUNhcmQ7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUxpa2UgICAgICAgID0gaGFuZGxlTGlrZTtcclxuICAgICAgdGhpcy5fZWxlbWVudCAgICAgICAgICAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NhcmRTZWxlY3RvcikuY29udGVudC5xdWVyeVNlbGVjdG9yKFwiLmdhbGxlcnlfX2l0ZW1cIikuY2xvbmVOb2RlKHRydWUpO1xyXG4gICAgICB0aGlzLl9pdGVtSW1nRWwgICAgICAgICA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5nYWxsZXJ5X19pdGVtLWltZ1wiKTtcclxuICAgICAgdGhpcy5faXRlbU5hbWVFbCAgICAgICAgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZ2FsbGVyeV9faXRlbS1uYW1lXCIpO1xyXG4gICAgICB0aGlzLnByb2ZpbGVFbCAgICAgICAgICA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fbmFtZVwiKTtcclxuICAgICAgdGhpcy5faXRlbVRyYXNoQnRuICAgICAgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZ2FsbGVyeV9faXRlbS10cmFzaC1idG5cIik7XHJcbiAgICAgIHRoaXMuX2l0ZW1MaWtlQnRuICAgICAgID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmdhbGxlcnlfX2xpa2UtYnRuXCIpO1xyXG4gICAgICB0aGlzLl9nYWxsZXJ5bGlrZUNvdW50ICA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5nbGxlcnlfX2xpa2UtY291bnRcIik7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0SWQoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLl9pZDtcclxuICAgIH1cclxuXHJcbiAgICBnZW5lcmF0ZUNhcmQoKSB7XHJcbiAgICAgIHRoaXMuX2l0ZW1JbWdFbC5zcmMgPSB0aGlzLl9pbWc7XHJcbiAgICAgIHRoaXMuX2l0ZW1OYW1lRWwuYWx0ID0gdGhpcy5fdGV4dDtcclxuICAgICAgdGhpcy5faXRlbU5hbWVFbC50ZXh0Q29udGVudCA9IHRoaXMuX3RleHQ7XHJcbiBcclxuICAgICAgdGhpcy5fZWxlbWVudC5pZCA9IHRoaXMuX2lkO1xyXG4gICAgICB0aGlzLl9pbml0TGlrZSh0aGlzLnByb2ZpbGVFbC5pZCk7XHJcbiAgICAgIHRoaXMuIF9kZWxldGVJY29uVmlzaWJpbGl0eSh0aGlzLnByb2ZpbGVFbC5pZCk7XHJcbiAgICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICAgIHJldHVybiB0aGlzLl9lbGVtZW50O1xyXG4gICAgfVxyXG4gIFxyXG4gICAgX2RlbGV0ZUljb25WaXNpYmlsaXR5KHVzZXJJZCl7XHJcbiAgICAgIGlmKHVzZXJJZCAhPSAgdGhpcy5fQ2FyZG93bmVyLl9pZCkge1xyXG4gICAgICAgIHRoaXMuX2l0ZW1UcmFzaEJ0bi5zdHlsZS52aXNpYmlsaXR5ID0gXCJoaWRkZW5cIjtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIF9pbml0TGlrZSh1c2VySWQpe1xyXG4gICAgICBpZih0aGlzLl91c2VyRXhpc3RzKHVzZXJJZCkpIHtcclxuICAgICAgICB0aGlzLl9pdGVtTGlrZUJ0bi5jbGFzc0xpc3QuYWRkKCdnYWxsZXJ5X19saWtlLWJ0bl9hY3RpdmUnKTsgXHJcbiAgICAgIH1cclxuICAgICAgaWYodHlwZW9mIHRoaXMuX2xpa2VzICE9PSBcInVuZGVmaW5lZFwiKXtcclxuICAgICAgICB0aGlzLl9nYWxsZXJ5bGlrZUNvdW50LnRleHRDb250ZW50ID0gdGhpcy5fbGlrZXMubGVuZ3RoO1xyXG4gICAgICB9XHJcbiAgICAgIGVsc2Uge1xyXG4gICAgICAgIHRoaXMuX2dhbGxlcnlsaWtlQ291bnQudGV4dENvbnRlbnQgID0gMDtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIF91c2VyRXhpc3RzKGlkKSB7XHJcbiAgICAgIGlmKHR5cGVvZiB0aGlzLl9saWtlcyAhPT0gXCJ1bmRlZmluZWRcIil7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2xpa2VzLnNvbWUoZnVuY3Rpb24odXNlcikge1xyXG4gICAgICAgICAgcmV0dXJuIHVzZXIuX2lkID09PSBpZDtcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgICB0aGlzLl9pdGVtTGlrZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwoKSA9PiAge3RoaXMuX2hhbmRsZUxpa2UodGhpcyl9KTtcclxuICAgICAgdGhpcy5faXRlbVRyYXNoQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCgpID0+e3RoaXMuX2hhbmRsZVRyYXNoQ2xpY2sodGhpcyl9KTtcclxuICAgICAgdGhpcy5faXRlbUltZ0VsLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLl9oYW5kbGVDYXJkQ2xpY2spO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBEZWNpZGUgd2hldGhlciB0byBkZWxldGUgb3IgYWRkIGEgTGlrZSBkZXBlbmRpbmcgb24gYW4gZXhpc3Rpbmcgc2l0dWF0aW9uXHJcbiAgICAgKi9cclxuICAgIHVwZGF0ZUxpa2VzKCkge1xyXG4gICAgICBpZih0aGlzLl9pdGVtTGlrZUJ0bi5jbGFzc0xpc3QuY29udGFpbnMoJ2dhbGxlcnlfX2xpa2UtYnRuX2FjdGl2ZScpKXtcclxuICAgICAgICByZXR1cm4gdGhpcy5fZGVsZXRlTGlrZSh0aGlzLl9lbGVtZW50LmlkKTtcclxuICAgICAgfVxyXG4gICAgICBlbHNlIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fYWRkTGlrZSh0aGlzLl9lbGVtZW50LmlkKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogRGVhbGluZyB3aXRoIHRoZSBzdWNjZXNzIG9mIHVwZGF0aW5nIExpa2Ugb24gdGhlIHNlcnZlciAoLnRoZW4pXHJcbiAgICAgKi9cclxuICAgIHNldExpa2VzKGRhdGEpIHtcclxuICAgICAgdGhpcy5fZ2FsbGVyeWxpa2VDb3VudC50ZXh0Q29udGVudCA9IGRhdGEubGlrZXMubGVuZ3RoO1xyXG4gICAgICB0aGlzLl9pdGVtTGlrZUJ0bi5jbGFzc0xpc3QudG9nZ2xlKCdnYWxsZXJ5X19saWtlLWJ0bl9hY3RpdmUnKTtcclxuICAgIH1cclxuICB9IiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xyXG4gICAgY29uc3RydWN0b3IgKCBwb3B1cFNlbGVjdG9yICkge1xyXG4gICAgICAgIHRoaXMuX3BvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwb3B1cFNlbGVjdG9yKTtcclxuICAgIH1cclxuICAgIGNsb3NlKCkge1xyXG4gICAgICAgIHRoaXMuX3BvcHVwLmNsYXNzTGlzdC5yZW1vdmUoXCJwb3B1cF9vcGVuZWRcIik7XHJcbiAgICAgICAgLyoqIHBvcHVwcyBjbG9zZSBjbGljayByZW1vdmUgZXZlbnRzICovXHJcbiAgICAgICAgdGhpcy5yZW1vdmVFdmVudExpc3RlbmVycygpO1xyXG4gICAgfVxyXG5cclxuICAgIG9wZW4oKSB7XHJcbiAgICAgICAgdGhpcy5fcG9wdXAuY2xhc3NMaXN0LmFkZChcInBvcHVwX29wZW5lZFwiKTtcclxuICAgICAgICAvKiogcG9wdXBzIG9wZW4gZXZlbnRzICovXHJcbiAgICAgICAgdGhpcy5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgfVxyXG5cclxuICAgIF9oYW5kbGVFc2NDbG9zZSA9IChldnQpID0+e1xyXG4gICAgICAgIGlmIChldnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNsb3NlKCk7ICBcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xyXG4gICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgdGhpcy5faGFuZGxlQ2xpY2tDbG9zZVBvcHVwKTtcclxuICAgIH1cclxuXHJcbiAgICByZW1vdmVFdmVudExpc3RlbmVycygpIHtcclxuICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCAgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xyXG4gICAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgIHRoaXMuX2hhbmRsZUNsaWNrQ2xvc2VQb3B1cCk7XHJcbiAgICB9XHJcblxyXG4gICAgX2hhbmRsZUNsaWNrQ2xvc2VQb3B1cCA9IChldnQpID0+IHtcclxuICAgICAgICAgICAgaWYgKGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwicG9wdXBfb3BlbmVkXCIpIHx8XHJcbiAgICAgICAgICAgIGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwicG9wdXBfX2Nsb3NlXCIpICkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuXHJcbn0iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoRm9ybSAgZXh0ZW5kcyBQb3B1cCB7XHJcbiAgICAgICAgY29uc3RydWN0b3IgKCBwb3B1cFNlbGVjdG9yLCBoYW5kbGVGb3JtU3VibWl0ICkge1xyXG4gICAgICAgICAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcclxuICAgICAgICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCAgPSBoYW5kbGVGb3JtU3VibWl0O1xyXG4gICAgICAgICAgICB0aGlzLl9mb3JtRWxlbWV0ICAgICAgICA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2Zvcm1cIik7XHJcbiAgICAgICAgICAgIHRoaXMuX2lucHV0c0FyciAgICAgICAgID0gdGhpcy5fZm9ybUVsZW1ldC5xdWVyeVNlbGVjdG9yQWxsKFwiLnBvcHVwX19pbnB1dFwiKTtcclxuICAgICAgICAgICAgdGhpcy5faW5wdXRWYWx1ZXMgICAgICAgPSB7fTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIF9nZXRJbnB1dFZhbHVlcygpIHtcclxuICAgICAgICAgICAgdGhpcy5faW5wdXRzQXJyLmZvckVhY2goaW5wdXQgPT4ge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaW5wdXROYW1lID0gaW5wdXQudmFsdWVcclxuICAgICAgICAgICAgICAgIHRoaXMuX2lucHV0VmFsdWVzW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWU7XHJcbiAgICAgICAgICAgICAgICAvL3RoaXMuX2lucHV0VmFsdWVzLnZhbHVlID0gaW5wdXQudmFsdWU7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9pbnB1dFZhbHVlcyA7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgICAgICAgICAgLyoqXHJcbiAgICAgICAgICAgICAqIEl0IG1vZGlmaWVzIHRoZSBzZXRFdmVudExpc3RlbmVycygpIHBhcmVudCBtZXRob2QuIFxyXG4gICAgICAgICAgICAgKiBUaGUgc2V0RXZlbnRMaXN0ZW5lcnMoKSBtZXRob2Qgb2YgdGhlIFBvcHVwV2l0aEZvcm0gY2xhc3NcclxuICAgICAgICAgICAgICogIGhhcyB0byBhZGQgdGhlIHN1Ym1pdCBldmVudCBoYW5kbGVyIHRvIHRoZSBmb3JtIGFuZCB0aGUgY2xpY2sgXHJcbiAgICAgICAgICAgICAqIGV2ZW50IGxpc3RlbmVyIHRvIHRoZSBjbG9zZSBpY29uLlxyXG4gICAgICAgICAgICAgKi9cclxuICAgICAgICAgICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgICAgICAgICAgdGhpcy5fZm9ybUVsZW1ldC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIHRoaXMuX2hhbmRsZVN1Ym1pdCk7IFxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmVtb3ZlRXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICAgICAgICAgIHN1cGVyLnJlbW92ZUV2ZW50TGlzdGVuZXJzKClcclxuICAgICAgICAgICAgdGhpcy5fZm9ybUVsZW1ldC5yZW1vdmVFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIHRoaXMuX2hhbmRsZVN1Ym1pdCk7IFxyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICBfaGFuZGxlU3VibWl0ID0oZXZ0KSA9PntcclxuICAgICAgICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7IFxyXG4gICAgICAgICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KHRoaXMuX2dldElucHV0VmFsdWVzKCkpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogY2hhbmdlIGJ1dHRvbiB0ZXh0IHRvIC4uc2F2aW5nIHVudGlsIHByb2Nlc3MgZW5kc1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHJlbmRlckxvYWRpbmcoaXNMb2FkaW5nLCBidG5TZWxlY3Rvcikge1xyXG4gICAgICAgICAgICBjb25zdCBidG5FbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYnRuU2VsZWN0b3IpO1xyXG4gICAgICAgICAgICBpZihpc0xvYWRpbmcpIHtcclxuICAgICAgICAgICAgYnRuRWwudGV4dENvbnRlbnQgPSBcIi4uLlNhdmluZ1wiOyBcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgYnRuRWwudGV4dENvbnRlbnQgPSBcIlNhdmVcIjsgXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsb3NlKCkge1xyXG4gICAgICAgICAgICAvKipcclxuICAgICAgICAgICAgICogSXQgbW9kaWZpZXMgdGhlIGNsb3NlKCkgcGFyZW50IG1ldGhvZCBcclxuICAgICAgICAgICAgICogaW4gb3JkZXIgdG8gcmVzZXQgdGhlIGZvcm0gb25jZSB0aGUgcG9wdXAgaXMgY2xvc2VkLlxyXG4gICAgICAgICAgICAgKi9cclxuICAgICAgICAgICAgc3VwZXIuY2xvc2UoKTtcclxuICAgICAgICAgICAgdGhpcy5fZm9ybUVsZW1ldC5yZXNldCgpO1xyXG4gICAgICAgIH1cclxuXHJcbn0iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBGb3JtVmFsaWRhdG9yIHtcclxuICAgIGNvbnN0cnVjdG9yKCBjb25maWcsIGZvcm1FbCApe1xyXG4gICAgICB0aGlzLl9mb3JtU2VsZWN0b3IgICAgICAgICA9IGNvbmZpZy5mb3JtU2VsZWN0b3I7XHJcbiAgICAgIHRoaXMuX2Zvcm1JbnB1dHNGaWVsZFNldCAgID0gY29uZmlnLmZvcm1JbnB1dHNGaWVsZFNldDtcclxuICAgICAgdGhpcy5faW5wdXRTZWxlY3RvciAgICAgICAgPSBjb25maWcuaW5wdXRTZWxlY3RvcjtcclxuICAgICAgdGhpcy5fc3VibWl0QnRuU2VsZWN0b3IgICAgPSBjb25maWcuc3VibWl0QnRuU2VsZWN0b3I7XHJcbiAgICAgIHRoaXMuX2luYWN0aXZlQnRuQ2xhc3MgICAgID0gY29uZmlnLmluYWN0aXZlQnRuQ2xhc3M7XHJcbiAgICAgIHRoaXMuX2lucHV0RXJyQ2xhc3MgICAgICAgID0gY29uZmlnLmlucHV0RXJyQ2xhc3M7XHJcbiAgICAgIHRoaXMuX2lucHV0RXJyQWN0aXZlQ2xhc3MgID0gY29uZmlnLmlucHV0RXJyQWN0aXZlQ2xhc3M7XHJcbiAgICAgIHRoaXMuX2Zvcm1FbCAgICAgICAgICAgICAgID0gZm9ybUVsO1xyXG4gICAgICB0aGlzLl9pbnB1dExzdCAgICAgICAgICAgICA9IEFycmF5LmZyb20odGhpcy5fZm9ybUVsLnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5faW5wdXRTZWxlY3RvcikpO1xyXG4gICAgICB0aGlzLl9idG5FbCAgICAgICAgICAgICAgICA9IHRoaXMuX2Zvcm1FbC5xdWVyeVNlbGVjdG9yKHRoaXMuX3N1Ym1pdEJ0blNlbGVjdG9yKTtcclxuICAgIH1cclxuXHJcbiAgICBfc2hvd0lucHV0RXJyIChpbnB1dEVsKSB7XHJcbiAgICAgIGNvbnN0IGVyckVsID0gdGhpcy5fZm9ybUVsLnF1ZXJ5U2VsZWN0b3IoYC4ke2lucHV0RWwuaWR9LWVycm9yYCk7XHJcbiAgICAgIFxyXG4gICAgICBpbnB1dEVsLmNsYXNzTGlzdC5hZGQodGhpcy5faW5wdXRFcnJDbGFzcyk7XHJcbiAgICAgIGVyckVsLnRleHRDb250ZW50ID0gaW5wdXRFbC52YWxpZGF0aW9uTWVzc2FnZTtcclxuICAgICAgZXJyRWwuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbnB1dEVyckFjdGl2ZUNsYXNzKTtcclxuICAgIH1cclxuXHJcbiAgICBfaGlkZUlucHV0RXJyb3IgKGlucHV0RWwpIHtcclxuICAgICAgY29uc3QgZXJyRWwgPSB0aGlzLl9mb3JtRWwucXVlcnlTZWxlY3RvcihgLiR7aW5wdXRFbC5pZH0tZXJyb3JgKTtcclxuXHJcbiAgICAgIGlucHV0RWwuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbnB1dEVyckNsYXNzKTtcclxuICAgICAgZXJyRWwuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbnB1dEVyckFjdGl2ZUNsYXNzKTtcclxuICAgICAgZXJyRWwudGV4dENvbnRlbnQgPSBcIlwiO1xyXG4gICAgfVxyXG5cclxuICAgIF9jaGVja0lucHV0VmFsaWRpdHkgKGlucHV0RWwpIHtcclxuICAgICAgaWYgKCFpbnB1dEVsLnZhbGlkaXR5LnZhbGlkKSB7XHJcbiAgICAgICAgdGhpcy5fc2hvd0lucHV0RXJyKGlucHV0RWwpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWwpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgX2hhc0ludmFsaWRJbnB1dCAoaW5wdXRMc3QpIHtcclxuICAgICAgcmV0dXJuIGlucHV0THN0LnNvbWUoKGlucHV0RWwpID0+ICFpbnB1dEVsLnZhbGlkaXR5LnZhbGlkKTtcclxuICAgIH1cclxuXHJcbiAgICB0b2dnbGVCdXR0b25TdGF0ZSAoKSB7XHJcbiAgICAgIGlmICh0aGlzLl9oYXNJbnZhbGlkSW5wdXQodGhpcy5faW5wdXRMc3QpKSB7XHJcbiAgICAgICAgdGhpcy5fYnRuRWwuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbmFjdGl2ZUJ0bkNsYXNzKTtcclxuICAgICAgICB0aGlzLl9idG5FbC5kaXNhYmxlZCA9IHRydWU7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgdGhpcy5fYnRuRWwuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ0bkNsYXNzKTtcclxuICAgICAgICB0aGlzLl9idG5FbC5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgX3NldEV2ZW50TGlzdGVuZXJzICgpIHtcclxuICAgICAgdGhpcy50b2dnbGVCdXR0b25TdGF0ZSh0aGlzLl9pbnB1dExzdCwgdGhpcy5fYnRuRWwpO1xyXG4gICAgICB0aGlzLl9pbnB1dExzdC5mb3JFYWNoKChpbnB1dEVsKSA9PiB7XHJcbiAgICAgICAgaW5wdXRFbC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4geyAgIFxyXG4gICAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWwpO1xyXG4gICAgICAgICAgdGhpcy50b2dnbGVCdXR0b25TdGF0ZSh0aGlzLl9pbnB1dExzdCwgdGhpcy5fYnRuRWwpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBlbmFibGVWYWxpZGF0aW9uICgpIHtcclxuICAgICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgICAgdGhpcy5fZm9ybUVsLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4gZXZ0LnByZXZlbnREZWZhdWx0KCkpO1xyXG4gICAgfVxyXG5cclxuICB9IiwiY29uc3QgY29uZmlnID0ge1xyXG4gICAgZm9ybVNlbGVjdG9yOiBcIi5wb3B1cF9fZm9ybVwiLFxyXG4gICAgZm9ybUlucHV0c0ZpZWxkU2V0OiBcIi5wb3B1cF9fZm9ybS1zZXRcIixcclxuICAgIGlucHV0U2VsZWN0b3I6IFwiLnBvcHVwX19pbnB1dFwiLFxyXG4gICAgc3VibWl0QnRuU2VsZWN0b3I6IFwiLnBvcHVwX19zdWJtaXQtYnRuXCIsXHJcbiAgICBpbmFjdGl2ZUJ0bkNsYXNzOiBcImJ1dHRvbl9pbmFjdGl2ZVwiLFxyXG4gICAgaW5wdXRFcnJDbGFzczogXCJwb3B1cF9faW5wdXQtdGV4dF90eXBlX2Vycm9yXCIsXHJcbiAgICBpbnB1dEVyckFjdGl2ZUNsYXNzOiBcInBvcHVwX19pbnB1dC10ZXh0LWVycm9yX2FjdGl2ZVwiXHJcbiAgfVxyXG5cclxuXHJcbi8qKiBwcm9maWxlIHBvcHVwIGVsZW1lbnRzICovXHJcbmNvbnN0IHByb2ZpbGVGb3JtICAgICAgICAgICAgICAgICAgPSBkb2N1bWVudC5mb3Jtcy5wcm9maWxlZm9ybTtcclxuY29uc3QgaW5wdXROYW1lICAgICAgICAgICAgID0gcHJvZmlsZUZvcm0uZWxlbWVudHMucHJvZmlsZU5hbWU7XHJcbmNvbnN0IGlucHV0QWJvdXRNZSAgICAgICAgICA9IHByb2ZpbGVGb3JtLmVsZW1lbnRzLnByb2ZpbGVBYm91dE1lO1xyXG5jb25zdCBwbGFjZUZvcm0gICAgICAgICAgICAgPSBkb2N1bWVudC5mb3Jtcy5wbGFjZWZvcm07XHJcblxyXG5jb25zdCBnYWxsZXJ5TGlzdFNlbGVjdG9yICA9IFwiLmdhbGxlcnlfX2xpc3RcIjtcclxuXHJcbmV4cG9ydCB7Y29uZmlnLCBpbnB1dE5hbWUsIGlucHV0QWJvdXRNZSwgcGxhY2VGb3JtLCBnYWxsZXJ5TGlzdFNlbGVjdG9yfVxyXG5cclxuIiwiaW1wb3J0IFwiLi9pbmRleC5jc3NcIjtcclxuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvU2VjdGlvbi5qc1wiO1xyXG5pbXBvcnQgQ2FyZCBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aEltYWdlIGZyb20gIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoQ29uZmlybWF0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aENvbmZpcm1hdGlvbi5qc1wiO1xyXG5pbXBvcnQgVXNlckluZm8gZnJvbSBcIi4uL2NvbXBvbmVudHMvVXNlckluZm8uanNcIjtcclxuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xyXG5pbXBvcnQge2NvbmZpZywgaW5wdXROYW1lLCBpbnB1dEFib3V0TWUsIGdhbGxlcnlMaXN0U2VsZWN0b3J9ICBmcm9tIFwiLi4vdXRpbHMvY29uc3RhbnRzLmpzXCI7XHJcbmltcG9ydCBBcGkgZnJvbSBcIi4uL2NvbXBvbmVudHMvQXBpLmpzXCI7XHJcblxyXG4vKiogbWFpbiBidXR0b25zICovXHJcbmNvbnN0IHByb2ZpbGVFZGl0QnRuICAgICAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiYnV0dG9uLnByb2ZpbGVfX2VkaXQtYnRuXCIpO1xyXG5jb25zdCBvcGVOZXdDYXJkUG9wdXBCdG4gID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcImJ1dHRvbi5wcm9maWxlX19hZGQtYnRuXCIpO1xyXG5jb25zdCBhdmF0YXJFZGl0QnRuICAgICAgID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19lZGl0LWF2YXRhclwiKVxyXG5cclxuY29uc3QgZXJyb3JFbCAgICAgICAgICAgICA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fZXJyb3JcIik7XHJcblxyXG5jb25zdCBwb3B1cENhcmRJdGVtICAgICAgID0gbmV3IFBvcHVwV2l0aEltYWdlKFwiLnBvcHVwX19pbWdcIiwgXCIucG9wdXBfX2ltZy10aXRsZVwiLCBcIi5wb3B1cF90eXBlX2ltZ1wiKTtcclxuY29uc3QgcG9wdXBDb25maXJtICAgICAgICA9IG5ldyBQb3B1cFdpdGhDb25maXJtYXRpb24oXCIucG9wdXBfdHlwZV9kZWxldGVcIiwgaGFuZGxlRGVsZXRlKTtcclxuY29uc3QgZWRpdEF2YXRhclBvcHVwICAgICA9IG5ldyBQb3B1cFdpdGhGb3JtKFwiLnBvcHVwX3R5cGVfYXZhdGFyXCIsIGhhbmRsZUVkaXRBdmF0YXIpO1xyXG5jb25zdCBuZXdDYXJkUG9wdXAgICAgICAgID0gbmV3IFBvcHVwV2l0aEZvcm0gKFwiLnBvcHVwX3R5cGVfbmV3LWNhcmRcIiwgaGFuZGxlQ3JlYXRlTmV3Q2FyZCk7XHJcbmNvbnN0IHByb2ZpbGVQb3B1cCAgICAgICAgPSBuZXcgUG9wdXBXaXRoRm9ybSAoXCIucG9wdXBfdHlwZV9wcm9maWxlXCIsICBoYW5kbGVQcm9maWxlRm9ybVN1Ym1pdCk7XHJcbmNvbnN0IGNhcmRMaXN0ICAgICAgICAgICAgPSBuZXcgU2VjdGlvbihhZGRHYWxsZXJ5Q2FyZEl0ZW0sIGdhbGxlcnlMaXN0U2VsZWN0b3IpO1xyXG5jb25zdCB1c2VySW5mbyAgICAgICAgICAgID0gbmV3IFVzZXJJbmZvKFwiLnByb2ZpbGVfX25hbWVcIiwgXCIucHJvZmlsZV9fYWJvdXQtbWVcIiwgXCIucHJvZmlsZV9fYXZhdGFyXCIpO1xyXG5cclxuY29uc3QgZm9ybVZhbGlkYXRvcnMgPSB7fTtcclxuXHJcbmF2YXRhckVkaXRCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICAoKSA9PiB7ZWRpdEF2YXRhclBvcHVwLm9wZW4oKX0pO1xyXG5cclxuY29uc3QgYXBpID0gbmV3IEFwaSh7XHJcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC5ub21vcmVwYXJ0aWVzLmNvL3YxL2dyb3VwLTEyXCIsXHJcbiAgaGVhZGVyczoge1xyXG4gICAgYXV0aG9yaXphdGlvbjogXCI5YjYyMWYwZi01ZGZlLTQzZjEtOTVmZC1lOWNjMTg4YmNjMzVcIixcclxuICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiXHJcbiAgfVxyXG59KTtcclxuXHJcbi8qKlxyXG4gKiBpbml0aWFhbCB1c2VyIGluZm8gYW5kIGdhbGxlcnkgQ2FyZHMgZnJvbVxyXG4gKi9cclxuYXBpLmluaXQoKVxyXG4udGhlbigoW3VzZXIsY2FyZHNdKSA9PiB7XHJcbiAgdXNlckluZm8uc2V0VXNlckluZm8odXNlcik7XHJcbiAgdXNlckluZm8uc2V0VXNlckF2YXRhcih7YXZhdGFyOiB1c2VyLmF2YXRhcixuYW1lOiB1c2VyLm5hbWV9KTtcclxuICBjYXJkTGlzdC5yZW5kZXJlckl0ZW1zKGNhcmRzKTtcclxufSlcclxuLmNhdGNoICgoZXJyKSA9PiB7XHJcbiAgaGFuZGxlRXJyb3IoZXJyKTtcclxufSlcclxuXHJcblxyXG5cclxuXHJcbi8qKlxyXG4gKiBoYW5kbGUgZWRpdCBwb2ZpbGUgYXZhdGFyIGltYWdlXHJcbiAqL1xyXG5mdW5jdGlvbiBoYW5kbGVFZGl0QXZhdGFyIChpbnB1dHMpIHtcclxuICBlZGl0QXZhdGFyUG9wdXAucmVuZGVyTG9hZGluZyh0cnVlLCBcIi5wb3B1cF9fc3VibWl0LWJ0bl9wbGFjZV9hdmF0YXJcIik7XHJcbiAgYXBpLmVkaXRQcm9maWxlQXZhdGFyKGlucHV0cy5hdmF0YXJJbWFnZUxpbmspXHJcbiAgLnRoZW4gKCgpID0+IHtcclxuICAgIHVzZXJJbmZvLnNldFVzZXJBdmF0YXIoe2F2YXRhcjogaW5wdXRzLmF2YXRhckltYWdlTGlua30pXHJcbiAgICBlZGl0QXZhdGFyUG9wdXAuY2xvc2UoKTtcclxuICAgIGZvcm1WYWxpZGF0b3JzW1wiYXZhdGFyZm9ybVwiXS50b2dnbGVCdXR0b25TdGF0ZSgpO1xyXG4gIH0pXHJcbiAgLmNhdGNoICgoZXJyKSA9PiB7XHJcbiAgICBoYW5kbGVFcnJvcihlcnIpO1xyXG4gIH0pXHJcbiAgLmZpbmFsbHkoKCkgPT57XHJcbiAgICBlZGl0QXZhdGFyUG9wdXAucmVuZGVyTG9hZGluZyhmYWxzZSwgXCIucG9wdXBfX3N1Ym1pdC1idG5fcGxhY2VfYXZhdGFyXCIpO1xyXG4gIH0pXHJcbn1cclxuXHJcbi8qKlxyXG4gKiBlZGl0IHVzZXIgcHJvZmlsZSBkYXRhXHJcbiAqL1xyXG4gZnVuY3Rpb24gaGFuZGxlUHJvZmlsZUZvcm1TdWJtaXQgKGlucHV0cykge1xyXG4gIHByb2ZpbGVQb3B1cC5yZW5kZXJMb2FkaW5nKHRydWUsIFwiLnBvcHVwX19zdWJtaXQtYnRuX3BsYWNlX3Byb2ZpbGVcIik7XHJcblxyXG4gIGFwaS5lZGl0UHJvZmlsZSh7bmFtZTogaW5wdXRzLnByb2ZpbGVOYW1lLCBhYm91dDogaW5wdXRzLnByb2ZpbGVBYm91dE1lfSlcclxuICAudGhlbiAoKCkgPT4ge1xyXG4gICAgdXNlckluZm8uc2V0VXNlckluZm8oe25hbWU6IGlucHV0cy5wcm9maWxlTmFtZSwgYWJvdXQ6IGlucHV0cy5wcm9maWxlQWJvdXRNZX0pXHJcbiAgICBwcm9maWxlUG9wdXAuY2xvc2UoKTtcclxuICAgICgpID0+IGZvcm1WYWxpZGF0b3JzW1wicHJvZmlsZWZvcm1cIl0udG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuICB9KVxyXG4gIC5jYXRjaCAoKGVycikgPT4ge1xyXG4gICAgY29uc29sZS5sb2coZXJyKTtcclxuICB9KVxyXG4gIC5maW5hbGx5KCgpID0+e1xyXG4gICAgcHJvZmlsZVBvcHVwLnJlbmRlckxvYWRpbmcoZmFsc2UsIFwiLnBvcHVwX19zdWJtaXQtYnRuX3BsYWNlX3Byb2ZpbGVcIik7XHJcbiAgfSlcclxufVxyXG5cclxuLyoqXHJcbiAqIGFkZCBuZXcgY2FyZCBpdGVtIHRvIGdhbGxlcnlcclxuICovXHJcbiBvcGVOZXdDYXJkUG9wdXBCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IG5ld0NhcmRQb3B1cC5vcGVuKCkpO1xyXG5cclxuIGZ1bmN0aW9uIGNyZWF0ZUNhcmQgKGl0ZW0pIHtcclxuICBjb25zdCBjYXJkID0gbmV3IENhcmQoXHJcbiAgICBpdGVtLCBcclxuICAgIFwiI2dhbGxlcnktaXRlbS10ZW1wbGF0ZVwiLFxyXG4gICAgKCkgPT4geyBwb3B1cENhcmRJdGVtLm9wZW4oaXRlbS5saW5rLCBpdGVtLm5hbWUpOyB9LFxyXG4gICAgKCkgPT4geyBwb3B1cENvbmZpcm0ub3BlbihjYXJkKTsgfSxcclxuICAgIGhhbmRsZUxpa2UsXHJcbiAgICBhcGkpO1xyXG4gICAgcmV0dXJuIGNhcmQuZ2VuZXJhdGVDYXJkKCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uICBhZGRHYWxsZXJ5Q2FyZEl0ZW0gKGl0ZW0pIHtcclxuICBjYXJkTGlzdC5hZGRJdGVtKGNyZWF0ZUNhcmQoaXRlbSkpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVDcmVhdGVOZXdDYXJkIChpbnB1dHMpIHtcclxuICBuZXdDYXJkUG9wdXAucmVuZGVyTG9hZGluZyh0cnVlLCBcIi5wb3B1cF9fc3VibWl0LWJ0bl9wbGFjZV9uZXctY2FyZFwiKTtcclxuXHJcbiAgYXBpLmNyZWF0ZU5ld0NhcmQoaW5wdXRzLnBsYWNlSW1hZ2VMaW5rLGlucHV0cy5wbGFjZU5hbWUpXHJcbiAgLnRoZW4oZGF0YSA9PiB7XHJcbiAgICBhZGRHYWxsZXJ5Q2FyZEl0ZW0gKGRhdGEpXHJcbiAgICBuZXdDYXJkUG9wdXAuY2xvc2UoKTtcclxuICAgIGZvcm1WYWxpZGF0b3JzW1wicGxhY2Vmb3JtXCJdLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgfSlcclxuICAuY2F0Y2ggKChlcnIpID0+IHtcclxuICAgIGhhbmRsZUVycm9yKGVycik7XHJcbiAgfSlcclxuICAuZmluYWxseSgoKSA9PntcclxuICAgIG5ld0NhcmRQb3B1cC5yZW5kZXJMb2FkaW5nKGZhbHNlLCBcIi5wb3B1cF9fc3VibWl0LWJ0bl9wbGFjZV9uZXctY2FyZFwiKTtcclxuICB9KVxyXG59XHJcblxyXG4vKipcclxuICogZGVsZXRlIGNhcmQgaXRlbSBmcm9tIGdhbGxlcnlcclxuICovXHJcbiBmdW5jdGlvbiBoYW5kbGVEZWxldGUoY2FyZCkge1xyXG4gIGFwaS5kZWxldGVDYXJkKGNhcmQuX2lkKVxyXG4gIC50aGVuKCgpID0+e1xyXG4gICAgY2FyZC5fZWxlbWVudC5yZW1vdmUoKTtcclxuICAgIGNhcmQuX2VsZW1lbnQgPSBudWxsO1xyXG4gICAgcG9wdXBDb25maXJtLmNsb3NlKCk7XHJcbiAgfSlcclxuICAuY2F0Y2goZXJyID0+IHtcclxuICAgIGNvbnNvbGUubG9nKGVycik7XHJcbiAgfSlcclxufVxyXG5cclxuLyoqXHJcbiAqIGhhbmRsZSBjYXJkIGxpa2VzIHVwZGF0ZVxyXG4gKi9cclxuZnVuY3Rpb24gaGFuZGxlTGlrZShjYXJkKSB7XHJcbiAgY2FyZC51cGRhdGVMaWtlcygpXHJcbiAgICAudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgICBjYXJkLnNldExpa2VzKGRhdGEpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGVycik7XHJcbiAgICB9KSAgICAgXHJcbiAgIFxyXG59XHJcblxyXG4vKipcclxuICogYWRkIGV2ZW50IGxpc3RlbmVyIHRvIGVkaXQgdXNlciBwcm9maWxlIGluZm9cclxuICovXHJcbnByb2ZpbGVFZGl0QnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgY29uc3Qge25hbWUsIGFib3V0IH0gPSB1c2VySW5mby5nZXRVc2VySW5mbygpO1xyXG4gIGlucHV0TmFtZS52YWx1ZSAgPSBuYW1lO1xyXG4gIGlucHV0QWJvdXRNZS52YWx1ZSAgPSBhYm91dDtcclxuICBwcm9maWxlUG9wdXAub3BlbigpO1xyXG59KTtcclxuXHJcbi8qKlxyXG4gKiBzZXQgRXJyb3IgZGVzY3JpcHRpb24gb24gdG9wIG9mIHRoZSBwYWdlXHJcbiAqL1xyXG4gZnVuY3Rpb24gaGFuZGxlRXJyb3IoZXJyKSB7XHJcbiAgZXJyb3JFbC50ZXh0Q29udGVudCA9IGVycjtcclxuICBlcnJvckVsLnN0eWxlLmRpc3BsYXkgID0gXCJibG9ja1wiO1xyXG59XHJcblxyXG5cclxuY29uc3QgZW5hYmxlVmFsaWRhdGlvbiA9IChjb25maWcpID0+IHtcclxuICBjb25zdCBmb3JtTGlzdCA9IEFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChjb25maWcuZm9ybVNlbGVjdG9yKSlcclxuICBmb3JtTGlzdC5mb3JFYWNoKChmb3JtRWxlbWVudCkgPT4ge1xyXG4gICAgY29uc3QgdmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoY29uZmlnLGZvcm1FbGVtZW50KVxyXG4gICAgLy9nZXQgdGhlIG5hbWUgb2YgdGhlIGZvcm1cclxuICAgIGNvbnN0IGZvcm1OYW1lID0gZm9ybUVsZW1lbnQuZ2V0QXR0cmlidXRlKCduYW1lJylcclxuXHJcbiAgIC8vc3RvcmUgYSB2YWxpZGF0b3IgYnkgdGhlIGBuYW1lYCBvZiB0aGUgZm9ybVxyXG4gICAgZm9ybVZhbGlkYXRvcnNbZm9ybU5hbWVdID0gdmFsaWRhdG9yO1xyXG4gICB2YWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG4gIH0pO1xyXG59O1xyXG5cclxuZW5hYmxlVmFsaWRhdGlvbihjb25maWcpO1xyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwe1xyXG4gICAgY29uc3RydWN0b3IgKCBpbWdTZWxlY3RvciwgdGl0bGVTZWxlY3RvciAscG9wdXBTZWxlY3RvciApIHtcclxuICAgICAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcclxuICAgICAgICB0aGlzLl9wb3B1cEltZyA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoaW1nU2VsZWN0b3IpO1xyXG4gICAgICAgIHRoaXMuX3BvcHVwVGl0bGUgPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKHRpdGxlU2VsZWN0b3IpO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBvcGVuKHNyYywgdGl0bGUgKSB7XHJcbiAgICAgICAgdGhpcy5fc3JjICAgPSBzcmM7XHJcbiAgICAgICAgdGhpcy5fdGl0bGUgPSB0aXRsZTtcclxuICAgICAgICB0aGlzLl9wb3B1cEltZy5zcmMgPSAgdGhpcy5fc3JjO1xyXG4gICAgICAgIHRoaXMuX3BvcHVwSW1nLmFsdCA9ICB0aGlzLl90aXRsZTtcclxuICAgICAgICB0aGlzLl9wb3B1cFRpdGxlLnRleHRDb250ZW50ID0gYFBob3RvIG9mICR7dGhpcy5fdGl0bGV9YDtcclxuICAgICAgICBzdXBlci5vcGVuKCk7XHJcbiAgICB9XHJcbn0iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aENvbmZpcm1hdGlvbiAgZXh0ZW5kcyBQb3B1cCB7XHJcbiAgICAgICAgY29uc3RydWN0b3IgKCBwb3B1cFNlbGVjdG9yLCBoYW5kbGVDb25maXJtICkge1xyXG4gICAgICAgICAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcclxuICAgICAgICAgICAgdGhpcy5faGFuZGxlQ29uZmlybSAgICAgPSAgIGhhbmRsZUNvbmZpcm07XHJcbiAgICAgICAgICAgIHRoaXMuX2Zvcm1FbGVtZXQgICAgICAgID0gICB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19mb3JtXCIpO1xyXG4gICAgICAgIH1cclxuXHJcblxyXG4gICAgICAgIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgICAgICAgICAvKipcclxuICAgICAgICAgICAgICogSXQgbW9kaWZpZXMgdGhlIHNldEV2ZW50TGlzdGVuZXJzKCkgcGFyZW50IG1ldGhvZC4gXHJcbiAgICAgICAgICAgICAqICBoYXMgdG8gYWRkIHRoZSBzdWJtaXQgZXZlbnQgaGFuZGxlciB0byB0aGUgZm9ybSBhbmQgdGhlIGNsaWNrIFxyXG4gICAgICAgICAgICAgKiBldmVudCBsaXN0ZW5lciB0byB0aGUgY2xvc2UgaWNvbi5cclxuICAgICAgICAgICAgICovXHJcbiAgICAgICAgICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICAgICAgICAgIHRoaXMuX2Zvcm1FbGVtZXQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAgdGhpcy5faGFuZGxlU3VibWl0KTsgXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZW1vdmVFdmVudExpc3RlbmVycygpIHtcclxuICAgICAgICAgICAgc3VwZXIucmVtb3ZlRXZlbnRMaXN0ZW5lcnMoKVxyXG4gICAgICAgICAgICB0aGlzLl9mb3JtRWxlbWV0LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgdGhpcy5faGFuZGxlU3VibWl0KTsgXHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIF9oYW5kbGVTdWJtaXQgPShldnQpID0+e1xyXG4gICAgICAgICAgICBldnQucHJldmVudERlZmF1bHQoKTsgXHJcbiAgICAgICAgICAgIHRoaXMuX2hhbmRsZUNvbmZpcm0odGhpcy5fY2FyZEVsKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIG9wZW4oY2FyZEVsKSB7XHJcbiAgICAgICAgICAgIHN1cGVyLm9wZW4oKTtcclxuICAgICAgICAgICAgdGhpcy5fY2FyZEVsID0gY2FyZEVsO1xyXG4gICAgICAgIH1cclxufSIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xyXG4gICAgY29uc3RydWN0b3IoIHJlbmRlcmVyICwgY29udGFpbmVyU2VsZWN0b3IgKSB7XHJcbiAgICAgICAgdGhpcy5fcmVuZGVyZXIgICAgPSByZW5kZXJlcjtcclxuICAgICAgICB0aGlzLl9jb250YWluZXIgICA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyU2VsZWN0b3IpO1xyXG4gICAgfVxyXG5cclxuICAgIGFkZEl0ZW0oZWxlbWVudCkge1xyXG4gICAgICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKGVsZW1lbnQpO1xyXG4gICAgICB9XHJcbiAgICBcclxuICAgICAgcmVuZGVyZXJJdGVtcyhjYXJkcykge1xyXG4gICAgICAgIGNhcmRzLmZvckVhY2goaXRlbSA9PiB7XHJcbiAgICAgICAgICB0aGlzLl9yZW5kZXJlcihpdGVtKTtcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG5cclxufSIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFVzZXJJbmZvIHtcclxuICAgIC8qKlxyXG4gICAgICogVGhlIFVzZXJJbmZvIGNsYXNzIGlzIHJlc3BvbnNpYmxlIGZvciByZW5kZXJpbmcgXHJcbiAgICAgKiBpbmZvcm1hdGlvbiBhYm91dCB0aGUgdXNlciBvbiB0aGUgcGFnZS4gVGhpcyBjbGFzcyBzaG91bGQ6XHJcbiAgICAgKiAtVGFrZSBhbiBvYmplY3Qgd2l0aCB0aGUgc2VsZWN0b3JzIG9mIHR3byBlbGVtZW50cyBpbnRvIHRoZSBjb25zdHJ1Y3RvcjogXHJcbiAgICAgKiBvbmUgY29udGFpbmluZyB0aGUgdXNlcidzIG5hbWUsIGFuZCBhbm90aGVyIGNvbnRhaW5pbmcgdGhlIHVzZXIncyBqb2IuXHJcbiAgICAgKi9cclxuICAgIGNvbnN0cnVjdG9yICggbmFtZVNlbGVjdG9yLCBqb2JTZWxlY3RvciwgYXZhdGFyU2VsZWN0b3IgPSBudWxsKSB7XHJcbiAgICAgICAgdGhpcy5fbmFtZUVsZW1lbnQgICA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IobmFtZVNlbGVjdG9yKTtcclxuICAgICAgICB0aGlzLl9qb2JFbGVtZW50ICAgID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihqb2JTZWxlY3Rvcik7XHJcbiAgICAgICAgdGhpcy5fYXZhdGFyICAgICAgICA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYXZhdGFyU2VsZWN0b3IpO1xyXG4gICAgfVxyXG5cclxuICAgIGdldFVzZXJJbmZvKCkge1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIHJldHVybnMgYW4gb2JqZWN0IHdpdGggaW5mb3JtYXRpb24gYWJvdXQgdGhlIHVzZXIuIFxyXG4gICAgICAgICAqIFRoaXMgbWV0aG9kIHdpbGwgYmUgaGFuZHkgZm9yIFxyXG4gICAgICAgICAqIGNhc2VzIHdoZW4gaXQncyBuZWNlc3NhcnkgdG8gZGlzcGxheSB0aGUgdXNlciBkYXRhIGluIHRoZSBvcGVuIGZvcm0uXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgbmFtZTogdGhpcy5fbmFtZUVsZW1lbnQudGV4dENvbnRlbnQsXHJcbiAgICAgICAgICAgIGFib3V0OiB0aGlzLl9qb2JFbGVtZW50LnRleHRDb250ZW50XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHNldFVzZXJJbmZvKHsgbmFtZSwgYWJvdXQsIF9pZCB9KXtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiB0YWtlcyBuZXcgdXNlciBkYXRhIGFuZCBhZGRzIGl0IG9uIHRoZSBwYWdlLlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMuX25hbWVFbGVtZW50LnRleHRDb250ZW50ICAgPSBuYW1lO1xyXG4gICAgICAgIHRoaXMuX25hbWVFbGVtZW50LmlkICAgICAgICAgICAgPSBfaWQ7XHJcbiAgICAgICAgdGhpcy5fam9iRWxlbWVudC50ZXh0Q29udGVudCAgICA9IGFib3V0O1xyXG4gICAgfVxyXG5cclxuICAgIHNldFVzZXJBdmF0YXIoe2F2YXRhciwgbmFtZSA9IG51bGx9KSB7XHJcbiAgICAgICAgdGhpcy5fYXZhdGFyLnNyYyA9IGF2YXRhcjtcclxuICAgICAgICBpZihuYW1lKXtcclxuICAgICAgICAgICAgdGhpcy5fYXZhdGFyLmFsdCA9IG5hbWU7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59IiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQXBpIHtcclxuICAgIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHtcclxuICAgICAgdGhpcy5fb3B0aW9ucyA9IG9wdGlvbnM7XHJcblxyXG4gICAgfVxyXG4gIFxyXG4gICAgX2NhbGwoYWN0aW9uLCBtZXRob2QsIGRhdGEpIHtcclxuICAgICAgcmV0dXJuIGZldGNoKHRoaXMuX29wdGlvbnMuYmFzZVVybCArIGFjdGlvbiwge1xyXG4gICAgICAgIG1ldGhvZDogbWV0aG9kLFxyXG4gICAgICAgIGhlYWRlcnM6ICB0aGlzLl9vcHRpb25zLmhlYWRlcnMsXHJcbiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoZGF0YSksXHJcbiAgICAgIH0pXHJcbiAgICAgIC50aGVuKHJlcyA9PiB7XHJcbiAgICAgICAgaWYocmVzLm9rKSB7XHJcbiAgICAgICAgICByZXR1cm4gIHJlcy5qc29uKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChyZXMuc3RhdHVzKTtcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBnZXRJbml0aWFsQ2FyZHMgPSAoKSA9PiB7XHJcbiAgICAgIHJldHVybiB0aGlzLl9jYWxsKFwiL2NhcmRzXCIsJ0dFVCcpO1xyXG4gICAgfVxyXG4gIFxyXG4gICAgZ2V0VXNlckRhdGEgPSAoKSA9PiB7XHJcbiAgICAgIHJldHVybiB0aGlzLl9jYWxsKFwiL3VzZXJzL21lXCIsJ0dFVCcpO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBlZGl0UHJvZmlsZSh7bmFtZSwgYWJvdXR9KSB7XHJcbiAgICAgIHJldHVybiB0aGlzLl9jYWxsKFwiL3VzZXJzL21lXCIsJ1BBVENIJyx7XHJcbiAgICAgICAgbmFtZTogbmFtZSxcclxuICAgICAgICBhYm91dDogYWJvdXRcclxuICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgY3JlYXRlTmV3Q2FyZCAobGluaywgbmFtZSkge1xyXG4gICAgICByZXR1cm4gdGhpcy5fY2FsbChcIi9jYXJkc1wiLCdQT1NUJyx7XHJcbiAgICAgICAgbmFtZTogbmFtZSxcclxuICAgICAgICBsaW5rOiBsaW5rXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBhZGRMaWtlID0gKGNhcmRJZCkgPT4ge1xyXG4gICAgICByZXR1cm4gdGhpcy5fY2FsbChgL2NhcmRzL2xpa2VzLyR7Y2FyZElkfWAsJ1BVVCcpO1xyXG4gICAgfVxyXG5cclxuICAgIGRlbGV0ZUxpa2UgPSAoY2FyZElkKSA9PiB7XHJcbiAgICAgIHJldHVybiB0aGlzLl9jYWxsKGAvY2FyZHMvbGlrZXMvJHtjYXJkSWR9YCwnREVMRVRFJyk7XHJcbiAgICB9XHJcblxyXG4gICAgZGVsZXRlQ2FyZCA9IChjYXJkSWQpID0+IHtcclxuICAgICAgcmV0dXJuIHRoaXMuX2NhbGwoYC9jYXJkcy8ke2NhcmRJZH1gLCdERUxFVEUnKTtcclxuICAgIH1cclxuXHJcbiAgICBlZGl0UHJvZmlsZUF2YXRhcih1cmwpe1xyXG4gICAgICByZXR1cm4gdGhpcy5fY2FsbChcIi91c2Vycy9tZS9hdmF0YXIgXCIsJ1BBVENIJyx7XHJcbiAgICAgICAgYXZhdGFyIDogdXJsXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGluaXQoKSB7XHJcbiAgICAgIHJldHVybiBQcm9taXNlLmFsbChbdGhpcy5nZXRVc2VyRGF0YSgpLCB0aGlzLmdldEluaXRpYWxDYXJkcygpXSk7XHJcbiAgICB9XHJcblxyXG4gIH1cclxuICBcclxuIl0sIm5hbWVzIjpbIkNhcmQiLCJjb25zdHJ1Y3RvciIsImRhdGEiLCJjYXJkU2VsZWN0b3IiLCJoYW5kbGVDYXJkQ2xpY2siLCJoYW5kbGVUcmFzaENsaWNrIiwiaGFuZGxlTGlrZSIsImFwaSIsInRoaXMiLCJfdGV4dCIsIm5hbWUiLCJfaW1nIiwibGluayIsIl9pZCIsIl9saWtlcyIsImxpa2VzIiwiX0NhcmRvd25lciIsIm93bmVyIiwiX2NhcmRTZWxlY3RvciIsIl9oYW5kbGVDYXJkQ2xpY2siLCJfaGFuZGxlVHJhc2hDbGljayIsIl9hZGRMaWtlIiwiYWRkTGlrZSIsIl9kZWxldGVMaWtlIiwiZGVsZXRlTGlrZSIsIl9kZWxldGVDYXJkIiwiZGVsZXRlQ2FyZCIsIl9oYW5kbGVMaWtlIiwiX2VsZW1lbnQiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiX2l0ZW1JbWdFbCIsIl9pdGVtTmFtZUVsIiwicHJvZmlsZUVsIiwiX2l0ZW1UcmFzaEJ0biIsIl9pdGVtTGlrZUJ0biIsIl9nYWxsZXJ5bGlrZUNvdW50IiwiZ2V0SWQiLCJnZW5lcmF0ZUNhcmQiLCJzcmMiLCJhbHQiLCJ0ZXh0Q29udGVudCIsImlkIiwiX2luaXRMaWtlIiwiX2RlbGV0ZUljb25WaXNpYmlsaXR5IiwiX3NldEV2ZW50TGlzdGVuZXJzIiwidXNlcklkIiwic3R5bGUiLCJ2aXNpYmlsaXR5IiwiX3VzZXJFeGlzdHMiLCJjbGFzc0xpc3QiLCJhZGQiLCJsZW5ndGgiLCJzb21lIiwidXNlciIsImFkZEV2ZW50TGlzdGVuZXIiLCJ1cGRhdGVMaWtlcyIsImNvbnRhaW5zIiwic2V0TGlrZXMiLCJ0b2dnbGUiLCJQb3B1cCIsInBvcHVwU2VsZWN0b3IiLCJldnQiLCJrZXkiLCJjbG9zZSIsInRhcmdldCIsIl9wb3B1cCIsInJlbW92ZSIsInJlbW92ZUV2ZW50TGlzdGVuZXJzIiwib3BlbiIsInNldEV2ZW50TGlzdGVuZXJzIiwiX2hhbmRsZUVzY0Nsb3NlIiwiX2hhbmRsZUNsaWNrQ2xvc2VQb3B1cCIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJQb3B1cFdpdGhGb3JtIiwiaGFuZGxlRm9ybVN1Ym1pdCIsInN1cGVyIiwicHJldmVudERlZmF1bHQiLCJfaGFuZGxlRm9ybVN1Ym1pdCIsIl9nZXRJbnB1dFZhbHVlcyIsIl9mb3JtRWxlbWV0IiwiX2lucHV0c0FyciIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJfaW5wdXRWYWx1ZXMiLCJmb3JFYWNoIiwiaW5wdXQiLCJ2YWx1ZSIsIl9oYW5kbGVTdWJtaXQiLCJyZW5kZXJMb2FkaW5nIiwiaXNMb2FkaW5nIiwiYnRuU2VsZWN0b3IiLCJyZXNldCIsIkZvcm1WYWxpZGF0b3IiLCJjb25maWciLCJmb3JtRWwiLCJfZm9ybVNlbGVjdG9yIiwiZm9ybVNlbGVjdG9yIiwiX2Zvcm1JbnB1dHNGaWVsZFNldCIsImZvcm1JbnB1dHNGaWVsZFNldCIsIl9pbnB1dFNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsIl9zdWJtaXRCdG5TZWxlY3RvciIsInN1Ym1pdEJ0blNlbGVjdG9yIiwiX2luYWN0aXZlQnRuQ2xhc3MiLCJpbmFjdGl2ZUJ0bkNsYXNzIiwiX2lucHV0RXJyQ2xhc3MiLCJpbnB1dEVyckNsYXNzIiwiX2lucHV0RXJyQWN0aXZlQ2xhc3MiLCJpbnB1dEVyckFjdGl2ZUNsYXNzIiwiX2Zvcm1FbCIsIl9pbnB1dExzdCIsIkFycmF5IiwiZnJvbSIsIl9idG5FbCIsIl9zaG93SW5wdXRFcnIiLCJpbnB1dEVsIiwiZXJyRWwiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsIl9oaWRlSW5wdXRFcnJvciIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJ2YWxpZGl0eSIsInZhbGlkIiwiX2hhc0ludmFsaWRJbnB1dCIsImlucHV0THN0IiwidG9nZ2xlQnV0dG9uU3RhdGUiLCJkaXNhYmxlZCIsImVuYWJsZVZhbGlkYXRpb24iLCJwcm9maWxlRm9ybSIsImZvcm1zIiwicHJvZmlsZWZvcm0iLCJpbnB1dE5hbWUiLCJlbGVtZW50cyIsInByb2ZpbGVOYW1lIiwiaW5wdXRBYm91dE1lIiwicHJvZmlsZUFib3V0TWUiLCJwbGFjZWZvcm0iLCJwcm9maWxlRWRpdEJ0biIsIm9wZU5ld0NhcmRQb3B1cEJ0biIsImF2YXRhckVkaXRCdG4iLCJlcnJvckVsIiwicG9wdXBDYXJkSXRlbSIsImltZ1NlbGVjdG9yIiwidGl0bGVTZWxlY3RvciIsIl9wb3B1cEltZyIsIl9wb3B1cFRpdGxlIiwidGl0bGUiLCJfc3JjIiwiX3RpdGxlIiwicG9wdXBDb25maXJtIiwiaGFuZGxlQ29uZmlybSIsIl9oYW5kbGVDb25maXJtIiwiX2NhcmRFbCIsImNhcmRFbCIsImNhcmQiLCJ0aGVuIiwiY2F0Y2giLCJlcnIiLCJjb25zb2xlIiwibG9nIiwiZWRpdEF2YXRhclBvcHVwIiwiaW5wdXRzIiwiZWRpdFByb2ZpbGVBdmF0YXIiLCJhdmF0YXJJbWFnZUxpbmsiLCJ1c2VySW5mbyIsInNldFVzZXJBdmF0YXIiLCJhdmF0YXIiLCJmb3JtVmFsaWRhdG9ycyIsImhhbmRsZUVycm9yIiwiZmluYWxseSIsIm5ld0NhcmRQb3B1cCIsImNyZWF0ZU5ld0NhcmQiLCJwbGFjZUltYWdlTGluayIsInBsYWNlTmFtZSIsImFkZEdhbGxlcnlDYXJkSXRlbSIsInByb2ZpbGVQb3B1cCIsImVkaXRQcm9maWxlIiwiYWJvdXQiLCJzZXRVc2VySW5mbyIsImNhcmRMaXN0IiwicmVuZGVyZXIiLCJjb250YWluZXJTZWxlY3RvciIsIl9yZW5kZXJlciIsIl9jb250YWluZXIiLCJhZGRJdGVtIiwiZWxlbWVudCIsInByZXBlbmQiLCJyZW5kZXJlckl0ZW1zIiwiY2FyZHMiLCJpdGVtIiwibmFtZVNlbGVjdG9yIiwiam9iU2VsZWN0b3IiLCJhdmF0YXJTZWxlY3RvciIsIl9uYW1lRWxlbWVudCIsIl9qb2JFbGVtZW50IiwiX2F2YXRhciIsImdldFVzZXJJbmZvIiwib3B0aW9ucyIsIl9jYWxsIiwiY2FyZElkIiwiX29wdGlvbnMiLCJhY3Rpb24iLCJtZXRob2QiLCJmZXRjaCIsImJhc2VVcmwiLCJoZWFkZXJzIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwidXJsIiwiaW5pdCIsImFsbCIsImdldFVzZXJEYXRhIiwiZ2V0SW5pdGlhbENhcmRzIiwiYXV0aG9yaXphdGlvbiIsImNyZWF0ZUNhcmQiLCJkaXNwbGF5IiwiZm9ybUVsZW1lbnQiLCJ2YWxpZGF0b3IiLCJmb3JtTmFtZSIsImdldEF0dHJpYnV0ZSJdLCJzb3VyY2VSb290IjoiIn0=