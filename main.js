!function(){"use strict";class e{constructor(e,t,i,s,r){var n,o;o=()=>{const e=this._element.querySelector(".gallery__like-btn"),t=this._element.querySelector(".gllery__like-count");e.classList.contains("gallery__like-btn_active")?(this._deleteLike(this._element.id),t.textContent--):(this._addLike(this._element.id),t.textContent++),this._element.querySelector(".gallery__like-btn").classList.toggle("gallery__like-btn_active")},(n="_handleLikeBtn")in this?Object.defineProperty(this,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):this[n]=o,this._text=e.name,this._img=e.link,this._id=e._id,this._likes=e.likes,this._Cardowner=e.owner,this._cardSelector=t,this._handleCardClick=i,this._handleTrashClick=s,this._addLike=r.addLike,this._deleteLike=r.deleteLike,this._deleteCard=r.deleteCard}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".gallery__item").cloneNode(!0)}generateCard(){this._element=this._getTemplate();const e=this._element.querySelector(".gallery__item-img"),t=this._element.querySelector(".gallery__item-name"),i=document.querySelector(".profile__name").id;return e.src=this._img,e.alt=this._text,t.textContent=this._text,this._element.id=this._id,this._initLike(i),this._deleteIconVisibility(i),this._setEventListeners(),this._element}_deleteIconVisibility(e){e!=this._Cardowner._id&&(this._element.querySelector(".gallery__item-trash-btn").style.visibility="hidden")}_initLike(e){this._userExists(e)&&this._element.querySelector(".gallery__like-btn").classList.add("gallery__like-btn_active");const t=this._element.querySelector(".gllery__like-count");void 0!==this._likes?t.textContent=this._likes.length:t.textContent=0}_userExists(e){return void 0!==this._likes&&this._likes.some((function(t){return t._id===e}))}_setEventListeners(){this._element.querySelector(".gallery__like-btn").addEventListener("click",this._handleLikeBtn),this._element.querySelector(".gallery__item-trash-btn").addEventListener("click",this._handleTrashClick),this._element.querySelector(".gallery__item-img").addEventListener("click",this._handleCardClick)}}function t(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class i{constructor(e){t(this,"_handleEscClose",(e=>{"Escape"===e.key&&document.querySelector(".popup_opened")&&this.close()})),t(this,"_handleClickClosePopup",(e=>{(e.target.classList.contains("popup_opened")||e.target.classList.contains("popup__close"))&&this.close()})),this._popup=document.querySelector(e)}close(){this._popup.classList.remove("popup_opened"),this.removeEventListeners()}open(){this._popup.classList.add("popup_opened"),this.setEventListeners()}setEventListeners(){document.addEventListener("keydown",this._handleEscClose),document.addEventListener("mousedown",this._handleClickClosePopup)}removeEventListeners(){document.removeEventListener("keydown",this._handleEscClose),document.removeEventListener("mousedown",this._handleClickClosePopup)}}class s extends i{constructor(e,t){var i,s;super(e),s=e=>{e.preventDefault();const t=this._getInputValues();this._handleFormSubmit(t),this.close()},(i="_handleSubmit")in this?Object.defineProperty(this,i,{value:s,enumerable:!0,configurable:!0,writable:!0}):this[i]=s,this._handleFormSubmit=t,this._formElemet=this._popup.querySelector(".popup__form")}_getInputValues(){const e={};return this._formElemet.querySelectorAll(".popup__input").forEach((t=>{e[t.name]=[t.value]})),e}setEventListeners(){super.setEventListeners(),this._formElemet.addEventListener("submit",this._handleSubmit)}removeEventListeners(){this._formElemet.removeEventListener("submit",this._handleSubmit)}close(){super.close(),this._formElemet.reset(),this.removeEventListeners()}}class r extends i{constructor(e,t){let{src:i,title:s}=e;super(t),this._src=i,this._title=s}open(){super.open(),this._popupImg=this._popup.querySelector(".popup__img"),this._popupTitle=this._popup.querySelector(".popup__img-title"),this._popupImg.src=this._src,this._popupImg.alt=this._title,this._popupTitle.textContent="Photo of ".concat(this._title)}}class n extends i{constructor(e,t){var i,s;super(e),s=e=>{e.preventDefault(),this._handleConfirm(this._popup.id),this.close()},(i="_handleSubmit")in this?Object.defineProperty(this,i,{value:s,enumerable:!0,configurable:!0,writable:!0}):this[i]=s,this._handleConfirm=t,this._formElemet=this._popup.querySelector(".popup__form")}setEventListeners(){super.setEventListeners(),this._formElemet.addEventListener("submit",this._handleSubmit)}removeEventListeners(){this._formElemet.removeEventListener("submit",this._handleSubmit)}open(e){super.open(),this._popup.id=e}close(){super.close(),this._formElemet.reset(),this.removeEventListeners()}}class o{constructor(e,t){this._formSelector=e.formSelector,this._formInputsFieldSet=e.formInputsFieldSet,this._inputSelector=e.inputSelector,this._submitBtnSelector=e.submitBtnSelector,this._inactiveBtnClass=e.inactiveBtnClass,this._inputErrClass=e.inputErrClass,this._inputErrActiveClass=e.inputErrActiveClass,this._formEl=document.querySelector(t)}_showInputErr(e){const t=this._formEl.querySelector(".".concat(e.id,"-error"));e.classList.add(this._inputErrClass),t.textContent=e.validationMessage,t.classList.add(this._inputErrActiveClass)}_hideInputError(e){const t=this._formEl.querySelector(".".concat(e.id,"-error"));e.classList.remove(this._inputErrClass),t.classList.remove(this._inputErrActiveClass),t.textContent=""}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputErr(e)}_hasInvalidInput(e){return e.some((e=>!e.validity.valid))}toggleButtonState(){const e=Array.from(this._formEl.querySelectorAll(this._inputSelector)),t=this._formEl.querySelector(this._submitBtnSelector);this._hasInvalidInput(e)?(t.classList.add(this._inactiveBtnClass),t.disabled=!0):(t.classList.remove(this._inactiveBtnClass),t.disabled=!1)}_setEventListeners(){const e=Array.from(this._formEl.querySelectorAll(this._inputSelector)),t=this._formEl.querySelector(this._submitBtnSelector);this.toggleButtonState(e,t),e.forEach((i=>{i.addEventListener("input",(()=>{this._checkInputValidity(i),this.toggleButtonState(e,t)}))}))}enableValidation(){this._setEventListeners(),this._formEl.addEventListener("submit",(e=>e.preventDefault()))}}const l={formSelector:".popup__form",formInputsFieldSet:".popup__form-set",inputSelector:".popup__input",submitBtnSelector:".popup__submit-btn",inactiveBtnClass:"button_inactive",inputErrClass:"popup__input-text_type_error",inputErrActiveClass:"popup__input-text-error_active"},a=document.forms.profileform,c=a.elements.profileName,_=a.elements.profileAboutMe,u=document.forms.placeform;function h(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const p=document.querySelector("button.profile__edit-btn"),d=document.querySelector("button.profile__add-btn"),m=document.querySelector(".profile__name"),f=(document.querySelector(".profile__about-me"),document.querySelector(".profile__avatar"),document.querySelector(".gallery"),new Array),v=new class{constructor(e){h(this,"getInitialCards",(()=>this._call("/cards","GET"))),h(this,"getUserData",(()=>this._call("/users/me","GET"))),h(this,"addLike",(e=>this._call("/cards/likes/".concat(e),"PUT"))),h(this,"deleteLike",(e=>this._call("/cards/likes/".concat(e),"DELETE"))),h(this,"deleteCard",(e=>this._call("/cards/".concat(e),"DELETE"))),this._options=e}_call(e,t,i){return fetch(this._options.baseUrl+e,{method:t,headers:this._options.headers,body:JSON.stringify(i)}).then((e=>e.ok?e.json():Promise.reject(e.status)))}editProfile(e){let{name:t,about:i}=e;return this._call("/users/me","PATCH",{name:t[0],about:i[0]})}createNewCard(e,t){return this._call("/cards","POST",{name:t[0],link:e[0]})}init(){return Promise.all([this.getUserData(),this.getInitialCards()])}}({baseUrl:"https://around.nomoreparties.co/v1/group-12",headers:{authorization:"9b621f0f-5dfe-43f1-95fd-e9cc188bcc35","Content-Type":"application/json"}});function y(e){const t=document.querySelector(".profile__error");t.textContent=e,t.style.display="block"}v.init().then((e=>{let[t,i]=e;b.setUserInfo(t),b.setUserAvatar({avatar:t.avatar,name:t.name}),i.forEach((e=>{f.push(e)})),E.renderer()})).catch((e=>{y(e)}));const E=new class{constructor(e,t){let{data:i,renderer:s}=e;this._items=i,this._renderer=s,this._container=document.querySelector(t)}addItem(e){this._container.append(e)}renderer(){this._items.forEach((e=>{this._renderer(e)}))}}({data:f,renderer:S},".gallery__list"),b=new class{constructor(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this._nameElement=document.querySelector(e),this._jobElement=document.querySelector(t),this._avatar=document.querySelector(i)}getUserInfo(){return{name:this._nameElement.textContent,about:this._jobElement.textContent}}setUserInfo(e){this._nameElement.textContent=e.name,this._nameElement.id=e._id,this._jobElement.textContent=e.about}setUserAvatar(e){let{avatar:t,name:i}=e;this._avatar.src=t,this._avatar.alt=i}}(".profile__name",".profile__about-me",".profile__avatar");function S(t){const i=new e(t,"#gallery-item-template",(()=>{new r({src:t.link,title:t.name},".popup_type_img").open()}),(()=>{new n(".popup_type_delete",L).open(t._id)}),v).generateCard();E.addItem(i)}const g=new s(".popup_type_new-card",(function(e){S({link:e.placeImageLink,name:e.placeName,owner:{_id:m.id}}),v.createNewCard(e.placeImageLink,e.placeName).then((e=>{console.log(e)})).catch((e=>{y(e)})),u.reset(),g.close(),k.toggleButtonState()}));function L(e){v.deleteCard(e).then((()=>{let e=document.querySelector(".gallery__item");e.remove(),e=null})).catch((e=>{alert(e)}))}d.addEventListener("click",(()=>g.open()));const C=new s(".popup_type_profile",(function(e){b.setUserInfo({name:e.profileName,about:e.profileAboutMe}),v.editProfile({name:e.profileName,about:e.profileAboutMe}).catch((e=>{console.log(e)})),q.toggleButtonState()}));p.addEventListener("click",(()=>{const{name:e,about:t}=b.getUserInfo();c.value=e,_.value=t,C.open()}));const k=new o(l,".popup__form_type_new-card");k.enableValidation();const q=new o(l,".popup__form_type_profile");q.enableValidation()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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bUYsRUFBbUIsSUFBSXBILEVBQWMrRyxFQUFpQiw2QkFDNURLLEVBQWlCbkYsbUIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdJdGhDb25maXJtLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL0FwaS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2FyZCB7XHJcbiAgICBjb25zdHJ1Y3RvciggZGF0YSwgY2FyZFNlbGVjdG9yLCBoYW5kbGVDYXJkQ2xpY2ssIGhhbmRsZVRyYXNoQ2xpY2ssIGFwaSkge1xyXG4gICAgICB0aGlzLl90ZXh0ICAgICAgICAgICAgICA9IGRhdGEubmFtZTtcclxuICAgICAgdGhpcy5faW1nICAgICAgICAgICAgICA9IGRhdGEubGluaztcclxuICAgICAgdGhpcy5faWQgICAgICAgICAgICAgICAgPSBkYXRhLl9pZDtcclxuICAgICAgdGhpcy5fbGlrZXMgICAgICAgICAgICAgPSBkYXRhLmxpa2VzO1xyXG4gICAgICB0aGlzLl9DYXJkb3duZXIgICAgICAgICA9IGRhdGEub3duZXI7XHJcbiAgICAgIHRoaXMuX2NhcmRTZWxlY3RvciAgICAgID0gY2FyZFNlbGVjdG9yO1xyXG4gICAgICB0aGlzLl9oYW5kbGVDYXJkQ2xpY2sgICA9IGhhbmRsZUNhcmRDbGljaztcclxuICAgICAgdGhpcy5faGFuZGxlVHJhc2hDbGljayAgPSBoYW5kbGVUcmFzaENsaWNrO1xyXG4gICAgICB0aGlzLl9hZGRMaWtlICAgICAgICAgICA9IGFwaS5hZGRMaWtlO1xyXG4gICAgICB0aGlzLl9kZWxldGVMaWtlICAgICAgICA9IGFwaS5kZWxldGVMaWtlO1xyXG4gICAgICB0aGlzLl9kZWxldGVDYXJkICAgICAgICA9IGFwaS5kZWxldGVDYXJkO1xyXG4gICAgfVxyXG4gIFxyXG4gICAgX2dldFRlbXBsYXRlKCkge1xyXG4gICAgICBjb25zdCBjYXJkRWxlbWVudCA9IGRvY3VtZW50XHJcbiAgICAgICAgLnF1ZXJ5U2VsZWN0b3IodGhpcy5fY2FyZFNlbGVjdG9yKVxyXG4gICAgICAgIC5jb250ZW50XHJcbiAgICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuZ2FsbGVyeV9faXRlbVwiKVxyXG4gICAgICAgIC5jbG9uZU5vZGUodHJ1ZSk7XHJcbiAgXHJcbiAgICAgIHJldHVybiBjYXJkRWxlbWVudDtcclxuICAgIH1cclxuICBcclxuICAgIGdlbmVyYXRlQ2FyZCgpIHtcclxuICAgICAgdGhpcy5fZWxlbWVudCA9IHRoaXMuX2dldFRlbXBsYXRlKCk7XHJcbiAgICAgIGNvbnN0IGdhbGxlcnlJdGVtSW1nID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmdhbGxlcnlfX2l0ZW0taW1nXCIpO1xyXG4gICAgICBjb25zdCBnYWxsZXJ5SXRlbU5hbWUgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZ2FsbGVyeV9faXRlbS1uYW1lXCIpO1xyXG4gICAgICBjb25zdCBteUlkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19uYW1lXCIpLmlkO1xyXG5cclxuICAgICAgZ2FsbGVyeUl0ZW1JbWcuc3JjID0gdGhpcy5faW1nO1xyXG4gICAgICBnYWxsZXJ5SXRlbUltZy5hbHQgPSB0aGlzLl90ZXh0O1xyXG4gICAgICBnYWxsZXJ5SXRlbU5hbWUudGV4dENvbnRlbnQgPSB0aGlzLl90ZXh0O1xyXG4gXHJcbiAgICAgIHRoaXMuX2VsZW1lbnQuaWQgPSB0aGlzLl9pZDtcclxuICAgICAgdGhpcy5faW5pdExpa2UobXlJZCk7XHJcbiAgICAgIHRoaXMuIF9kZWxldGVJY29uVmlzaWJpbGl0eShteUlkKTtcclxuICAgICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgICAgcmV0dXJuIHRoaXMuX2VsZW1lbnQ7XHJcbiAgICB9XHJcbiAgXHJcbiAgICBfZGVsZXRlSWNvblZpc2liaWxpdHkodXNlcklkKXtcclxuICAgICAgaWYodXNlcklkICE9ICB0aGlzLl9DYXJkb3duZXIuX2lkKSB7XHJcbiAgICAgICAgdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmdhbGxlcnlfX2l0ZW0tdHJhc2gtYnRuXCIpLnN0eWxlLnZpc2liaWxpdHkgPSBcImhpZGRlblwiO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgX2luaXRMaWtlKHVzZXJJZCl7XHJcbiAgICAgIGlmKHRoaXMuX3VzZXJFeGlzdHModXNlcklkKSkge1xyXG4gICAgICAgIHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5nYWxsZXJ5X19saWtlLWJ0blwiKS5jbGFzc0xpc3QuYWRkKCdnYWxsZXJ5X19saWtlLWJ0bl9hY3RpdmUnKTsgXHJcbiAgICAgIH1cclxuICAgICAgY29uc3QgZ2FsbGVyeWxpa2VDb3VudCA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5nbGxlcnlfX2xpa2UtY291bnRcIik7XHJcbiAgICAgIGlmKHR5cGVvZiB0aGlzLl9saWtlcyAhPT0gXCJ1bmRlZmluZWRcIil7XHJcbiAgICAgICAgZ2FsbGVyeWxpa2VDb3VudC50ZXh0Q29udGVudCA9IHRoaXMuX2xpa2VzLmxlbmd0aDtcclxuICAgICAgfVxyXG4gICAgICBlbHNlIHtcclxuICAgICAgICBnYWxsZXJ5bGlrZUNvdW50LnRleHRDb250ZW50ICA9IDA7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBfdXNlckV4aXN0cyhpZCkge1xyXG4gICAgICBpZih0eXBlb2YgdGhpcy5fbGlrZXMgIT09IFwidW5kZWZpbmVkXCIpe1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9saWtlcy5zb21lKGZ1bmN0aW9uKHVzZXIpIHtcclxuICAgICAgICAgIHJldHVybiB1c2VyLl9pZCA9PT0gaWQ7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuXHJcbiAgICAgIHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5nYWxsZXJ5X19saWtlLWJ0blwiKS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgIHRoaXMuX2hhbmRsZUxpa2VCdG4pO1xyXG4gICAgICB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZ2FsbGVyeV9faXRlbS10cmFzaC1idG5cIikuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsdGhpcy5faGFuZGxlVHJhc2hDbGljayk7XHJcbiAgICAgIHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5nYWxsZXJ5X19pdGVtLWltZ1wiKS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5faGFuZGxlQ2FyZENsaWNrKTtcclxuICAgIH1cclxuICBcclxuICAgIF9oYW5kbGVMaWtlQnRuID0gKCkgPT4ge1xyXG4gICAgICBjb25zdCBsaWtlQnRuID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmdhbGxlcnlfX2xpa2UtYnRuXCIpO1xyXG4gICAgICBjb25zdCBnYWxsZXJ5bGlrZUNvdW50ID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmdsbGVyeV9fbGlrZS1jb3VudFwiKTtcclxuICAgICAgaWYobGlrZUJ0bi5jbGFzc0xpc3QuY29udGFpbnMoJ2dhbGxlcnlfX2xpa2UtYnRuX2FjdGl2ZScpKXtcclxuICAgICAgICB0aGlzLl9kZWxldGVMaWtlKHRoaXMuX2VsZW1lbnQuaWQpO1xyXG4gICAgICAgIGdhbGxlcnlsaWtlQ291bnQudGV4dENvbnRlbnQgLS07XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgdGhpcy5fYWRkTGlrZSh0aGlzLl9lbGVtZW50LmlkKTtcclxuICAgICAgICBnYWxsZXJ5bGlrZUNvdW50LnRleHRDb250ZW50ICsrO1xyXG4gICAgICB9XHJcbiAgICAgIHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5nYWxsZXJ5X19saWtlLWJ0blwiKS5jbGFzc0xpc3QudG9nZ2xlKCdnYWxsZXJ5X19saWtlLWJ0bl9hY3RpdmUnKTtcclxuXHJcbiAgICAgIFxyXG4gICAgICBcclxuICAgIH1cclxuICAgICAgIC8qXHJcbiAgICBfaGFuZGxlRGVsZXRlR2FsbGVyeUNhcmRJdGVtID0gKCkgPT4ge1xyXG4gICAgIFxyXG5cclxuICAgICAgdGhpcy5fZGVsZXRlQ2FyZCh0aGlzLl9lbGVtZW50LmlkKVxyXG4gICAgICAudGhlbigoKSA9PntcclxuICAgICAgICB0aGlzLl9lbGVtZW50LnJlbW92ZSgpO1xyXG4gICAgICAgIHRoaXMuX2VsZW1lbnQgPSBudWxsO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goZXJyID0+IHtcclxuICAgICAgICBhbGVydChlcnIpO1xyXG4gICAgICB9KVxyXG5cclxuICAgICAgXHJcbiAgICB9XHJcblxyXG4gICAgX2hhbmRsZURlbGV0ZSA9ICgpID0+IHtcclxuICAgICAgdGhpcy5fZGVsZXRlQ2FyZCh0aGlzLl9lbGVtZW50LmlkKVxyXG4gICAgICAudGhlbigoKSA9PntcclxuICAgICAgICB0aGlzLl9lbGVtZW50LnJlbW92ZSgpO1xyXG4gICAgICAgIHRoaXMuX2VsZW1lbnQgPSBudWxsO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goZXJyID0+IHtcclxuICAgICAgICBhbGVydChlcnIpO1xyXG4gICAgICB9KVxyXG4gICAgfVxyXG4gICAgICAgICovXHJcbiAgfSIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwIHtcclxuICAgIGNvbnN0cnVjdG9yICggcG9wdXBTZWxlY3RvciApIHtcclxuICAgICAgICB0aGlzLl9wb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XHJcbiAgICB9XHJcbiAgICBjbG9zZSgpIHtcclxuICAgICAgICB0aGlzLl9wb3B1cC5jbGFzc0xpc3QucmVtb3ZlKFwicG9wdXBfb3BlbmVkXCIpO1xyXG4gICAgICAgIC8qKiBwb3B1cHMgY2xvc2UgY2xpY2sgcmVtb3ZlIGV2ZW50cyAqL1xyXG4gICAgICAgIHRoaXMucmVtb3ZlRXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIH1cclxuXHJcbiAgICBvcGVuKCkge1xyXG4gICAgICAgIHRoaXMuX3BvcHVwLmNsYXNzTGlzdC5hZGQoXCJwb3B1cF9vcGVuZWRcIik7XHJcbiAgICAgICAgLyoqIHBvcHVwcyBvcGVuIGV2ZW50cyAqL1xyXG4gICAgICAgIHRoaXMuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIH1cclxuXHJcbiAgICBfaGFuZGxlRXNjQ2xvc2UgPSAoZXZ0KSA9PntcclxuICAgICAgICBpZiAoZXZ0LmtleSA9PT0gXCJFc2NhcGVcIikge1xyXG4gICAgICAgICAgICBjb25zdCBwb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfb3BlbmVkXCIpO1xyXG4gICAgICAgICAgICBpZihwb3B1cCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICAgICAgICB9ICAgXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIHRoaXMuX2hhbmRsZUNsaWNrQ2xvc2VQb3B1cCk7XHJcbiAgICB9XHJcblxyXG4gICAgcmVtb3ZlRXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsICB0aGlzLl9oYW5kbGVDbGlja0Nsb3NlUG9wdXApO1xyXG4gICAgfVxyXG5cclxuICAgIF9oYW5kbGVDbGlja0Nsb3NlUG9wdXAgPSAoZXZ0KSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcInBvcHVwX29wZW5lZFwiKSB8fFxyXG4gICAgICAgICAgICBldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcInBvcHVwX19jbG9zZVwiKSApIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcblxyXG59IiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEZvcm0gIGV4dGVuZHMgUG9wdXAge1xyXG4gICAgICAgIGNvbnN0cnVjdG9yICggcG9wdXBTZWxlY3RvciwgaGFuZGxlRm9ybVN1Ym1pdCApIHtcclxuICAgICAgICAgICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XHJcbiAgICAgICAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgID0gICBoYW5kbGVGb3JtU3VibWl0O1xyXG4gICAgICAgICAgICB0aGlzLl9mb3JtRWxlbWV0ICAgICAgICA9ICAgdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fZm9ybVwiKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIF9nZXRJbnB1dFZhbHVlcygpIHtcclxuICAgICAgICAgICAgY29uc3QgaW5wdXRWYWx1ZXMgPSB7fTtcclxuICAgICAgICAgICAgY29uc3QgaW5wdXRzQXJyID0gdGhpcy5fZm9ybUVsZW1ldC5xdWVyeVNlbGVjdG9yQWxsKFwiLnBvcHVwX19pbnB1dFwiKTtcclxuICAgICAgICAgICAgaW5wdXRzQXJyLmZvckVhY2goaW5wdXQgPT4ge1xyXG4gICAgICAgICAgICAgICAgaW5wdXRWYWx1ZXNbaW5wdXQubmFtZV0gPSBbaW5wdXQudmFsdWVdO1xyXG4gICAgICAgICAgICB9KVxyXG5cclxuICAgICAgICAgICAgcmV0dXJuIGlucHV0VmFsdWVzO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICAgICAgICAgIC8qKlxyXG4gICAgICAgICAgICAgKiBJdCBtb2RpZmllcyB0aGUgc2V0RXZlbnRMaXN0ZW5lcnMoKSBwYXJlbnQgbWV0aG9kLiBcclxuICAgICAgICAgICAgICogVGhlIHNldEV2ZW50TGlzdGVuZXJzKCkgbWV0aG9kIG9mIHRoZSBQb3B1cFdpdGhGb3JtIGNsYXNzXHJcbiAgICAgICAgICAgICAqICBoYXMgdG8gYWRkIHRoZSBzdWJtaXQgZXZlbnQgaGFuZGxlciB0byB0aGUgZm9ybSBhbmQgdGhlIGNsaWNrIFxyXG4gICAgICAgICAgICAgKiBldmVudCBsaXN0ZW5lciB0byB0aGUgY2xvc2UgaWNvbi5cclxuICAgICAgICAgICAgICovXHJcbiAgICAgICAgICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICAgICAgICAgIHRoaXMuX2Zvcm1FbGVtZXQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCB0aGlzLl9oYW5kbGVTdWJtaXQpOyBcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJlbW92ZUV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgICAgICAgICB0aGlzLl9mb3JtRWxlbWV0LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgdGhpcy5faGFuZGxlU3VibWl0KTsgXHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIF9oYW5kbGVTdWJtaXQgPShldnQpID0+e1xyXG4gICAgICAgICAgICBldnQucHJldmVudERlZmF1bHQoKTsgXHJcbiAgICAgICAgICAgIGNvbnN0IGlucHV0cyA9ICB0aGlzLl9nZXRJbnB1dFZhbHVlcygpO1xyXG4gICAgICAgICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KGlucHV0cyk7XHJcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgY2xvc2UoKSB7XHJcbiAgICAgICAgICAgIC8qKlxyXG4gICAgICAgICAgICAgKiBJdCBtb2RpZmllcyB0aGUgY2xvc2UoKSBwYXJlbnQgbWV0aG9kIFxyXG4gICAgICAgICAgICAgKiBpbiBvcmRlciB0byByZXNldCB0aGUgZm9ybSBvbmNlIHRoZSBwb3B1cCBpcyBjbG9zZWQuXHJcbiAgICAgICAgICAgICAqL1xyXG4gICAgICAgICAgICBzdXBlci5jbG9zZSgpO1xyXG4gICAgICAgICAgICB0aGlzLl9mb3JtRWxlbWV0LnJlc2V0KCk7XHJcbiAgICAgICAgICAgIHRoaXMucmVtb3ZlRXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgICAgICB9XHJcblxyXG59IiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwe1xyXG4gICAgY29uc3RydWN0b3IgKCB7c3JjICx0aXRsZSB9ICxwb3B1cFNlbGVjdG9yICkge1xyXG4gICAgICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgICAgIHRoaXMuX3NyYyAgID0gc3JjO1xyXG4gICAgICAgIHRoaXMuX3RpdGxlID0gdGl0bGU7XHJcbiAgICB9XHJcblxyXG4gICAgb3BlbigpIHtcclxuICAgICAgICBzdXBlci5vcGVuKCk7XHJcbiAgICAgICAgdGhpcy5fcG9wdXBJbWcgPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19pbWdcIik7XHJcbiAgICAgICAgdGhpcy5fcG9wdXBUaXRsZSA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2ltZy10aXRsZVwiKTtcclxuXHJcbiAgICAgICAgdGhpcy5fcG9wdXBJbWcuc3JjID0gIHRoaXMuX3NyYztcclxuICAgICAgICB0aGlzLl9wb3B1cEltZy5hbHQgPSAgdGhpcy5fdGl0bGU7XHJcbiAgICAgICAgdGhpcy5fcG9wdXBUaXRsZS50ZXh0Q29udGVudCA9IGBQaG90byBvZiAke3RoaXMuX3RpdGxlfWA7XHJcbiAgICB9XHJcbn0iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV0l0aENvbmZpcm0gIGV4dGVuZHMgUG9wdXAge1xyXG4gICAgICAgIGNvbnN0cnVjdG9yICggcG9wdXBTZWxlY3RvciwgaGFuZGxlQ29uZmlybSApIHtcclxuICAgICAgICAgICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XHJcbiAgICAgICAgICAgIHRoaXMuX2hhbmRsZUNvbmZpcm0gICAgID0gICBoYW5kbGVDb25maXJtO1xyXG4gICAgICAgICAgICB0aGlzLl9mb3JtRWxlbWV0ICAgICAgICA9ICAgdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fZm9ybVwiKTtcclxuICAgICAgICB9XHJcblxyXG5cclxuICAgICAgICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgICAgICAgICAgLyoqXHJcbiAgICAgICAgICAgICAqIEl0IG1vZGlmaWVzIHRoZSBzZXRFdmVudExpc3RlbmVycygpIHBhcmVudCBtZXRob2QuIFxyXG4gICAgICAgICAgICAgKiAgaGFzIHRvIGFkZCB0aGUgc3VibWl0IGV2ZW50IGhhbmRsZXIgdG8gdGhlIGZvcm0gYW5kIHRoZSBjbGljayBcclxuICAgICAgICAgICAgICogZXZlbnQgbGlzdGVuZXIgdG8gdGhlIGNsb3NlIGljb24uXHJcbiAgICAgICAgICAgICAqL1xyXG4gICAgICAgICAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgICAgICAgICB0aGlzLl9mb3JtRWxlbWV0LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgIHRoaXMuX2hhbmRsZVN1Ym1pdCk7IFxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmVtb3ZlRXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2Zvcm1FbGVtZXQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCB0aGlzLl9oYW5kbGVTdWJtaXQpOyBcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgX2hhbmRsZVN1Ym1pdCA9KGV2dCkgPT57XHJcbiAgICAgICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpOyBcclxuICAgICAgICAgICAgdGhpcy5faGFuZGxlQ29uZmlybSh0aGlzLl9wb3B1cC5pZCk7XHJcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIG9wZW4oaWQpIHtcclxuICAgICAgICAgICAgc3VwZXIub3BlbigpO1xyXG4gICAgICAgICAgICB0aGlzLl9wb3B1cC5pZCA9aWQ7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjbG9zZSgpIHtcclxuICAgICAgICAgICAgLyoqXHJcbiAgICAgICAgICAgICAqIEl0IG1vZGlmaWVzIHRoZSBjbG9zZSgpIHBhcmVudCBtZXRob2QgXHJcbiAgICAgICAgICAgICAqIGluIG9yZGVyIHRvIHJlc2V0IHRoZSBmb3JtIG9uY2UgdGhlIHBvcHVwIGlzIGNsb3NlZC5cclxuICAgICAgICAgICAgICovXHJcbiAgICAgICAgICAgIHN1cGVyLmNsb3NlKCk7XHJcbiAgICAgICAgICAgIHRoaXMuX2Zvcm1FbGVtZXQucmVzZXQoKTtcclxuICAgICAgICAgICAgdGhpcy5yZW1vdmVFdmVudExpc3RlbmVycygpO1xyXG4gICAgICAgIH1cclxuXHJcbn0iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBGb3JtVmFsaWRhdG9yIHtcclxuICAgIGNvbnN0cnVjdG9yKCBjb25maWcsIGZvcm1FbCApe1xyXG4gICAgICB0aGlzLl9mb3JtU2VsZWN0b3IgICAgICAgICA9IGNvbmZpZy5mb3JtU2VsZWN0b3I7XHJcbiAgICAgIHRoaXMuX2Zvcm1JbnB1dHNGaWVsZFNldCAgID0gY29uZmlnLmZvcm1JbnB1dHNGaWVsZFNldDtcclxuICAgICAgdGhpcy5faW5wdXRTZWxlY3RvciAgICAgICAgPSBjb25maWcuaW5wdXRTZWxlY3RvcjtcclxuICAgICAgdGhpcy5fc3VibWl0QnRuU2VsZWN0b3IgICAgPSBjb25maWcuc3VibWl0QnRuU2VsZWN0b3I7XHJcbiAgICAgIHRoaXMuX2luYWN0aXZlQnRuQ2xhc3MgICAgID0gY29uZmlnLmluYWN0aXZlQnRuQ2xhc3M7XHJcbiAgICAgIHRoaXMuX2lucHV0RXJyQ2xhc3MgICAgICAgID0gY29uZmlnLmlucHV0RXJyQ2xhc3M7XHJcbiAgICAgIHRoaXMuX2lucHV0RXJyQWN0aXZlQ2xhc3MgID0gY29uZmlnLmlucHV0RXJyQWN0aXZlQ2xhc3M7XHJcbiAgICAgIHRoaXMuX2Zvcm1FbCAgICAgICAgICAgICAgID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihmb3JtRWwpO1xyXG4gICAgfVxyXG5cclxuICAgIF9zaG93SW5wdXRFcnIgKGlucHV0RWwpIHtcclxuICAgICAgY29uc3QgZXJyRWwgPSB0aGlzLl9mb3JtRWwucXVlcnlTZWxlY3RvcihgLiR7aW5wdXRFbC5pZH0tZXJyb3JgKTtcclxuICAgICAgXHJcbiAgICAgIGlucHV0RWwuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbnB1dEVyckNsYXNzKTtcclxuICAgICAgZXJyRWwudGV4dENvbnRlbnQgPSBpbnB1dEVsLnZhbGlkYXRpb25NZXNzYWdlO1xyXG4gICAgICBlcnJFbC5jbGFzc0xpc3QuYWRkKHRoaXMuX2lucHV0RXJyQWN0aXZlQ2xhc3MpO1xyXG4gICAgfVxyXG5cclxuICAgIF9oaWRlSW5wdXRFcnJvciAoaW5wdXRFbCkge1xyXG4gICAgICBjb25zdCBlcnJFbCA9IHRoaXMuX2Zvcm1FbC5xdWVyeVNlbGVjdG9yKGAuJHtpbnB1dEVsLmlkfS1lcnJvcmApO1xyXG5cclxuICAgICAgaW5wdXRFbC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2lucHV0RXJyQ2xhc3MpO1xyXG4gICAgICBlcnJFbC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2lucHV0RXJyQWN0aXZlQ2xhc3MpO1xyXG4gICAgICBlcnJFbC50ZXh0Q29udGVudCA9IFwiXCI7XHJcbiAgICB9XHJcblxyXG4gICAgX2NoZWNrSW5wdXRWYWxpZGl0eSAoaW5wdXRFbCkge1xyXG4gICAgICBpZiAoIWlucHV0RWwudmFsaWRpdHkudmFsaWQpIHtcclxuICAgICAgICB0aGlzLl9zaG93SW5wdXRFcnIoaW5wdXRFbCk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbCk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBfaGFzSW52YWxpZElucHV0IChpbnB1dExzdCkge1xyXG4gICAgICByZXR1cm4gaW5wdXRMc3Quc29tZSgoaW5wdXRFbCkgPT4gIWlucHV0RWwudmFsaWRpdHkudmFsaWQpO1xyXG4gICAgfVxyXG5cclxuICAgIHRvZ2dsZUJ1dHRvblN0YXRlICgpIHtcclxuICAgICAgY29uc3QgaW5wdXRMc3QgPSBBcnJheS5mcm9tKHRoaXMuX2Zvcm1FbC5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX2lucHV0U2VsZWN0b3IpKTtcclxuICAgICAgY29uc3QgYnRuRWwgPSB0aGlzLl9mb3JtRWwucXVlcnlTZWxlY3Rvcih0aGlzLl9zdWJtaXRCdG5TZWxlY3Rvcik7XHJcbiAgICAgIGlmICh0aGlzLl9oYXNJbnZhbGlkSW5wdXQoaW5wdXRMc3QpKSB7XHJcbiAgICAgICAgYnRuRWwuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbmFjdGl2ZUJ0bkNsYXNzKTtcclxuICAgICAgICBidG5FbC5kaXNhYmxlZCA9IHRydWU7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgYnRuRWwuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ0bkNsYXNzKTtcclxuICAgICAgICBidG5FbC5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgX3NldEV2ZW50TGlzdGVuZXJzICgpIHtcclxuICAgICAgY29uc3QgaW5wdXRMc3QgPSBBcnJheS5mcm9tKHRoaXMuX2Zvcm1FbC5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX2lucHV0U2VsZWN0b3IpKTtcclxuICAgICAgY29uc3QgYnRuRWwgPSB0aGlzLl9mb3JtRWwucXVlcnlTZWxlY3Rvcih0aGlzLl9zdWJtaXRCdG5TZWxlY3Rvcik7XHJcbiAgICAgIHRoaXMudG9nZ2xlQnV0dG9uU3RhdGUoaW5wdXRMc3QsIGJ0bkVsKTtcclxuICAgICAgaW5wdXRMc3QuZm9yRWFjaCgoaW5wdXRFbCkgPT4ge1xyXG4gICAgICAgIGlucHV0RWwuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHsgICBcclxuICAgICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsKTtcclxuICAgICAgICAgIHRoaXMudG9nZ2xlQnV0dG9uU3RhdGUoaW5wdXRMc3QsIGJ0bkVsKTtcclxuICAgICAgICB9KTtcclxuICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgZW5hYmxlVmFsaWRhdGlvbiAoKSB7XHJcbiAgICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICAgIHRoaXMuX2Zvcm1FbC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IGV2dC5wcmV2ZW50RGVmYXVsdCgpKTtcclxuICAgIH1cclxuXHJcbiAgfSIsImV4cG9ydCBjb25zdCBjb25maWcgPSB7XHJcbiAgICBmb3JtU2VsZWN0b3I6IFwiLnBvcHVwX19mb3JtXCIsXHJcbiAgICBmb3JtSW5wdXRzRmllbGRTZXQ6IFwiLnBvcHVwX19mb3JtLXNldFwiLFxyXG4gICAgaW5wdXRTZWxlY3RvcjogXCIucG9wdXBfX2lucHV0XCIsXHJcbiAgICBzdWJtaXRCdG5TZWxlY3RvcjogXCIucG9wdXBfX3N1Ym1pdC1idG5cIixcclxuICAgIGluYWN0aXZlQnRuQ2xhc3M6IFwiYnV0dG9uX2luYWN0aXZlXCIsXHJcbiAgICBpbnB1dEVyckNsYXNzOiBcInBvcHVwX19pbnB1dC10ZXh0X3R5cGVfZXJyb3JcIixcclxuICAgIGlucHV0RXJyQWN0aXZlQ2xhc3M6IFwicG9wdXBfX2lucHV0LXRleHQtZXJyb3JfYWN0aXZlXCJcclxuICB9XHJcblxyXG5cclxuLyoqIHByb2ZpbGUgcG9wdXAgZWxlbWVudHMgKi9cclxuY29uc3QgcHJvZmlsZUZvcm0gICAgICAgICAgICAgICAgICA9IGRvY3VtZW50LmZvcm1zLnByb2ZpbGVmb3JtO1xyXG5leHBvcnQgY29uc3QgaW5wdXROYW1lICAgICAgICAgICAgID0gcHJvZmlsZUZvcm0uZWxlbWVudHMucHJvZmlsZU5hbWU7XHJcbmV4cG9ydCBjb25zdCBpbnB1dEFib3V0TWUgICAgICAgICAgPSBwcm9maWxlRm9ybS5lbGVtZW50cy5wcm9maWxlQWJvdXRNZTtcclxuZXhwb3J0IGNvbnN0IHBsYWNlRm9ybSAgICAgICAgICAgICA9IGRvY3VtZW50LmZvcm1zLnBsYWNlZm9ybTtcclxuXHJcbmV4cG9ydCBjb25zdCBnYWxsZXJ5TGlzdFNlbGVjdG9yICA9IFwiLmdhbGxlcnlfX2xpc3RcIjtcclxuXHJcbiIsImltcG9ydCBcIi4vaW5kZXguY3NzXCI7XHJcbmltcG9ydCBTZWN0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL1NlY3Rpb24uanNcIjtcclxuaW1wb3J0IENhcmQgZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZC5qc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoRm9ybSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhJbWFnZSBmcm9tICBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcclxuaW1wb3J0IFBvcHVwV0l0aENvbmZpcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXSXRoQ29uZmlybS5qc1wiO1xyXG5pbXBvcnQgVXNlckluZm8gZnJvbSBcIi4uL2NvbXBvbmVudHMvVXNlckluZm8uanNcIjtcclxuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xyXG5pbXBvcnQgKiBhcyBjb25zdGFudHMgZnJvbSBcIi4uL3V0aWxzL2NvbnN0YW50cy5qc1wiO1xyXG5pbXBvcnQgQXBpIGZyb20gXCIuLi9jb21wb25lbnRzL0FwaS5qc1wiXHJcbi8qKiBtYWluIGJ1dHRvbnMgKi9cclxuY29uc3QgcHJvZmlsZUVkaXRCdG4gICAgICAgID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcImJ1dHRvbi5wcm9maWxlX19lZGl0LWJ0blwiKTtcclxuY29uc3Qgb3BlTmV3Q2FyZFBvcHVwQnRuICAgID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcImJ1dHRvbi5wcm9maWxlX19hZGQtYnRuXCIpO1xyXG5cclxuLyoqIHByb2ZpbGUgZGF0YSBlbGVtZW50cyAqL1xyXG5jb25zdCBwcm9maWxlTmFtZSAgICAgICAgICAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX25hbWVcIik7XHJcbmNvbnN0IHByb2ZpbGVBYm91dE1lICAgICAgICA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYWJvdXQtbWVcIik7XHJcbmNvbnN0IHByb2ZpbGVBdmF0YXIgICAgICAgICA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYXZhdGFyXCIpO1xyXG4vKiogZ2FsbGVyeSBjb250YWluZXIgKi9cclxuY29uc3QgY29udGFpbmVyICAgICAgICAgICAgID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5nYWxsZXJ5XCIpO1xyXG5cclxuXHJcbmNvbnN0IGluaXRDYXJkcyA9IG5ldyBBcnJheSgpO1xyXG5cclxuY29uc3QgYXBpID0gbmV3IEFwaSh7XHJcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC5ub21vcmVwYXJ0aWVzLmNvL3YxL2dyb3VwLTEyXCIsXHJcbiAgaGVhZGVyczoge1xyXG4gICAgYXV0aG9yaXphdGlvbjogXCI5YjYyMWYwZi01ZGZlLTQzZjEtOTVmZC1lOWNjMTg4YmNjMzVcIixcclxuICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiXHJcbiAgfVxyXG59KTtcclxuXHJcbi8qKlxyXG4gKiBpbml0aWFhbCB1c2VyIGluZm8gYW5kIGdhbGxlcnkgQ2FyZHMgZnJvbVxyXG4gKi9cclxuYXBpLmluaXQoKVxyXG4udGhlbigoW3VzZXIsY2FyZHNdKSA9PiB7XHJcbiAgdXNlckluZm8uc2V0VXNlckluZm8odXNlcik7XHJcbiAgdXNlckluZm8uc2V0VXNlckF2YXRhcih7YXZhdGFyOiB1c2VyLmF2YXRhcixuYW1lOiB1c2VyLm5hbWV9KTtcclxuICBjYXJkcy5mb3JFYWNoKChjYXJkKSA9PiB7aW5pdENhcmRzLnB1c2goY2FyZCk7fSlcclxuICBjYXJkTGlzdC5yZW5kZXJlcigpO1xyXG59KVxyXG4uY2F0Y2ggKChlcnIpID0+IHtcclxuICBoYW5kbGVFcnJvcihlcnIpO1xyXG59KVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlRXJyb3IoZXJyKSB7XHJcbiAgY29uc3QgZXJyb3JFbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fZXJyb3JcIik7XHJcbiAgZXJyb3JFbC50ZXh0Q29udGVudCA9IGVycjtcclxuICBlcnJvckVsLnN0eWxlLmRpc3BsYXkgID0gXCJibG9ja1wiO1xyXG59XHJcbmNvbnN0IGNhcmRMaXN0ICA9IG5ldyBTZWN0aW9uKHtkYXRhOiBpbml0Q2FyZHMsIHJlbmRlcmVyOiBhZGRHYWxsZXJ5Q2FyZEl0ZW19LCBjb25zdGFudHMuZ2FsbGVyeUxpc3RTZWxlY3Rvcik7XHJcbmNvbnN0IHVzZXJJbmZvICA9IG5ldyBVc2VySW5mbyhcIi5wcm9maWxlX19uYW1lXCIsIFwiLnByb2ZpbGVfX2Fib3V0LW1lXCIsIFwiLnByb2ZpbGVfX2F2YXRhclwiKTtcclxuXHJcbmZ1bmN0aW9uICBhZGRHYWxsZXJ5Q2FyZEl0ZW0gKGl0ZW0pIHtcclxuICBjb25zdCBjYXJkID0gbmV3IENhcmQoaXRlbSwgXHJcbiAgICBcIiNnYWxsZXJ5LWl0ZW0tdGVtcGxhdGVcIixcclxuICAgICgpID0+IHtcclxuICAgICAgY29uc3QgcG9wdXAgPSBuZXcgUG9wdXBXaXRoSW1hZ2Uoe3NyYyA6IGl0ZW0ubGluayAsIHRpdGxlOiBpdGVtLm5hbWV9LCBcIi5wb3B1cF90eXBlX2ltZ1wiKTtcclxuICAgICAgcG9wdXAub3BlbigpO1xyXG4gICAgfSxcclxuICAgICgpID0+IHtcclxuICAgICAgY29uc3QgcG9wdXBDb25maXJtID0gbmV3IFBvcHVwV0l0aENvbmZpcm0oXCIucG9wdXBfdHlwZV9kZWxldGVcIiwgaGFuZGxlRGVsZXRlKTtcclxuICAgICAgcG9wdXBDb25maXJtLm9wZW4oaXRlbS5faWQpO1xyXG4gICAgfSxhcGkpO1xyXG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gY2FyZC5nZW5lcmF0ZUNhcmQoKTtcclxuICBjYXJkTGlzdC5hZGRJdGVtKGNhcmRFbGVtZW50KTtcclxufVxyXG4vKipcclxuICogYWRkIHBvcHVwIHdpdGggZm9ybSB0byBhZGQgbmV3IGNhcmQgaXRlbSB0byBnYWxsZXJ5XHJcbiAqL1xyXG5jb25zdCBuZXdDYXJkUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybSAoXHJcbiAgXCIucG9wdXBfdHlwZV9uZXctY2FyZFwiLFxyXG4gIGhhbmRsZUNyZWF0ZU5ld0NhcmRcclxuKTtcclxuXHJcbmZ1bmN0aW9uIGhhbmRsZURlbGV0ZShpdGVtSWQpIHtcclxuICBhcGkuZGVsZXRlQ2FyZChpdGVtSWQpXHJcbiAgLnRoZW4oKCkgPT57XHJcbiAgICBsZXQgaXRlbSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZ2FsbGVyeV9faXRlbVwiKTtcclxuICAgIGl0ZW0ucmVtb3ZlKCk7XHJcbiAgICBpdGVtID0gbnVsbDtcclxuICB9KVxyXG4gIC5jYXRjaChlcnIgPT4ge1xyXG4gICAgYWxlcnQoZXJyKTtcclxuICB9KVxyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVDcmVhdGVOZXdDYXJkIChpbnB1dHMpIHtcclxuICBhZGRHYWxsZXJ5Q2FyZEl0ZW0oe2xpbms6IGlucHV0cy5wbGFjZUltYWdlTGluaywgbmFtZTogaW5wdXRzLnBsYWNlTmFtZSwgb3duZXI6IHtfaWQ6IHByb2ZpbGVOYW1lLmlkfX0pO1xyXG4gIGFwaS5jcmVhdGVOZXdDYXJkKGlucHV0cy5wbGFjZUltYWdlTGluayxpbnB1dHMucGxhY2VOYW1lKVxyXG4gIC50aGVuKGRhdGEgPT4ge1xyXG4gICAgY29uc29sZS5sb2coZGF0YSlcclxuICB9KVxyXG4gIC5jYXRjaCAoKGVycikgPT4ge1xyXG4gICAgaGFuZGxlRXJyb3IoZXJyKTtcclxuICB9KVxyXG4gIGNvbnN0YW50cy5wbGFjZUZvcm0ucmVzZXQoKTtcclxuICBuZXdDYXJkUG9wdXAuY2xvc2UoKTtcclxuICBuZXdDYXJkVmFsaWRhdG9yLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbn1cclxuXHJcbm9wZU5ld0NhcmRQb3B1cEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gbmV3Q2FyZFBvcHVwLm9wZW4oKSk7XHJcblxyXG4vKipcclxuICogYWRkIHBvcHVwIHdpdGggZm9ybSB0byBlZGl0IG1haW4gdXNlciBpbmZvXHJcbiAqL1xyXG5jb25zdCBwcm9maWxlUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybSAoXHJcbiAgXCIucG9wdXBfdHlwZV9wcm9maWxlXCIsXHJcbiAgIGhhbmRsZVByb2ZpbGVGb3JtU3VibWl0XHJcbik7XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVQcm9maWxlRm9ybVN1Ym1pdCAoaW5wdXRzKSB7XHJcbiAgdXNlckluZm8uc2V0VXNlckluZm8oe25hbWU6IGlucHV0cy5wcm9maWxlTmFtZSwgYWJvdXQ6IGlucHV0cy5wcm9maWxlQWJvdXRNZX0pXHJcbiAgYXBpLmVkaXRQcm9maWxlKHtuYW1lOiBpbnB1dHMucHJvZmlsZU5hbWUsIGFib3V0OiBpbnB1dHMucHJvZmlsZUFib3V0TWV9KVxyXG4gIC5jYXRjaCAoKGVycikgPT4ge1xyXG4gICAgY29uc29sZS5sb2coZXJyKTtcclxuICB9KVxyXG5cclxuICBwcm9maWxlVmFsaWRhdG9yLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbn1cclxuXHJcbnByb2ZpbGVFZGl0QnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgY29uc3Qge25hbWUsIGFib3V0IH0gPSB1c2VySW5mby5nZXRVc2VySW5mbygpO1xyXG4gIGNvbnN0YW50cy5pbnB1dE5hbWUudmFsdWUgID0gbmFtZTtcclxuICBjb25zdGFudHMuaW5wdXRBYm91dE1lLnZhbHVlICA9IGFib3V0O1xyXG4gIHByb2ZpbGVQb3B1cC5vcGVuKCk7XHJcbn0pO1xyXG5cclxuXHJcbi8qKlxyXG4gKiBhZGQgZm9ybSB2YWxpZGF0aW9uIGZvciBhbGwgZm9ybXNcclxuICovXHJcbmNvbnN0IG5ld0NhcmRWYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihjb25zdGFudHMuY29uZmlnLFwiLnBvcHVwX19mb3JtX3R5cGVfbmV3LWNhcmRcIik7XHJcbm5ld0NhcmRWYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5cclxuY29uc3QgcHJvZmlsZVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKGNvbnN0YW50cy5jb25maWcsXCIucG9wdXBfX2Zvcm1fdHlwZV9wcm9maWxlXCIpO1xyXG5wcm9maWxlVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEFwaSB7XHJcbiAgICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7XHJcbiAgICAgIHRoaXMuX29wdGlvbnMgPSBvcHRpb25zO1xyXG5cclxuICAgIH1cclxuICBcclxuICAgIF9jYWxsKGFjdGlvbiwgbWV0aG9kLCBkYXRhKSB7XHJcbiAgICAgIHJldHVybiBmZXRjaCh0aGlzLl9vcHRpb25zLmJhc2VVcmwgKyBhY3Rpb24sIHtcclxuICAgICAgICBtZXRob2Q6IG1ldGhvZCxcclxuICAgICAgICBoZWFkZXJzOiAgdGhpcy5fb3B0aW9ucy5oZWFkZXJzLFxyXG4gICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KGRhdGEpLFxyXG4gICAgICB9KVxyXG4gICAgICAudGhlbihyZXMgPT4ge1xyXG4gICAgICAgIGlmKHJlcy5vaykge1xyXG4gICAgICAgICAgcmV0dXJuICByZXMuanNvbigpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QocmVzLnN0YXR1cyk7XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgZ2V0SW5pdGlhbENhcmRzID0gKCkgPT4ge1xyXG4gICAgICByZXR1cm4gdGhpcy5fY2FsbChcIi9jYXJkc1wiLCdHRVQnKTtcclxuICAgIH1cclxuICBcclxuICAgIGdldFVzZXJEYXRhID0gKCkgPT4ge1xyXG4gICAgICByZXR1cm4gdGhpcy5fY2FsbChcIi91c2Vycy9tZVwiLCdHRVQnKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgZWRpdFByb2ZpbGUoe25hbWUsIGFib3V0fSkge1xyXG4gICAgICByZXR1cm4gdGhpcy5fY2FsbChcIi91c2Vycy9tZVwiLCdQQVRDSCcse1xyXG4gICAgICAgIG5hbWU6IG5hbWVbMF0sXHJcbiAgICAgICAgYWJvdXQ6IGFib3V0WzBdXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGNyZWF0ZU5ld0NhcmQgKGxpbmssIG5hbWUpIHtcclxuICAgICAgcmV0dXJuIHRoaXMuX2NhbGwoXCIvY2FyZHNcIiwnUE9TVCcse1xyXG4gICAgICAgIG5hbWU6IG5hbWVbMF0sXHJcbiAgICAgICAgbGluazogbGlua1swXVxyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBhZGRMaWtlID0gKGNhcmRJZCkgPT4ge1xyXG4gICAgICByZXR1cm4gdGhpcy5fY2FsbChgL2NhcmRzL2xpa2VzLyR7Y2FyZElkfWAsJ1BVVCcpO1xyXG4gICAgfVxyXG5cclxuICAgIGRlbGV0ZUxpa2UgPSAoY2FyZElkKSA9PiB7XHJcbiAgICAgIHJldHVybiB0aGlzLl9jYWxsKGAvY2FyZHMvbGlrZXMvJHtjYXJkSWR9YCwnREVMRVRFJyk7XHJcbiAgICB9XHJcblxyXG4gICAgZGVsZXRlQ2FyZCA9IChjYXJkSWQpID0+IHtcclxuICAgICAgcmV0dXJuIHRoaXMuX2NhbGwoYC9jYXJkcy8ke2NhcmRJZH1gLCdERUxFVEUnKTtcclxuICAgIH1cclxuXHJcbiAgICBpbml0KCkge1xyXG4gICAgICByZXR1cm4gUHJvbWlzZS5hbGwoW3RoaXMuZ2V0VXNlckRhdGEoKSwgdGhpcy5nZXRJbml0aWFsQ2FyZHMoKV0pO1xyXG4gICAgfVxyXG5cclxuICB9XHJcbiAgXHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xyXG4gICAgY29uc3RydWN0b3IoIHsgZGF0YSwgcmVuZGVyZXIgfSwgY29udGFpbmVyU2VsZWN0b3IgKSB7XHJcbiAgICAgICAgdGhpcy5faXRlbXMgICAgICAgPSBkYXRhLFxyXG4gICAgICAgIHRoaXMuX3JlbmRlcmVyICAgID0gcmVuZGVyZXI7XHJcbiAgICAgICAgdGhpcy5fY29udGFpbmVyICAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNvbnRhaW5lclNlbGVjdG9yKTtcclxuICAgIH1cclxuXHJcbiAgICBhZGRJdGVtKGVsZW1lbnQpIHtcclxuICAgICAgICB0aGlzLl9jb250YWluZXIuYXBwZW5kKGVsZW1lbnQpO1xyXG4gICAgICB9XHJcbiAgICBcclxuICAgICAgcmVuZGVyZXIoKSB7XHJcbiAgICAgICAgdGhpcy5faXRlbXMuZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgICAgIHRoaXMuX3JlbmRlcmVyKGl0ZW0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcblxyXG59IiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXNlckluZm8ge1xyXG4gICAgLyoqXHJcbiAgICAgKiBUaGUgVXNlckluZm8gY2xhc3MgaXMgcmVzcG9uc2libGUgZm9yIHJlbmRlcmluZyBcclxuICAgICAqIGluZm9ybWF0aW9uIGFib3V0IHRoZSB1c2VyIG9uIHRoZSBwYWdlLiBUaGlzIGNsYXNzIHNob3VsZDpcclxuICAgICAqIC1UYWtlIGFuIG9iamVjdCB3aXRoIHRoZSBzZWxlY3RvcnMgb2YgdHdvIGVsZW1lbnRzIGludG8gdGhlIGNvbnN0cnVjdG9yOiBcclxuICAgICAqIG9uZSBjb250YWluaW5nIHRoZSB1c2VyJ3MgbmFtZSwgYW5kIGFub3RoZXIgY29udGFpbmluZyB0aGUgdXNlcidzIGpvYi5cclxuICAgICAqL1xyXG4gICAgY29uc3RydWN0b3IgKCBuYW1lU2VsZWN0b3IsIGpvYlNlbGVjdG9yLCBhdmF0YXJTZWxlY3RvciA9IG51bGwpIHtcclxuICAgICAgICB0aGlzLl9uYW1lRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IobmFtZVNlbGVjdG9yKTtcclxuICAgICAgICB0aGlzLl9qb2JFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihqb2JTZWxlY3Rvcik7XHJcbiAgICAgICAgdGhpcy5fYXZhdGFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihhdmF0YXJTZWxlY3Rvcik7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogcmV0dXJucyBhbiBvYmplY3Qgd2l0aCBpbmZvcm1hdGlvbiBhYm91dCB0aGUgdXNlci4gXHJcbiAgICAgICAgICogVGhpcyBtZXRob2Qgd2lsbCBiZSBoYW5keSBmb3IgXHJcbiAgICAgICAgICogY2FzZXMgd2hlbiBpdCdzIG5lY2Vzc2FyeSB0byBkaXNwbGF5IHRoZSB1c2VyIGRhdGEgaW4gdGhlIG9wZW4gZm9ybS5cclxuICAgICAgICAgKi9cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBuYW1lOiB0aGlzLl9uYW1lRWxlbWVudC50ZXh0Q29udGVudCxcclxuICAgICAgICAgICAgYWJvdXQ6IHRoaXMuX2pvYkVsZW1lbnQudGV4dENvbnRlbnRcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgc2V0VXNlckluZm8oZGF0YSl7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogdGFrZXMgbmV3IHVzZXIgZGF0YSBhbmQgYWRkcyBpdCBvbiB0aGUgcGFnZS5cclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLl9uYW1lRWxlbWVudC50ZXh0Q29udGVudCAgID0gZGF0YS5uYW1lO1xyXG4gICAgICAgIHRoaXMuX25hbWVFbGVtZW50LmlkICAgICAgICAgICAgPSBkYXRhLl9pZDtcclxuICAgICAgICB0aGlzLl9qb2JFbGVtZW50LnRleHRDb250ZW50ICAgID0gZGF0YS5hYm91dDtcclxuXHJcbiAgICB9XHJcbiAgICBzZXRVc2VyQXZhdGFyKHthdmF0YXIsIG5hbWV9KSB7XHJcbiAgICAgICAgdGhpcy5fYXZhdGFyLnNyYyA9IGF2YXRhcjtcclxuICAgICAgICB0aGlzLl9hdmF0YXIuYWx0ID0gbmFtZTtcclxuICAgIH1cclxufSJdLCJuYW1lcyI6WyJDYXJkIiwiY29uc3RydWN0b3IiLCJkYXRhIiwiY2FyZFNlbGVjdG9yIiwiaGFuZGxlQ2FyZENsaWNrIiwiaGFuZGxlVHJhc2hDbGljayIsImFwaSIsImxpa2VCdG4iLCJ0aGlzIiwiX2VsZW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiZ2FsbGVyeWxpa2VDb3VudCIsImNsYXNzTGlzdCIsImNvbnRhaW5zIiwiX2RlbGV0ZUxpa2UiLCJpZCIsInRleHRDb250ZW50IiwiX2FkZExpa2UiLCJ0b2dnbGUiLCJfdGV4dCIsIm5hbWUiLCJfaW1nIiwibGluayIsIl9pZCIsIl9saWtlcyIsImxpa2VzIiwiX0NhcmRvd25lciIsIm93bmVyIiwiX2NhcmRTZWxlY3RvciIsIl9oYW5kbGVDYXJkQ2xpY2siLCJfaGFuZGxlVHJhc2hDbGljayIsImFkZExpa2UiLCJkZWxldGVMaWtlIiwiX2RlbGV0ZUNhcmQiLCJkZWxldGVDYXJkIiwiX2dldFRlbXBsYXRlIiwiZG9jdW1lbnQiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiZ2VuZXJhdGVDYXJkIiwiZ2FsbGVyeUl0ZW1JbWciLCJnYWxsZXJ5SXRlbU5hbWUiLCJteUlkIiwic3JjIiwiYWx0IiwiX2luaXRMaWtlIiwiX2RlbGV0ZUljb25WaXNpYmlsaXR5IiwiX3NldEV2ZW50TGlzdGVuZXJzIiwidXNlcklkIiwic3R5bGUiLCJ2aXNpYmlsaXR5IiwiX3VzZXJFeGlzdHMiLCJhZGQiLCJsZW5ndGgiLCJzb21lIiwidXNlciIsImFkZEV2ZW50TGlzdGVuZXIiLCJfaGFuZGxlTGlrZUJ0biIsIlBvcHVwIiwicG9wdXBTZWxlY3RvciIsImV2dCIsImtleSIsImNsb3NlIiwidGFyZ2V0IiwiX3BvcHVwIiwicmVtb3ZlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lcnMiLCJvcGVuIiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJfaGFuZGxlRXNjQ2xvc2UiLCJfaGFuZGxlQ2xpY2tDbG9zZVBvcHVwIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsIlBvcHVwV2l0aEZvcm0iLCJoYW5kbGVGb3JtU3VibWl0Iiwic3VwZXIiLCJwcmV2ZW50RGVmYXVsdCIsImlucHV0cyIsIl9nZXRJbnB1dFZhbHVlcyIsIl9oYW5kbGVGb3JtU3VibWl0IiwiX2Zvcm1FbGVtZXQiLCJpbnB1dFZhbHVlcyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJmb3JFYWNoIiwiaW5wdXQiLCJ2YWx1ZSIsIl9oYW5kbGVTdWJtaXQiLCJyZXNldCIsIlBvcHVwV2l0aEltYWdlIiwidGl0bGUiLCJfc3JjIiwiX3RpdGxlIiwiX3BvcHVwSW1nIiwiX3BvcHVwVGl0bGUiLCJQb3B1cFdJdGhDb25maXJtIiwiaGFuZGxlQ29uZmlybSIsIl9oYW5kbGVDb25maXJtIiwiRm9ybVZhbGlkYXRvciIsImNvbmZpZyIsImZvcm1FbCIsIl9mb3JtU2VsZWN0b3IiLCJmb3JtU2VsZWN0b3IiLCJfZm9ybUlucHV0c0ZpZWxkU2V0IiwiZm9ybUlucHV0c0ZpZWxkU2V0IiwiX2lucHV0U2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwiX3N1Ym1pdEJ0blNlbGVjdG9yIiwic3VibWl0QnRuU2VsZWN0b3IiLCJfaW5hY3RpdmVCdG5DbGFzcyIsImluYWN0aXZlQnRuQ2xhc3MiLCJfaW5wdXRFcnJDbGFzcyIsImlucHV0RXJyQ2xhc3MiLCJfaW5wdXRFcnJBY3RpdmVDbGFzcyIsImlucHV0RXJyQWN0aXZlQ2xhc3MiLCJfZm9ybUVsIiwiX3Nob3dJbnB1dEVyciIsImlucHV0RWwiLCJlcnJFbCIsInZhbGlkYXRpb25NZXNzYWdlIiwiX2hpZGVJbnB1dEVycm9yIiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsInZhbGlkaXR5IiwidmFsaWQiLCJfaGFzSW52YWxpZElucHV0IiwiaW5wdXRMc3QiLCJ0b2dnbGVCdXR0b25TdGF0ZSIsIkFycmF5IiwiZnJvbSIsImJ0bkVsIiwiZGlzYWJsZWQiLCJlbmFibGVWYWxpZGF0aW9uIiwicHJvZmlsZUZvcm0iLCJmb3JtcyIsInByb2ZpbGVmb3JtIiwiaW5wdXROYW1lIiwiZWxlbWVudHMiLCJwcm9maWxlTmFtZSIsImlucHV0QWJvdXRNZSIsInByb2ZpbGVBYm91dE1lIiwicGxhY2VGb3JtIiwicGxhY2Vmb3JtIiwicHJvZmlsZUVkaXRCdG4iLCJvcGVOZXdDYXJkUG9wdXBCdG4iLCJpbml0Q2FyZHMiLCJvcHRpb25zIiwiX2NhbGwiLCJjYXJkSWQiLCJfb3B0aW9ucyIsImFjdGlvbiIsIm1ldGhvZCIsImZldGNoIiwiYmFzZVVybCIsImhlYWRlcnMiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsInRoZW4iLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiZWRpdFByb2ZpbGUiLCJhYm91dCIsImNyZWF0ZU5ld0NhcmQiLCJpbml0IiwiYWxsIiwiZ2V0VXNlckRhdGEiLCJnZXRJbml0aWFsQ2FyZHMiLCJhdXRob3JpemF0aW9uIiwiaGFuZGxlRXJyb3IiLCJlcnIiLCJlcnJvckVsIiwiZGlzcGxheSIsImNhcmRzIiwidXNlckluZm8iLCJzZXRVc2VySW5mbyIsInNldFVzZXJBdmF0YXIiLCJhdmF0YXIiLCJjYXJkIiwicHVzaCIsImNhcmRMaXN0IiwicmVuZGVyZXIiLCJjYXRjaCIsImNvbnRhaW5lclNlbGVjdG9yIiwiX2l0ZW1zIiwiX3JlbmRlcmVyIiwiX2NvbnRhaW5lciIsImFkZEl0ZW0iLCJlbGVtZW50IiwiYXBwZW5kIiwiaXRlbSIsImFkZEdhbGxlcnlDYXJkSXRlbSIsIm5hbWVTZWxlY3RvciIsImpvYlNlbGVjdG9yIiwiYXZhdGFyU2VsZWN0b3IiLCJfbmFtZUVsZW1lbnQiLCJfam9iRWxlbWVudCIsIl9hdmF0YXIiLCJnZXRVc2VySW5mbyIsImNhcmRFbGVtZW50IiwiaGFuZGxlRGVsZXRlIiwibmV3Q2FyZFBvcHVwIiwicGxhY2VJbWFnZUxpbmsiLCJwbGFjZU5hbWUiLCJjb25zb2xlIiwibG9nIiwiY29uc3RhbnRzIiwibmV3Q2FyZFZhbGlkYXRvciIsIml0ZW1JZCIsImFsZXJ0IiwicHJvZmlsZVBvcHVwIiwicHJvZmlsZVZhbGlkYXRvciJdLCJzb3VyY2VSb290IjoiIn0=